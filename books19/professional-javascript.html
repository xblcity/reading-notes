<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Javascript高级程序设计(第三版)读书笔记 | 读书笔记</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/reading-notes/avatar.png">
    <meta name="description" content="小白龙的前端读书笔记">
    
    <link rel="preload" href="/reading-notes/assets/css/0.styles.9653101a.css" as="style"><link rel="preload" href="/reading-notes/assets/js/app.3c3209d0.js" as="script"><link rel="preload" href="/reading-notes/assets/js/2.a1b00631.js" as="script"><link rel="preload" href="/reading-notes/assets/js/3.e746fc3a.js" as="script"><link rel="prefetch" href="/reading-notes/assets/js/10.b01eb44d.js"><link rel="prefetch" href="/reading-notes/assets/js/11.7a9ed704.js"><link rel="prefetch" href="/reading-notes/assets/js/12.326518b6.js"><link rel="prefetch" href="/reading-notes/assets/js/13.bb903b42.js"><link rel="prefetch" href="/reading-notes/assets/js/14.f8bb1bef.js"><link rel="prefetch" href="/reading-notes/assets/js/15.fc976780.js"><link rel="prefetch" href="/reading-notes/assets/js/16.985c71fb.js"><link rel="prefetch" href="/reading-notes/assets/js/17.91297be8.js"><link rel="prefetch" href="/reading-notes/assets/js/4.bbac7c20.js"><link rel="prefetch" href="/reading-notes/assets/js/5.a9f838c3.js"><link rel="prefetch" href="/reading-notes/assets/js/6.514d7ebf.js"><link rel="prefetch" href="/reading-notes/assets/js/7.7c73e3c9.js"><link rel="prefetch" href="/reading-notes/assets/js/8.d947842c.js"><link rel="prefetch" href="/reading-notes/assets/js/9.6eecae53.js">
    <link rel="stylesheet" href="/reading-notes/assets/css/0.styles.9653101a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/reading-notes/" class="home-link router-link-active"><img src="/reading-notes/avatar.png" alt="读书笔记" class="logo"> <span class="site-name can-hide">读书笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://xblcity.github.io/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/xblcity/reading-notes" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://xblcity.github.io/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/xblcity/reading-notes" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/reading-notes/" aria-current="page" class="sidebar-link">总览</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>2019年</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/reading-notes/books19/professional-javascript.html" aria-current="page" class="active sidebar-link">Javascript高级程序设计(第三版)读书笔记</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#第1章-javascript简介" class="sidebar-link">第1章 Javascript简介</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#第2章-在html中使用javascript" class="sidebar-link">第2章 在HTML中使用javascript</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#第3章-基本概念" class="sidebar-link">第3章 基本概念</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_3-1-语法" class="sidebar-link">3.1 语法</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_3-2-关键字和保留字" class="sidebar-link">3.2 关键字和保留字</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_3-3-变量" class="sidebar-link">3.3 变量</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_3-4-数据类型" class="sidebar-link">3.4 数据类型</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_3-5-操作符" class="sidebar-link">3.5 操作符</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_3-6-语句" class="sidebar-link">3.6 语句</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_3-7-函数" class="sidebar-link">3.7 函数</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_3-8-小结" class="sidebar-link">3.8 小结</a></li></ul></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#第4章-变量、作用域和内存问题" class="sidebar-link">第4章 变量、作用域和内存问题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_4-1-基本类型和引用类型的值" class="sidebar-link">4.1 基本类型和引用类型的值</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_4-2-执行环境及作用域" class="sidebar-link">4.2 执行环境及作用域</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_4-3-垃圾收集" class="sidebar-link">4.3 垃圾收集</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_4-4-小结" class="sidebar-link">4.4 小结</a></li></ul></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#第5章-引用类型" class="sidebar-link">第5章 引用类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_5-1-object类型" class="sidebar-link">5.1 Object类型</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_5-2-array类型" class="sidebar-link">5.2 Array类型</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_5-3-date类型" class="sidebar-link">5.3 Date类型</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_5-4-regexp类型" class="sidebar-link">5.4 RegExp类型</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_5-5-function类型" class="sidebar-link">5.5 Function类型</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_5-6-基本包装类型" class="sidebar-link">5.6 基本包装类型</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_5-7-单体内置对象" class="sidebar-link">5.7 单体内置对象</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_5-8-小结" class="sidebar-link">5.8 小结</a></li></ul></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#第6章-面向对象的程序设计" class="sidebar-link">第6章 面向对象的程序设计</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_6-1-理解对象" class="sidebar-link">6.1 理解对象</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_6-2-创建对象" class="sidebar-link">6.2 创建对象</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_6-3-继承" class="sidebar-link">6.3 继承</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_6-4-总结" class="sidebar-link">6.4 总结</a></li></ul></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#第7章-函数表达式" class="sidebar-link">第7章 函数表达式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_7-1-递归" class="sidebar-link">7.1 递归</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_7-2-闭包" class="sidebar-link">7.2 闭包</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_7-3-模仿块级作用域" class="sidebar-link">7.3 模仿块级作用域</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_7-4-私有变量" class="sidebar-link">7.4 私有变量</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_7-5-小结" class="sidebar-link">7.5 小结</a></li></ul></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#第8章-bom" class="sidebar-link">第8章 BOM</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_8-1-window对象" class="sidebar-link">8.1 window对象</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_8-2-location对象" class="sidebar-link">8.2 location对象</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_8-3-navigator对象" class="sidebar-link">8.3 navigator对象</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_8-4-screen对象" class="sidebar-link">8.4 screen对象</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_8-5-history对象" class="sidebar-link">8.5 history对象</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_8-6-小结" class="sidebar-link">8.6 小结</a></li></ul></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#第9章-客户端检测" class="sidebar-link">第9章 客户端检测</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_9-1-能力检测" class="sidebar-link">9.1 能力检测</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_9-2-怪癖检测-quirks-detection" class="sidebar-link">9.2 怪癖检测(quirks detection)</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_9-3-用户代理检测" class="sidebar-link">9.3 用户代理检测</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_9-4-总结" class="sidebar-link">9.4 总结</a></li></ul></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#第10章-dom" class="sidebar-link">第10章 DOM</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_10-1-节点层次" class="sidebar-link">10.1 节点层次</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_10-2-dom操作技术" class="sidebar-link">10.2 DOM操作技术</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_10-3-小结" class="sidebar-link">10.3 小结</a></li></ul></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#第11章-dom扩展" class="sidebar-link">第11章 DOM扩展</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_11-1-选择符api" class="sidebar-link">11.1 选择符API</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_11-2-元素遍历" class="sidebar-link">11.2 元素遍历</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_11-3-html5" class="sidebar-link">11.3 HTML5</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_11-4-专有扩展" class="sidebar-link">11.4 专有扩展</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_11-5-小结" class="sidebar-link">11.5 小结</a></li></ul></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#第12章-dom2和dom3" class="sidebar-link">第12章 DOM2和DOM3</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_12-1-dom的变化" class="sidebar-link">12.1 DOM的变化</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_12-2-样式" class="sidebar-link">12.2 样式</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_12-3-遍历" class="sidebar-link">12.3 遍历</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_12-4-范围" class="sidebar-link">12.4 范围</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_12-5-小结" class="sidebar-link">12.5 小结</a></li></ul></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#第13章-事件" class="sidebar-link">第13章 事件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_13-1-事件流" class="sidebar-link">13.1 事件流</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_13-2-事件处理程序" class="sidebar-link">13.2 事件处理程序</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_13-3-事件对象" class="sidebar-link">13.3 事件对象</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_13-4-事件类型" class="sidebar-link">13.4 事件类型</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_13-5-内存和性能" class="sidebar-link">13.5 内存和性能</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_13-6-模拟事件" class="sidebar-link">13.6 模拟事件</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_13-7-小结" class="sidebar-link">13.7 小结</a></li></ul></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#第14章-表单脚本" class="sidebar-link">第14章 表单脚本</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_14-1-表单的基本知识" class="sidebar-link">14.1 表单的基本知识</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_14-2-文本框脚本" class="sidebar-link">14.2 文本框脚本</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_14-3-选择框脚本" class="sidebar-link">14.3 选择框脚本</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_14-4-表单序列化" class="sidebar-link">14.4 表单序列化</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_14-5-富文本编辑" class="sidebar-link">14.5 富文本编辑</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_14-6-小结" class="sidebar-link">14.6 小结</a></li></ul></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#第15章-使用canvas绘图" class="sidebar-link">第15章 使用Canvas绘图</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_15-1-基本用法" class="sidebar-link">15.1 基本用法</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_15-2-2d上下文" class="sidebar-link">15.2 2D上下文</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_15-3-webgl" class="sidebar-link">15.3 WebGL</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_15-4-小结" class="sidebar-link">15.4 小结</a></li></ul></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#第16章-html5脚本编程" class="sidebar-link">第16章 HTML5脚本编程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_16-1-跨文档消息传递" class="sidebar-link">16.1 跨文档消息传递</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_16-2-原生拖放" class="sidebar-link">16.2 原生拖放</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_16-3-媒体元素" class="sidebar-link">16.3 媒体元素</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_16-5-小结" class="sidebar-link">16.5 小结</a></li></ul></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#第17章-错误处理与调试" class="sidebar-link">第17章 错误处理与调试</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_17-1-浏览器报告的错误" class="sidebar-link">17.1 浏览器报告的错误</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_17-2-错误处理" class="sidebar-link">17.2 错误处理</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_17-3-调试技术" class="sidebar-link">17.3 调试技术</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_17-4-常见的ie错误" class="sidebar-link">17.4 常见的IE错误</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_17-5-小结" class="sidebar-link">17.5 小结</a></li></ul></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#第18章-javascript与xml" class="sidebar-link">第18章 JavaScript与XML</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_18-1-浏览器对xml-dom的支持" class="sidebar-link">18.1 浏览器对XML DOM的支持</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_18-2-浏览器对xpath的支持" class="sidebar-link">18.2 浏览器对Xpath的支持</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_18-3-浏览器对xslt的支持" class="sidebar-link">18.3 浏览器对XSLT的支持</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_18-3-小结" class="sidebar-link">18.3 小结</a></li></ul></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#第19章-e4x" class="sidebar-link">第19章 E4X</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#第20章-json" class="sidebar-link">第20章 JSON</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_20-1-语法" class="sidebar-link">20.1 语法</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_20-2-解析与序列化" class="sidebar-link">20.2 解析与序列化</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_20-3-小结" class="sidebar-link">20.3 小结</a></li></ul></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#第21章-ajax与comet" class="sidebar-link">第21章 Ajax与Comet</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_21-1-xmlhttprequest对象" class="sidebar-link">21.1 XMLHttpRequest对象</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_21-2-xmlhttprequest-2级" class="sidebar-link">21.2 XMLHttpRequest 2级</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_21-3-进度事件" class="sidebar-link">21.3 进度事件</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_21-4-跨源资源共享" class="sidebar-link">21.4 跨源资源共享</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_21-5-其他跨域技术" class="sidebar-link">21.5 其他跨域技术</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_21-6-安全" class="sidebar-link">21.6 安全</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_21-7-小结" class="sidebar-link">21.7 小结</a></li></ul></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#第22章-高级技巧" class="sidebar-link">第22章 高级技巧</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_22-1-高级函数" class="sidebar-link">22.1 高级函数</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_22-2-防篡改对象-tamper-proof-object" class="sidebar-link">22.2 防篡改对象(tamper-proof object)</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_22-3-高级定时器" class="sidebar-link">22.3 高级定时器</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_22-4-自定义事件" class="sidebar-link">22.4 自定义事件</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_22-5-拖放" class="sidebar-link">22.5 拖放</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_22-6-小结" class="sidebar-link">22.6 小结</a></li></ul></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#第23章-离线应用与客户端存储" class="sidebar-link">第23章 离线应用与客户端存储</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_23-1-离线检测" class="sidebar-link">23.1 离线检测</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_23-2-应用缓存" class="sidebar-link">23.2 应用缓存</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_23-3-数据存储" class="sidebar-link">23.3 数据存储</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_23-4-小结" class="sidebar-link">23.4 小结</a></li></ul></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#第24章-最佳实践" class="sidebar-link">第24章 最佳实践</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_24-1-可维护性" class="sidebar-link">24.1 可维护性</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_24-2-性能" class="sidebar-link">24.2 性能</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_24-3-部署" class="sidebar-link">24.3 部署</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_24-4-小结" class="sidebar-link">24.4 小结</a></li></ul></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#第25章-新兴的api" class="sidebar-link">第25章 新兴的API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_25-1-requestanimationframe" class="sidebar-link">25.1 requestAnimationFrame()</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_25-2-page-visibility-api" class="sidebar-link">25.2 Page Visibility API</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_25-3-geolocation-api" class="sidebar-link">25.3 Geolocation API</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_25-4-file-api" class="sidebar-link">25.4 File API</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_25-5-web计时" class="sidebar-link">25.5 Web计时</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_25-6-web-workers" class="sidebar-link">25.6 Web Workers</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#_25-7-小结" class="sidebar-link">25.7 小结</a></li></ul></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#附录a-ecmascript-harmony" class="sidebar-link">附录A ECMAScript Harmony</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#a-1-一般性变化" class="sidebar-link">A.1 一般性变化</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books19/professional-javascript.html#a-2-函数" class="sidebar-link">A.2 函数</a></li></ul></li></ul></li><li><a href="/reading-notes/books19/understanding-es6.html" class="sidebar-link">深入理解ES6</a></li><li><a href="/reading-notes/books19/you-don't-know-js1.html" class="sidebar-link">你不知道的Javascript(上卷)</a></li><li><a href="/reading-notes/books19/understanding-node.html" class="sidebar-link">深入浅出node.js</a></li><li><a href="/reading-notes/books19/understanding-webpack.html" class="sidebar-link">深入浅出webpack</a></li><li><a href="/reading-notes/books19/react.html" class="sidebar-link">React Docs(英译中)</a></li><li><a href="/reading-notes/books19/vue.html" class="sidebar-link">vue2.x文档</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>2020年</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/reading-notes/books20/functional-javascript.html" class="sidebar-link">Javascript ES6 函数式编程入门经典</a></li><li><a href="/reading-notes/books20/react20.html" class="sidebar-link">React 文档总结思考</a></li><li><a href="/reading-notes/books20/node-in-action.html" class="sidebar-link">Node.js实战 第二版 2018</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="javascript高级程序设计-第三版-读书笔记"><a href="#javascript高级程序设计-第三版-读书笔记" class="header-anchor">#</a> Javascript高级程序设计(第三版)读书笔记</h1> <ul><li><a href="#%E7%AC%AC1%E7%AB%A0-javascript%E7%AE%80%E4%BB%8B">第1章 Javascript简介</a></li> <li><a href="#%E7%AC%AC2%E7%AB%A0-%E5%9C%A8html%E4%B8%AD%E4%BD%BF%E7%94%A8javascript">第2章 在HTML中使用javascript</a></li> <li><a href="#%E7%AC%AC3%E7%AB%A0-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5">第3章 基本概念</a></li> <li><a href="#%E7%AC%AC4%E7%AB%A0-%E5%8F%98%E9%87%8F%E3%80%81%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E5%86%85%E5%AD%98%E9%97%AE%E9%A2%98">第4章 变量、作用域和内存问题</a></li> <li><a href="#%E7%AC%AC5%E7%AB%A0-%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B">第5章 引用类型</a></li> <li><a href="#%E7%AC%AC6%E7%AB%A0-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%9A%84%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1">第6章 面向对象的程序设计</a></li> <li><a href="#%E7%AC%AC7%E7%AB%A0-%E5%87%BD%E6%95%B0%E8%A1%A8%E8%BE%BE%E5%BC%8F">第7章 函数表达式</a></li> <li><a href="#%E7%AC%AC8%E7%AB%A0-bom">第8章 BOM</a></li> <li><a href="#%E7%AC%AC9%E7%AB%A0-%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%A3%80%E6%B5%8B">第9章 客户端检测</a></li> <li><a href="#%E7%AC%AC10%E7%AB%A0-bom">第10章 DOM</a></li> <li><a href="#%E7%AC%AC11%E7%AB%A0-dom%E6%89%A9%E5%B1%95">第11章 DOM扩展</a></li> <li><a href="#%E7%AC%AC12%E7%AB%A0-dom2%E5%92%8Cdom3">第12章 DOM2和DOM3</a></li> <li><a href="#%E7%AC%AC13%E7%AB%A0-%E4%BA%8B%E4%BB%B6">第13章 事件</a></li> <li><a href="#%E7%AC%AC14%E7%AB%A0-%E8%A1%A8%E5%8D%95%E8%84%9A%E6%9C%AC">第14章 表单脚本</a></li> <li><a href="#%E7%AC%AC15%E7%AB%A0-%E4%BD%BF%E7%94%A8canvas%E7%BB%98%E5%9B%BE">第15章 使用Canvas绘图</a></li> <li><a href="#%E7%AC%AC16%E7%AB%A0-html5%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B">第16章 HTML5脚本编程</a></li> <li><a href="#%E7%AC%AC17%E7%AB%A0-%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86%E4%B8%8E%E8%B0%83%E8%AF%95">第17章 错误处理与调试</a></li> <li><a href="#%E7%AC%AC18%E7%AB%A0-javascript%E4%B8%8Exml">第18章 JavaScript与XML</a></li> <li><a href="#%E7%AC%AC19%E7%AB%A0-e4x">第19章 E4X</a></li> <li><a href="#%E7%AC%AC20%E7%AB%A0-json">第20章 JSON</a></li> <li><a href="#%E7%AC%AC21%E7%AB%A0-ajax%E4%B8%8Ecomet">第21章 Ajax与Comet</a></li> <li><a href="#%E7%AC%AC22%E7%AB%A0-%E9%AB%98%E7%BA%A7%E6%8A%80%E5%B7%A7">第22章 高级技巧</a></li> <li><a href="#%E7%AC%AC23%E7%AB%A0-%E7%A6%BB%E7%BA%BF%E5%BA%94%E7%94%A8%E4%B8%8E%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AD%98%E5%82%A8">第23章 离线应用与客户端存储</a></li> <li><a href="#%E7%AC%AC24%E7%AB%A0-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5">第24章 最佳实践</a></li> <li><a href="#%E7%AC%AC25%E7%AB%A0-%E6%96%B0%E5%85%B4%E7%9A%84api">第25章 新兴的API</a></li> <li><a href="#%E9%99%84%E5%BD%95a-ecmascript-harmony">附录A ECMAScript Harmony</a></li></ul> <p>😄 😃 😇</p> <h2 id="第1章-javascript简介"><a href="#第1章-javascript简介" class="header-anchor">#</a> 第1章 Javascript简介</h2> <ul><li>最初是为了处理客户端简单验证</li> <li>JS实现包含 ECMAScript, DOM, BOM</li></ul> <h2 id="第2章-在html中使用javascript"><a href="#第2章-在html中使用javascript" class="header-anchor">#</a> 第2章 在HTML中使用javascript</h2> <ul><li><code>&lt;script&gt;</code>标签</li> <li>使用defer,async异步加载脚本，可以从字面意思理解，async仅仅是异步加载，加载完后就立即执行了，而defer是延缓的意思，虽然下载好了js文件，但是会等html渲染完成后再执行js脚本，是符合预期的。</li> <li>使用<code>script</code>实现jsonp</li></ul> <h2 id="第3章-基本概念"><a href="#第3章-基本概念" class="header-anchor">#</a> 第3章 基本概念</h2> <h3 id="_3-1-语法"><a href="#_3-1-语法" class="header-anchor">#</a> 3.1 语法</h3> <h4 id="_3-1-1-区分大小写"><a href="#_3-1-1-区分大小写" class="header-anchor">#</a> 3.1.1 区分大小写</h4> <h4 id="_3-1-2-标识符"><a href="#_3-1-2-标识符" class="header-anchor">#</a> 3.1.2 标识符</h4> <ul><li>就是指变量，函数，属性的名字，或者函数的参数</li> <li>标识符第一个必须是字母，下划线_或美元符号 $</li></ul> <h4 id="_3-1-3-注释"><a href="#_3-1-3-注释" class="header-anchor">#</a> 3.1.3 注释</h4> <ul><li>单行与多行注释</li></ul> <h4 id="_3-1-4-严格模式"><a href="#_3-1-4-严格模式" class="header-anchor">#</a> 3.1.4 严格模式</h4> <ul><li><code>&quot;use strict&quot;;</code></li></ul> <h4 id="_3-1-5-语句"><a href="#_3-1-5-语句" class="header-anchor">#</a> 3.1.5 语句</h4> <ul><li>行尾加不加分号</li> <li>代码块</li></ul> <h3 id="_3-2-关键字和保留字"><a href="#_3-2-关键字和保留字" class="header-anchor">#</a> 3.2 关键字和保留字</h3> <h3 id="_3-3-变量"><a href="#_3-3-变量" class="header-anchor">#</a> 3.3 变量</h3> <ul><li>弱类型</li></ul> <h3 id="_3-4-数据类型"><a href="#_3-4-数据类型" class="header-anchor">#</a> 3.4 数据类型</h3> <ul><li>6种简单数据类型，number, string, boolean, null, undefined, symbol</li> <li>object类型</li></ul> <h4 id="_3-4-1-typeof操作符"><a href="#_3-4-1-typeof操作符" class="header-anchor">#</a> 3.4.1 typeof操作符</h4> <h4 id="_3-4-2-undefined类型"><a href="#_3-4-2-undefined类型" class="header-anchor">#</a> 3.4.2 Undefined类型</h4> <h4 id="_3-4-3-null类型"><a href="#_3-4-3-null类型" class="header-anchor">#</a> 3.4.3 Null类型</h4> <h4 id="_3-4-4-boolean类型"><a href="#_3-4-4-boolean类型" class="header-anchor">#</a> 3.4.4 Boolean类型</h4> <ul><li>if语句自动执行 Boolean()</li></ul> <h4 id="_3-4-5-number类型"><a href="#_3-4-5-number类型" class="header-anchor">#</a> 3.4.5 Number类型</h4> <h4 id="_3-4-6-string类型"><a href="#_3-4-6-string类型" class="header-anchor">#</a> 3.4.6 String类型</h4> <h4 id="_3-4-7-object类型"><a href="#_3-4-7-object类型" class="header-anchor">#</a> 3.4.7 object类型</h4> <h3 id="_3-5-操作符"><a href="#_3-5-操作符" class="header-anchor">#</a> 3.5 操作符</h3> <h4 id="_3-5-1-一元操作符"><a href="#_3-5-1-一元操作符" class="header-anchor">#</a> 3.5.1 一元操作符</h4> <p>只能操作一个值的操作符叫一元操作符<br>
递增递减操作符
<code>--num1 num1-- ++num1 num1++</code><br>
一元加和减操作符
<code>+num1 -num1</code></p> <h4 id="_3-5-2-位操作符"><a href="#_3-5-2-位操作符" class="header-anchor">#</a> 3.5.2 位操作符</h4> <p>涉及到二进制</p> <h4 id="_3-5-3-布尔操作符"><a href="#_3-5-3-布尔操作符" class="header-anchor">#</a> 3.5.3 布尔操作符</h4> <p>逻辑非！<br>
逻辑与&amp;&amp;<br>
逻辑或 ||</p> <h4 id="_3-5-4-乘性操作符"><a href="#_3-5-4-乘性操作符" class="header-anchor">#</a> 3.5.4 乘性操作符</h4> <p>乘法*
除法 、
求模(取余) %</p> <h4 id="_3-5-5-加性操作符"><a href="#_3-5-5-加性操作符" class="header-anchor">#</a> 3.5.5 加性操作符</h4> <p>加法<br>
如果有一个操作数是对象，数值或布尔值，则调佣它们的toString方法，对于Undefined和Null则调用String()方法<br>
减法</p> <h4 id="_3-5-6-关系操作符"><a href="#_3-5-6-关系操作符" class="header-anchor">#</a> 3.5.6 关系操作符</h4> <h4 id="_3-5-7-相等操作符"><a href="#_3-5-7-相等操作符" class="header-anchor">#</a> 3.5.7 相等操作符</h4> <h4 id="_3-5-8-条件操作符"><a href="#_3-5-8-条件操作符" class="header-anchor">#</a> 3.5.8 条件操作符</h4> <h4 id="_3-5-9-赋值操作符"><a href="#_3-5-9-赋值操作符" class="header-anchor">#</a> 3.5.9 赋值操作符</h4> <h4 id="_3-5-10-逗号操作符"><a href="#_3-5-10-逗号操作符" class="header-anchor">#</a> 3.5.10 逗号操作符</h4> <h3 id="_3-6-语句"><a href="#_3-6-语句" class="header-anchor">#</a> 3.6 语句</h3> <h4 id="_3-6-1-if语句"><a href="#_3-6-1-if语句" class="header-anchor">#</a> 3.6.1 if语句</h4> <h4 id="_3-6-2-do-while语句"><a href="#_3-6-2-do-while语句" class="header-anchor">#</a> 3.6.2 do-while语句</h4> <h4 id="_3-6-3-while语句"><a href="#_3-6-3-while语句" class="header-anchor">#</a> 3.6.3 while语句</h4> <h4 id="_3-6-4-for语句"><a href="#_3-6-4-for语句" class="header-anchor">#</a> 3.6.4 for语句</h4> <h4 id="_3-6-5-for-in语句"><a href="#_3-6-5-for-in语句" class="header-anchor">#</a> 3.6.5 for-in语句</h4> <h4 id="_3-6-6-label语句"><a href="#_3-6-6-label语句" class="header-anchor">#</a> 3.6.6 label语句</h4> <h4 id="_3-6-7-break和continue语句"><a href="#_3-6-7-break和continue语句" class="header-anchor">#</a> 3.6.7 break和continue语句</h4> <h4 id="_3-6-8-with语句"><a href="#_3-6-8-with语句" class="header-anchor">#</a> 3.6.8 with语句</h4> <h4 id="_3-6-9-switch语句"><a href="#_3-6-9-switch语句" class="header-anchor">#</a> 3.6.9 switch语句</h4> <h3 id="_3-7-函数"><a href="#_3-7-函数" class="header-anchor">#</a> 3.7 函数</h3> <h4 id="_3-7-1-理解参数"><a href="#_3-7-1-理解参数" class="header-anchor">#</a> 3.7.1 理解参数</h4> <h4 id="_3-7-2-没有重载"><a href="#_3-7-2-没有重载" class="header-anchor">#</a> 3.7.2 没有重载</h4> <h3 id="_3-8-小结"><a href="#_3-8-小结" class="header-anchor">#</a> 3.8 小结</h3> <h2 id="第4章-变量、作用域和内存问题"><a href="#第4章-变量、作用域和内存问题" class="header-anchor">#</a> 第4章 变量、作用域和内存问题</h2> <h3 id="_4-1-基本类型和引用类型的值"><a href="#_4-1-基本类型和引用类型的值" class="header-anchor">#</a> 4.1 基本类型和引用类型的值</h3> <h4 id="_4-1-1-动态的属性"><a href="#_4-1-1-动态的属性" class="header-anchor">#</a> 4.1.1 动态的属性</h4> <ul><li>引用类型的属性是动态的，可以重设</li></ul> <h4 id="_4-1-2-复制变量值"><a href="#_4-1-2-复制变量值" class="header-anchor">#</a> 4.1.2 复制变量值</h4> <ul><li>复制变量值，复制基本类型值，会创建新值，复制引用类型的值，值的副本是指针</li></ul> <h4 id="_4-1-3-传递参数"><a href="#_4-1-3-传递参数" class="header-anchor">#</a> 4.1.3 传递参数</h4> <ul><li>函数参数是按值传递的，参数是函数内部的局部变量</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  obj<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'nicocity'</span>
  obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  obj<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Grey'</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">setName</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// 'nicocity'</span>
</code></pre></div><h4 id="_4-1-4-检测类型"><a href="#_4-1-4-检测类型" class="header-anchor">#</a> 4.1.4 检测类型</h4> <ul><li>typeof操作符用于检测基础类型(null除外)，object以及function，如<code>typeof 'a'</code>,输出string</li> <li>instance操作符检测引用类型, 如<code>[1,2] instanceof Array</code>, 输出true</li></ul> <h3 id="_4-2-执行环境及作用域"><a href="#_4-2-执行环境及作用域" class="header-anchor">#</a> 4.2 执行环境及作用域</h3> <ul><li>执行环境(execution context)，也称环境</li> <li>web浏览器全局执行环境是window</li> <li>代码在一个环境中执行时，会创建对象变量的一个作用域链</li></ul> <h4 id="_4-2-1-延长作用域链"><a href="#_4-2-1-延长作用域链" class="header-anchor">#</a> 4.2.1 延长作用域链</h4> <ul><li>with, try...catch, 块作用域</li></ul> <h4 id="_4-2-2-没有块作用域-x"><a href="#_4-2-2-没有块作用域-x" class="header-anchor">#</a> 4.2.2 没有块作用域(X)</h4> <h3 id="_4-3-垃圾收集"><a href="#_4-3-垃圾收集" class="header-anchor">#</a> 4.3 垃圾收集</h3> <h4 id="_4-3-1-标记清除"><a href="#_4-3-1-标记清除" class="header-anchor">#</a> 4.3.1 标记清除</h4> <ul><li>垃圾收集器在运行时会给内存中所有变量加上标记，然后去掉环境中的变量以及被环境中变量引用的变量的标记(闭包？)，而在此之后再被加上标记的变量被视为准备删除的变量，因为环境中的变量已经无法访问到这些变量了，最后，垃圾搜集器完成内存清除工作，销毁哪些带标记的值并回收它们所占用的内存空间。</li></ul> <h4 id="_4-3-2-引用计数"><a href="#_4-3-2-引用计数" class="header-anchor">#</a> 4.3.2 引用计数</h4> <ul><li>会出现循环引用问题</li></ul> <h4 id="_4-3-3-性能问题"><a href="#_4-3-3-性能问题" class="header-anchor">#</a> 4.3.3 性能问题</h4> <h4 id="_4-3-4-管理内存"><a href="#_4-3-4-管理内存" class="header-anchor">#</a> 4.3.4 管理内存</h4> <ul><li>手动将数据的值设为null，解除引用</li></ul> <h3 id="_4-4-小结"><a href="#_4-4-小结" class="header-anchor">#</a> 4.4 小结</h3> <h2 id="第5章-引用类型"><a href="#第5章-引用类型" class="header-anchor">#</a> 第5章 引用类型</h2> <h3 id="_5-1-object类型"><a href="#_5-1-object类型" class="header-anchor">#</a> 5.1 Object类型</h3> <ul><li>new Object() 或者 对象字面量 创建对象实例</li> <li>使用. 或者 [] 访问对象属性</li></ul> <h3 id="_5-2-array类型"><a href="#_5-2-array类型" class="header-anchor">#</a> 5.2 Array类型</h3> <ul><li>创建方式： new Array(), 字面量， [...Array(20)]</li> <li>length属性</li></ul> <h4 id="_5-2-1-检测数组"><a href="#_5-2-1-检测数组" class="header-anchor">#</a> 5.2.1 检测数组</h4> <ul><li><code>anArray instanceof Array, Array.isArray(someArray)</code></li></ul> <h4 id="_5-2-2-转换方法"><a href="#_5-2-2-转换方法" class="header-anchor">#</a> 5.2.2 转换方法</h4> <ul><li>所有对象都具备的 toString() toLocaleString() valueOf()</li> <li>join, 逆向 String.split()</li></ul> <h4 id="_5-2-3-栈方法"><a href="#_5-2-3-栈方法" class="header-anchor">#</a> 5.2.3 栈方法</h4> <ul><li>LIFO, Last-In-First-Out</li> <li>pop() push() 不传参则默认取最后一项，会改变原数组</li></ul> <h4 id="_5-2-4-队列方法"><a href="#_5-2-4-队列方法" class="header-anchor">#</a> 5.2.4 队列方法</h4> <ul><li>FIFO First-In-First-Out</li> <li>shift() unshift() 不传参默认取第一项，会改变原数组</li></ul> <h4 id="_5-2-5-重排序方法"><a href="#_5-2-5-重排序方法" class="header-anchor">#</a> 5.2.5 重排序方法</h4> <p>reverse() 和 sort() 后者可以传入自定义回调函数<br>
sort()传入回调函数return 正值 则说明第一个参数应该位于第二个参数之前，即交换顺序，负数则相反，0则不变</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">compare</span><span class="token punctuation">(</span><span class="token parameter">prev<span class="token punctuation">,</span> cur</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>prev <span class="token operator">&lt;</span> cur<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">1</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>prev <span class="token operator">&gt;</span> cur<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">0</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// 输出 [20, 5, 2, 1]</span>
</code></pre></div><h4 id="_5-2-6-操作方法"><a href="#_5-2-6-操作方法" class="header-anchor">#</a> 5.2.6 操作方法</h4> <ul><li>concat() aArray.concat(bArray)</li> <li>slice(begin) 或者 slice(begin, end)</li> <li>splice() 功能强大但是会改变原数组 splice(beigin, 截取长度, 替换)</li></ul> <h4 id="_5-2-7-位置方法"><a href="#_5-2-7-位置方法" class="header-anchor">#</a> 5.2.7 位置方法</h4> <ul><li>indexOf() lastIndexOf() 参数是要查找的项</li> <li>es6可以使用 find或者 findIndex迭代方法</li></ul> <h4 id="_5-2-8-迭代方法"><a href="#_5-2-8-迭代方法" class="header-anchor">#</a> 5.2.8 迭代方法</h4> <ul><li>forEach, every, some, filter, map 都可以传递三个参数</li> <li>es6 find, findIndex, includes</li></ul> <h4 id="_5-2-9-归并方法"><a href="#_5-2-9-归并方法" class="header-anchor">#</a> 5.2.9 归并方法</h4> <p>reduce, reduceRight</p> <p><strong>ES6新增</strong>: Array.from(),Array.of(),copeWithin(),find,findIndex,fill,includes(ES7)</p> <h3 id="_5-3-date类型"><a href="#_5-3-date类型" class="header-anchor">#</a> 5.3 Date类型</h3> <ul><li>new Date() 输出时间格式的字符串</li> <li>new Date(2131231) 传入毫秒数，也会输出时间格式字符串<br> <strong>构造器上面的方法，即Date函数/constructor，或者可以说是prototype的constructor属性上面的方法</strong></li> <li>Date.parse(new Date()) 传入时间格式字符串，返回毫秒数</li> <li>Date.now() 返回毫秒数<br> <strong>原型上面的方法，即Date实例的原型(prototype)上面的方法</strong></li> <li>例如, new Date().getTime()</li></ul> <h4 id="_5-3-1-继承的方法"><a href="#_5-3-1-继承的方法" class="header-anchor">#</a> 5.3.1 继承的方法</h4> <p>来自Object原型链的方法<br>
toLocaleString()会根据地区的时间格式返回相应时间</p> <h4 id="_5-3-2-日期格式化方法"><a href="#_5-3-2-日期格式化方法" class="header-anchor">#</a> 5.3.2 日期格式化方法</h4> <ul><li>toDateString, toTimeString, toLocaleDateString, toLocaleTimeString, toUTCString</li> <li>toLocaleTimeString,toLocaleDateString和toLocaleString之间的区别</li></ul> <h4 id="_5-3-3-日期-时间组件方法"><a href="#_5-3-3-日期-时间组件方法" class="header-anchor">#</a> 5.3.3 日期/时间组件方法</h4> <p>Date类型<br>
getTime// 返回毫秒数, getFullYear, getMounth, getDay, getHours...</p> <h3 id="_5-4-regexp类型"><a href="#_5-4-regexp类型" class="header-anchor">#</a> 5.4 RegExp类型</h3> <ul><li><code>const expression = /pattern/ flags</code> flags包含 g,i,m</li> <li>元字符必须要转义，如<code>. [ { ^ $ ? * | \</code> 需要在前面加上 <code>\</code></li> <li><code>const pattern = /[bc]at/i</code> 匹配第一个bat或者cat，不区分大小写</li> <li>test()</li></ul> <h4 id="_5-4-1-regexp实例属性"><a href="#_5-4-1-regexp实例属性" class="header-anchor">#</a> 5.4.1 RegExp实例属性</h4> <h4 id="_5-4-2-regexp实例方法"><a href="#_5-4-2-regexp实例方法" class="header-anchor">#</a> 5.4.2 RegExp实例方法</h4> <ul><li>exec('要检测的字符串') // 返回数组，查找不到返回null</li> <li>test('要检测的字符串') // 返回布尔值</li></ul> <h4 id="_5-4-3-regexp构造函数属性"><a href="#_5-4-3-regexp构造函数属性" class="header-anchor">#</a> 5.4.3 RegExp构造函数属性</h4> <h4 id="_5-4-4-模式的局限性"><a href="#_5-4-4-模式的局限性" class="header-anchor">#</a> 5.4.4 模式的局限性</h4> <h3 id="_5-5-function类型"><a href="#_5-5-function类型" class="header-anchor">#</a> 5.5 Function类型</h3> <h4 id="_5-5-1-没有重载"><a href="#_5-5-1-没有重载" class="header-anchor">#</a> 5.5.1 没有重载</h4> <ul><li>后面的函数会覆盖前面的函数，ts有函数重载</li></ul> <h4 id="_5-5-2-函数声明与函数表达式"><a href="#_5-5-2-函数声明与函数表达式" class="header-anchor">#</a> 5.5.2 函数声明与函数表达式</h4> <ul><li>函数声明比函数表达式先被读取，即函数提升</li></ul> <h4 id="_5-5-3-作为值的函数"><a href="#_5-5-3-作为值的函数" class="header-anchor">#</a> 5.5.3 作为值的函数</h4> <p>可以理解为高阶函数的应用</p> <ul><li>访问函数而不执行函数，需要去掉函数名后面的括号</li> <li>函数可以作为参数</li> <li>函数内部返回函数</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">createComparisonFunction</span><span class="token punctuation">(</span><span class="token parameter">propertyName</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">object1<span class="token punctuation">,</span> object2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> value1 <span class="token operator">=</span> object1<span class="token punctuation">[</span>propertyName<span class="token punctuation">]</span>
    <span class="token keyword">var</span> value2 <span class="token operator">=</span> object2<span class="token punctuation">[</span>propertyName<span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>value1 <span class="token operator">&lt;</span> value2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>value1 <span class="token operator">&gt;</span> value2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token number">1</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token number">0</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">'li'</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">28</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">'nico'</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">21</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
data<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token function">createComparisonFunction</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 依据name进行排序</span>
</code></pre></div><h4 id="_5-5-4-函数内部属性"><a href="#_5-5-4-函数内部属性" class="header-anchor">#</a> 5.5.4 函数内部属性</h4> <ul><li>arguments</li> <li>callee</li> <li>this</li></ul> <h4 id="_5-5-5-函数属性和方法"><a href="#_5-5-5-函数属性和方法" class="header-anchor">#</a> 5.5.5 函数属性和方法</h4> <p>构造函数属性</p> <ul><li>length 是函数希望接收到的参数个数</li> <li>prototype
原型上方法</li> <li>apply/call/bind 改变函数执行作用域/上下文环境/this</li></ul> <h3 id="_5-6-基本包装类型"><a href="#_5-6-基本包装类型" class="header-anchor">#</a> 5.6 基本包装类型</h3> <p>特殊的引用类型</p> <ul><li>Boolean</li> <li>Number</li> <li>String<br>
当上述基本值被读取的时候，后台会创建对应的基本包装类型的对象，从而我们可以调用方法来操作这些数据</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> s1 <span class="token operator">=</span> <span class="token string">'some text'</span>
<span class="token keyword">var</span> s2 <span class="token operator">=</span> s1<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment">// 基本类型值不是对象，不该有方法，当访问s1时，实际执行了下面操作</span>
<span class="token comment">// 1.创建实例2.在实例上面调用方法3.销毁这个实例</span>
<span class="token keyword">var</span> s1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">'some text'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> s2 <span class="token operator">=</span> s1<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
s1 <span class="token operator">=</span> <span class="token keyword">null</span>
</code></pre></div><h4 id="_5-6-1-boolean类型"><a href="#_5-6-1-boolean类型" class="header-anchor">#</a> 5.6.1 Boolean类型</h4> <h4 id="_5-6-2-number类型"><a href="#_5-6-2-number类型" class="header-anchor">#</a> 5.6.2 Number类型</h4> <ul><li>toFixed()</li></ul> <h4 id="_5-6-3-string类型"><a href="#_5-6-3-string类型" class="header-anchor">#</a> 5.6.3 String类型</h4> <ul><li>属性 length</li> <li>concat 大部分还是使用 <code>+</code>号</li> <li>slice, substring, substr,对原始字符无影响</li> <li>slice,substring第一个参数是起始位置，第二个是结束位置，substr第二个参数是返回字符个数</li> <li>indexOf，lastIndexOf, <code>'myname'.indexOf(n)</code>结果为3，找不到返回-1</li> <li>trim,删除前后位置所有空格，<code>' sc '.trim()</code> 结果 'sc'</li> <li>toLowerCase, toUpperCase，大小写转换</li> <li>match，与RegExp的exec相同，match只接收正则表达式，<code>'cat, fat'.match(/.at/)</code>,返回数组...</li> <li>search同match，返回索引或-1</li> <li>replace,两个参数，用于替换字符串，<code>'cat, bat'.replace(/at/g, 'ond')</code> 返回 <code>'cond, bond'</code></li> <li>split，传入要根据分割的符号，不传的分割单个字母，如<code>'me'.split()</code> 返回 <code>'m','e'</code></li> <li>localeCompare,比较字符串</li></ul> <h3 id="_5-7-单体内置对象"><a href="#_5-7-单体内置对象" class="header-anchor">#</a> 5.7 单体内置对象</h3> <h4 id="_5-7-1-global对象"><a href="#_5-7-1-global对象" class="header-anchor">#</a> 5.7.1 Global对象</h4> <ul><li>encodeURI, encodeURICompoent,后者会对任何非标准字符进行编码，用的更多</li> <li>decodeURI, decodeURIComponent,后者可以解码任何特殊字符编码</li> <li>eval，传入字符串，但会被当做js语句执行，容易被脚本注入，非常危险</li></ul> <h5 id="golbal属性"><a href="#golbal属性" class="header-anchor">#</a> Golbal属性</h5> <ul><li>特殊值：undefined,NaN,Infinity,构造函数：Object,Array,Function,Boolean,String,Number</li> <li>构造函数：Date, RegExp, Error, EvalError, RangeError, ReferenceError, SyntaxError, TypeError, URIError</li></ul> <h5 id="ecmascript虽然没有指出如何访问global对象-但web浏览器都是将这个全局对象作为window对象的一部分实现的"><a href="#ecmascript虽然没有指出如何访问global对象-但web浏览器都是将这个全局对象作为window对象的一部分实现的" class="header-anchor">#</a> ECMAScript虽然没有指出如何访问Global对象，但web浏览器都是将这个全局对象作为window对象的一部分实现的</h5> <h4 id="_5-7-2-math对象"><a href="#_5-7-2-math对象" class="header-anchor">#</a> 5.7.2 Math对象</h4> <h5 id="math对象属性"><a href="#math对象属性" class="header-anchor">#</a> Math对象属性</h5> <ul><li>Math.PI等</li></ul> <h5 id="math方法"><a href="#math方法" class="header-anchor">#</a> Math方法</h5> <ul><li>Math.min(), Math.max() 传入多个number类型值</li> <li>找到数组中最大值，<code>var values = [1,2,5,7,8]; var max = Math.max.bind(Math, values)</code></li> <li>舍入方法，Math.ceil, Math.floor, Math.round</li> <li>Math.random, <code>Math.floor(Math.random()*10 + 1)</code></li> <li>还有其他方法，如Math.abs(num)绝对值, Math.exp(num)n次幂, Math.sqrt(num)平方根，Math.cos(x)余弦值，等等。。。</li></ul> <h3 id="_5-8-小结"><a href="#_5-8-小结" class="header-anchor">#</a> 5.8 小结</h3> <ul><li>Object是基础类型，其他引用类型都从Object继承</li> <li>Array,Date,RegExp,Function以及三个包装类型 String,Number,Boolean,</li> <li>内置对象Global以及Math</li></ul> <h2 id="第6章-面向对象的程序设计"><a href="#第6章-面向对象的程序设计" class="header-anchor">#</a> 第6章 面向对象的程序设计</h2> <h3 id="_6-1-理解对象"><a href="#_6-1-理解对象" class="header-anchor">#</a> 6.1 理解对象</h3> <h4 id="_6-1-1-属性类型"><a href="#_6-1-1-属性类型" class="header-anchor">#</a> 6.1.1 属性类型</h4> <h5 id="数据属性"><a href="#数据属性" class="header-anchor">#</a> 数据属性</h5> <ul><li>有四个描述其行为的特性：</li> <li>Configurable,是否可通过delete删除属性重新定义，Enumerable,是否可以通过for-in循环返回属性</li> <li>Writeale,属性值是否可被修改，Value属性的数据值<br>
修改属性默认特性，需要使用Object.defineProperty(), 接收三个参数</li></ul> <h5 id="访问器属性"><a href="#访问器属性" class="header-anchor">#</a> 访问器属性</h5> <ul><li>不包含数据值，包含一对getter,setter函数，读取访问器属性，会调用getter函数，这个函数负责返回值，写入访问器属性时，会调用setter函数并传入新值，这个函数决定如何处理数据</li> <li>configurable, enumrable, get, set</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> book <span class="token operator">=</span> <span class="token punctuation">{</span>
  _year<span class="token operator">:</span> <span class="token number">2004</span><span class="token punctuation">,</span>
  edition<span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>book<span class="token punctuation">,</span> <span class="token string">'year'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_year
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">newValue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>newValue <span class="token operator">&gt;</span> <span class="token number">2004</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>_year <span class="token operator">=</span> newValue
      <span class="token keyword">this</span><span class="token punctuation">.</span>edition <span class="token operator">+=</span> newValue <span class="token operator">-</span> <span class="token number">2004</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
book<span class="token punctuation">.</span>year <span class="token operator">=</span> <span class="token number">2005</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>book<span class="token punctuation">.</span>edition<span class="token punctuation">)</span> <span class="token comment">// 2</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>book<span class="token punctuation">.</span>year<span class="token punctuation">)</span> <span class="token comment">// 2005</span>
</code></pre></div><h4 id="_6-1-2-定义多个属性"><a href="#_6-1-2-定义多个属性" class="header-anchor">#</a> 6.1.2 定义多个属性</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> book <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperties</span><span class="token punctuation">(</span>book<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  _year<span class="token operator">:</span> <span class="token punctuation">{</span>
    writable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    value<span class="token operator">:</span> <span class="token number">2004</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  year<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_year
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">newValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>newValue <span class="token operator">&gt;</span> <span class="token number">2004</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_year <span class="token operator">=</span> newValue
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="_6-1-3-获取属性的特性"><a href="#_6-1-3-获取属性的特性" class="header-anchor">#</a> 6.1.3 获取属性的特性</h4> <p><code>Object.getOwnPropertyDescriptor(book, '_year')</code> 得到一个对象，包括'configurable, enumerable, get, set/ writable, value'</p> <h3 id="_6-2-创建对象"><a href="#_6-2-创建对象" class="header-anchor">#</a> 6.2 创建对象</h3> <h4 id="_6-2-1-工厂模式"><a href="#_6-2-1-工厂模式" class="header-anchor">#</a> 6.2.1 工厂模式</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">createPerson</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> job</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  o<span class="token punctuation">.</span>name <span class="token operator">=</span> name
  o<span class="token punctuation">.</span>age <span class="token operator">=</span> age
  o<span class="token punctuation">.</span>job <span class="token operator">=</span> job
  o<span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> o
<span class="token punctuation">}</span>
<span class="token keyword">var</span> person1 <span class="token operator">=</span> <span class="token function">createPerson</span><span class="token punctuation">(</span><span class="token string">'Nicholas'</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token string">'Software Engineer'</span><span class="token punctuation">)</span>
person1<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="_6-2-2-构造函数模式"><a href="#_6-2-2-构造函数模式" class="header-anchor">#</a> 6.2.2 构造函数模式</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> job</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
  <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age
  <span class="token keyword">this</span><span class="token punctuation">.</span>job <span class="token operator">=</span> job
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> person1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'Nicholas'</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token string">'Software Engineer'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> person2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'Greg'</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token string">'Doctor'</span><span class="token punctuation">)</span>
person1<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>与工厂函数的区别，没有显式创建对象，直接将属性的方法赋给了this对象，没有return语句<br>
创建构造函数的实例，必须使用new操作符<br>
new做了一下操作，创建一个新对象，this指向新对象，新对象原型指向构造函数原型，执行代码，返回这个对象</p> <div class="language-js extra-class"><pre class="language-js"><code>person1<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Person <span class="token comment">// 原型链查找 true</span>
person2<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Person <span class="token comment">// 原型链查找 true</span>
person1<span class="token punctuation">.</span><span class="token class-name">__proto__</span><span class="token punctuation">.</span>constructor <span class="token operator">===</span> Person <span class="token comment">// true</span>
person1 <span class="token keyword">instanceof</span> <span class="token class-name">Person</span> <span class="token comment">// true 原型链匹配</span>
person1<span class="token punctuation">.</span>sayName <span class="token operator">===</span> Person2<span class="token punctuation">.</span>sayName  <span class="token comment">// false</span>
</code></pre></div><p>构造函数缺点，每个方法都要在实例上面重新创建一遍</p> <h4 id="_6-2-3-原型模式"><a href="#_6-2-3-原型模式" class="header-anchor">#</a> 6.2.3 原型模式</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Nicholas'</span>
<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">29</span>
<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>job <span class="token operator">=</span> <span class="token string">'Software Engineer'</span>
<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayNmae</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> person1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
person1<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 'Nicholas'</span>
<span class="token keyword">var</span> person2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
person2<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 'Nicholas'</span>
<span class="token function">alert</span><span class="token punctuation">(</span>person1<span class="token punctuation">.</span>sayName <span class="token operator">===</span> Person2<span class="token punctuation">.</span>sayName<span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre></div><p><strong>创建一个函数，函数会自动创建一个proto属性，这个属性指向原型对象，原型对象会自动化获得一个constructor属性，constructor指向构造函数</strong><br>
从实例开始查找，找不到则向原型链上查找<br>
判断是不是实例上面的属性，用xxx.hasOwnProperty('xxx')
单独使用 In 操作符，用 'name' in Person 可以判断属性是否在 原型||实例 上<br>
可枚举实例属性，Object.keys()<br>
重写原型的方法</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'xx'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">sayName</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'sayName'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 手动设置constructor: Person</span>
<span class="token punctuation">}</span>
<span class="token comment">// constructor属性不再指向Person了，等于重写了prototype</span>
</code></pre></div><p>下面这个例子</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> friend <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>
  constructor<span class="token operator">:</span> Person<span class="token punctuation">,</span>
  name<span class="token operator">:</span> <span class="token string">'nico'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">sayName</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> friend2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
friend<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// typeError: friend.sayName is not a function， friend的prototype是之前的那个</span>
friend2<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// 'nico'</span>
<span class="token comment">// 重写原型对象切断了现有原型与任何已经存在的对象实例之间的联系</span>
</code></pre></div><p>构造函数缺陷：省略了构造函数传递初始化参数这一环节，结果所有实例在默认情况下都取得了相同的值<br>
原型中很多属性是共享的，对于函数来说比较合适，对于基本值，甚至是对象，问题比较突出，因为是同一个引用，所以改变这个对象，所有实例上面的这个属性都会改变</p> <h4 id="_6-2-4-组合使用构造函数模式和原型模式"><a href="#_6-2-4-组合使用构造函数模式和原型模式" class="header-anchor">#</a> 6.2.4 组合使用构造函数模式和原型模式</h4> <h4 id="_6-2-5-动态原型模式"><a href="#_6-2-5-动态原型模式" class="header-anchor">#</a> 6.2.5 动态原型模式</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> job</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 属性</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
  <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age
  <span class="token keyword">this</span><span class="token punctuation">.</span>job <span class="token operator">=</span> job
  <span class="token comment">// 方法</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sayName <span class="token operator">!==</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> friend <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'nico'</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token string">'Software Engineer'</span><span class="token punctuation">)</span>
friend<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>只有在sayName方法不存在情况下，才会将它添加到原型中，这段代码会在初次调用构造函数时执行</p> <h4 id="_6-2-6-寄生构造函数模式"><a href="#_6-2-6-寄生构造函数模式" class="header-anchor">#</a> 6.2.6 寄生构造函数模式</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">createPerson</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> job</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  o<span class="token punctuation">.</span>name <span class="token operator">=</span> name
  o<span class="token punctuation">.</span>age <span class="token operator">=</span> age
  o<span class="token punctuation">.</span>job <span class="token operator">=</span> job
  o<span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> o
<span class="token punctuation">}</span>
<span class="token keyword">var</span> person1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">createPerson</span><span class="token punctuation">(</span><span class="token string">'Nicholas'</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token string">'Software Engineer'</span><span class="token punctuation">)</span>
person1<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>与工厂函数相比，使用了new操作符</p> <h4 id="_6-2-7-稳妥构造函数模式"><a href="#_6-2-7-稳妥构造函数模式" class="header-anchor">#</a> 6.2.7 稳妥构造函数模式</h4> <h3 id="_6-3-继承"><a href="#_6-3-继承" class="header-anchor">#</a> 6.3 继承</h3> <h4 id="_6-3-1-原型链"><a href="#_6-3-1-原型链" class="header-anchor">#</a> 6.3.1 原型链</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Son</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Father</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>Son构造函数的原型指向Fatcher的实例<br>
Son prototype 的 原型是 Father
Son构造函数的原型上没有construtor，因为原型被赋值语句改变了指针<br>
通过 instanceof 或者 isPrototype来判断原型链</p> <h6 id="原型链实现继承"><a href="#原型链实现继承" class="header-anchor">#</a> 原型链实现继承</h6> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>property <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
superType<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getSuperValue</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>property
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>subProperty <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
<span class="token comment">// 继承</span>
subType<span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">alert</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span><span class="token function">getSuperValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
</code></pre></div><p>原型链存在的问题</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token string">'blue'</span><span class="token punctuation">,</span> <span class="token string">'green'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token comment">// 继承</span>
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> instance1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
instance1<span class="token punctuation">.</span>colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'black'</span><span class="token punctuation">)</span>
<span class="token function">alert</span><span class="token punctuation">(</span>instance1<span class="token punctuation">.</span>colors<span class="token punctuation">)</span>  <span class="token comment">// ['red', 'blue', 'green', 'black']</span>

<span class="token keyword">var</span> instance2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">alert</span><span class="token punctuation">(</span>instance2<span class="token punctuation">.</span>colors<span class="token punctuation">)</span>  <span class="token comment">// ['red', 'blue', 'green', 'black']</span>
</code></pre></div><p>原型链继承缺点很明显，原型链上的属性值由所有SubType实例继承，更改其中一个实例的属性(其实就是原型链上的属性)，会影响到所有实例上的属性(其实也是原型链上的属性)</p> <h4 id="_6-3-2-借用构造函数"><a href="#_6-3-2-借用构造函数" class="header-anchor">#</a> 6.3.2 借用构造函数</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token string">'blue'</span><span class="token punctuation">,</span> <span class="token string">'green'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">SuperType</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token comment">// 执行构造函数，只继承SuperType构造器上的属性(没有使用new调用，所以不存在原型继承哦)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> instance1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
instance1<span class="token punctuation">.</span>colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'black'</span><span class="token punctuation">)</span>
<span class="token function">alert</span><span class="token punctuation">(</span>instance1<span class="token punctuation">.</span>colors<span class="token punctuation">)</span>  <span class="token comment">// ['red', 'blue', 'green', 'black']</span>

<span class="token keyword">var</span> instance2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">alert</span><span class="token punctuation">(</span>instance2<span class="token punctuation">.</span>colors<span class="token punctuation">)</span>  <span class="token comment">// ['red', 'blue', 'green']</span>
</code></pre></div><p>因为SubType每次生成实例，都会先调用SuperType的构造函数，所以每个实例的color属性互相不影响</p> <h6 id="传递参数"><a href="#传递参数" class="header-anchor">#</a> 传递参数</h6> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">SuperType</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">SubType</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">SuperType</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age
<span class="token punctuation">}</span>
<span class="token keyword">var</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token string">'nico'</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">)</span>
<span class="token function">alert</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span>name<span class="token punctuation">,</span> instance<span class="token punctuation">.</span>age<span class="token punctuation">)</span> <span class="token comment">// nico 19</span>
</code></pre></div><p>缺点也很明显，属性，方法都在构造函数中定义，那函数复用也就无从谈起了</p> <h4 id="_6-3-3-组合继承"><a href="#_6-3-3-组合继承" class="header-anchor">#</a> 6.3.3 组合继承</h4> <p>又称伪经典继承，指的是将原型链和借用构造函数的技术组合到一块，从而发挥二者之长的一种继承模式</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">SuperType</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
  <span class="token keyword">this</span><span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token string">'blue'</span><span class="token punctuation">,</span> <span class="token string">'green'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token class-name">SuperType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">SubType</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 继承属性</span>
  <span class="token function">SuperType</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span> <span class="token comment">// 仅仅继承了实例属性(因为没有用new 调用)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age
<span class="token punctuation">}</span>

<span class="token comment">// 继承方法</span>
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 继承构造函数实例，包括原型上的方法和实例属性（属性没有用到，造成一次浪费）</span>
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> SubType
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayAge</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> instance1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token string">'nico'</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">)</span>
instance1<span class="token punctuation">.</span>colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'black'</span><span class="token punctuation">)</span>
<span class="token function">alert</span><span class="token punctuation">(</span>instance1<span class="token punctuation">.</span>colors<span class="token punctuation">)</span>  <span class="token comment">// ['red', 'blue', 'green']</span>
instance1<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 'nico'</span>
instance1<span class="token punctuation">.</span><span class="token function">sayAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 22</span>
</code></pre></div><p>避免了原型链和借用构造函数的缺陷，instanceof 和 isPropertyof() 能够用于识别基于组合继承创建的对象<br>
缺点，两次调用了构造函数，有一次造成了属性的浪费</p> <h4 id="_6-3-4-原型式继承"><a href="#_6-3-4-原型式继承" class="header-anchor">#</a> 6.3.4 原型式继承</h4> <h4 id="_6-3-5-寄生式继承"><a href="#_6-3-5-寄生式继承" class="header-anchor">#</a> 6.3.5 寄生式继承</h4> <h4 id="_6-3-6-寄生组合式继承"><a href="#_6-3-6-寄生组合式继承" class="header-anchor">#</a> 6.3.6 寄生组合式继承</h4> <p>通过构造函数继承属性，通过原型链混成的形式继承方法（利用object.create方法）</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">inheritPrototype</span><span class="token punctuation">(</span><span class="token parameter">subType<span class="token punctuation">,</span> superType</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> prototype <span class="token operator">=</span> object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>superType<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token comment">// prototype对象的原型指向了superType的原型</span>
  prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> subType  <span class="token comment">// 子类拥有自己的构造器</span>
  subType<span class="token punctuation">.</span>prototype <span class="token operator">=</span> prototype  <span class="token comment">// 子类的原型指向prototype, 而prototype的原型又指向了superType的原型</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">SuperType</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
  <span class="token keyword">this</span><span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token string">'blue'</span><span class="token punctuation">,</span> <span class="token string">'green'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token class-name">SuperType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">SubType</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
  <span class="token function">SuperType</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span> <span class="token comment">// 只继承SuperType的实例属性，并传参</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age
<span class="token punctuation">}</span>
<span class="token function">inheritPrototype</span><span class="token punctuation">(</span>SubType<span class="token punctuation">,</span> SuperType<span class="token punctuation">)</span> <span class="token comment">// 自定义原型链的指向</span>
SubType<span class="token punctuation">.</span><span class="token function-variable function">sayAge</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_6-4-总结"><a href="#_6-4-总结" class="header-anchor">#</a> 6.4 总结</h3> <h2 id="第7章-函数表达式"><a href="#第7章-函数表达式" class="header-anchor">#</a> 第7章 函数表达式</h2> <p>函数声明，函数声明存在函数提升</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">sayName</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span> 
<span class="token comment">// function 是关键字， sayName是标识符</span>
sayName<span class="token punctuation">.</span>name <span class="token comment">// sayName</span>
</code></pre></div><p>函数表达式</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这种形式看起来像常规的变量赋值语句，即创建一个函数，并把它赋值给变量sayName<br>
这种情况下创建的函数叫做匿名函数(anonymous function), 因为function 关键字后面没有标识符(匿名函数有时候也叫拉达姆函数)</p> <p><strong>函数声明，如果重复声明，后面的声明会覆盖前面的声明</strong> <strong>在把函数当成值来使用的时候，都可以使用匿名函数，但这并不是匿名函数的唯一用途</strong></p> <h3 id="_7-1-递归"><a href="#_7-1-递归" class="header-anchor">#</a> 7.1 递归</h3> <p>递归函数是在一个函数通过名字调用自身的情况下构成的</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">factorial</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// factorial是阶乘的意思</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">1</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> num <span class="token operator">*</span> <span class="token function">factorial</span><span class="token punctuation">(</span>num <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这是一个经典的递归阶乘</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> anotherFactorial <span class="token operator">=</span> factorial
factorial <span class="token operator">=</span> <span class="token keyword">null</span>
<span class="token function">alert</span><span class="token punctuation">(</span><span class="token function">anotherFactorial</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 出错</span>
</code></pre></div><p>在调用anotherFactorial时，必须要执行factorial，但是factorial已经是null了，所以报错<br>
上述赋值赋值语句，即声明了 一个  函数表达式</p> <p>可以用arguments.callee解决函数调用自身出错的情况</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">factorial</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">1</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> num <span class="token operator">*</span> arguments<span class="token punctuation">.</span><span class="token function">callee</span><span class="token punctuation">(</span>num <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_7-2-闭包"><a href="#_7-2-闭包" class="header-anchor">#</a> 7.2 闭包</h3> <p>以下述代码为例<br>
比较两个对象的属性值，并进行排序</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">createComparisonFunction</span><span class="token punctuation">(</span><span class="token parameter">propertyName</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">object1<span class="token punctuation">,</span> object2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> value1 <span class="token operator">=</span> <span class="token function">object1</span><span class="token punctuation">(</span>propertyName<span class="token punctuation">)</span>
    <span class="token keyword">var</span> value2 <span class="token operator">=</span> <span class="token function">object2</span><span class="token punctuation">(</span>propertyName<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>value1 <span class="token operator">&lt;</span> value2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span>  <span class="token comment">// 小在大前面，不交换顺序，升序排序</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">(</span>value <span class="token operator">&gt;</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token number">1</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token number">0</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>即便在别的地方调用了这个返回的函数，我们仍然能够获取到PropertyName这个变量</p> <p><strong>当函数第一次被调用时，会创建一个执行环境(execution context) 及相应的作用域链，并把作用域链赋值给一个特殊的属性[[scope]]，然后，使用this， arguments和其他命名参数的值来初始化函数的活动对象(activation object), 在作用域链中，外部函数的活动对象始终处于第二位，外部函数的外部函数的活动对象处于第三位，...... 直到作用域链终点的全局执行环境(即变量的查找过程)</strong></p> <p>在函数执行过程中，为了读取和写入变量的值，就需要在作用域链查找变量</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> compare <span class="token operator">=</span> <span class="token function">createComparisonFunction</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token function">compare</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">'nico'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">'luffy'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>在匿名函数从 createComparisonFunction() 中被返回后，它的作用域链被初始化为包含createComparisonFunction() 函数的活动对象和全局变量对象，这样，匿名函数就可以访问在 createComparisonFunction() 中定义的所有变量，更为重要的是，createComparisonFunction() 函数在执行完毕后，其活动对象也不会被销毁，因为匿名函数的作用域链仍然在引用这个活动对象。换句话说，当createComparisonFunction() 函数返回后，其执行环境的作用域链会被销毁，但它的活动对象仍然留在内存中，直到匿名函数被销毁后，createComparisonFunction()的活动对象才会被销毁，例如:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 创建函数</span>
<span class="token keyword">var</span> compareNames <span class="token operator">=</span> <span class="token function">createComparisonFunction</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span>
<span class="token comment">// 调用函数</span>
<span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token function">compareNames</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">'nico'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">'luffy'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 解除对匿名函数的引用(以便释放内存)</span>
compareNames <span class="token operator">=</span> <span class="token keyword">null</span>
</code></pre></div><p><img src="/reading-notes/assets/img/execution_context.61224326.jpg" alt="执行环境与作用域链"></p> <p>上图展示了调用compareNames()的过程中产生的作用域链之间的关系，compareNames的执行环境中有三个变量，object1,object2,arguments，但同时又引用了createComparisonFunction作用域的值，因此，createComparisonFunction的活动对象也被推进了执行环境，，而所有函数的作用域链末端都有个全局执行的环境</p> <h4 id="_7-2-1-闭包与变量"><a href="#_7-2-1-闭包与变量" class="header-anchor">#</a> 7.2.1 闭包与变量</h4> <h4 id="_7-2-2-关于this对象"><a href="#_7-2-2-关于this对象" class="header-anchor">#</a> 7.2.2 关于this对象</h4> <p>this是基于函数的执行环境绑定的，</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'The Window'</span>
<span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'My Object'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">getNameFunc</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">alert</span><span class="token punctuation">(</span>object<span class="token punctuation">.</span> <span class="token function">getNameFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 'The Window'，在非严格模式下</span>
</code></pre></div><p>object包括一个方法getNameFunc，这个函数返回一个匿名函数，而匿名函数又返回this.name<br>
执行<code>object.getNameFunc()</code> 会立即返回一个函数,因此调用<code>object.getNameFunc()()</code>就会立即调用它返回的函数，结果就是返回一个字符串<br>
这个例子返回的是<code>The Window</code>，即全局name的值，为什么匿名函数没有取得包含作用域(或外部作用域)的this对象呢？</p> <p><strong>每个函数被调用的时候，其活动对象都会自动取得两个特殊变量: this和arguments，内部函数在搜寻这两个变量时，只会搜到其活动变量为止，因为返回的匿名函数外部的活动变量是window?</strong>
改造：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'The Window'</span>
<span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'My Object'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">getNameFunc</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> that <span class="token operator">=</span> <span class="token keyword">this</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> that<span class="token punctuation">.</span>name
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">alert</span><span class="token punctuation">(</span>object<span class="token punctuation">.</span> <span class="token function">getNameFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
</code></pre></div><p>在定义匿名函数之前，我们把this对象赋给了一个名叫that的变量，即使在函数返回之后，<strong>闭包</strong>也可访问这个变量，<br>
通过<code>that = this</code>这个赋值语句，匿名函数的活动对象的变量<code>that</code>引用着<code>getNameFunc()</code>，因此，匿名函数的执行环境就延伸到了<code>getNameFunc()</code>，因此可以获得<code>getNameFunc</code>的<code>this</code>变量</p> <blockquote><p>在几种特殊的情况下，this的值可能会意外的改变</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'The Window'</span>
<span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'My Object'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">getName</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 调用</span>
object<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>object<span class="token punctuation">.</span>getName<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>object<span class="token punctuation">.</span>getName <span class="token operator">=</span> object<span class="token punctuation">.</span>getName<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>第一行代码像平常一样调用了object.getName()，返回的是My Object<br>
第二行代码在调用这个方法之前加了括号，加上括号之后，就好像在引用一个函数，但this的值得到了维持，因为object.getName和(object.getName)的定义是相同的<br>
第三行代码先执行了一条赋值语句，然后再调用赋值后的结果，因为这个函数表达式的值是函数本身，所以this的值不可能得到维持，所以就返回了<code>The Window</code> ？？？</p> <h4 id="_7-2-3-内存泄漏"><a href="#_7-2-3-内存泄漏" class="header-anchor">#</a> 7.2.3 内存泄漏</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">assignHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> element <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'someElement'</span><span class="token punctuation">)</span>
  element<span class="token punctuation">.</span><span class="token function-variable function">onClick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span>element<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>以上代码创建了作为element元素事件处理的闭包，而这个闭包又创建了循环引用？？？(事件在第13章)，匿名函数保存了一个对assignHandler活动对象的引用，因此导致无法减少element的引用数，只要匿名函数存在，element的引用数至少为1，因此它所占用的内存就永远不会被回收</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">assignHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> element <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'someElement'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> id <span class="token operator">=</span> element<span class="token punctuation">.</span>id
  element<span class="token punctuation">.</span><span class="token function-variable function">onClick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  element <span class="token operator">=</span> <span class="token keyword">null</span> 
<span class="token punctuation">}</span>
</code></pre></div><p>稍微改造一下，但是并不能完全解决内存泄漏问题</p> <h3 id="_7-3-模仿块级作用域"><a href="#_7-3-模仿块级作用域" class="header-anchor">#</a> 7.3 模仿块级作用域</h3> <p>匿名函数</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 这里是块级作用域</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">someFunction</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 这里是块级作用域</span>
<span class="token punctuation">}</span>
<span class="token function">someFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 这里是块级作用域</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 报错</span>
</code></pre></div><p>这段代码会报语法错误，因为Javascript将function关键字当作一个函数声明的开始，而函数声明后面不能跟圆括号，然而，函数表达式的后面可以跟圆括号，<strong>要将函数声明转换成函数表达式，只需要像下面这样给它加上圆括号即可</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 这里是块级作用域</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>无论在什么地方，只要临时需要一些变量，就可以使用私有作用域，例如</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">outputNumbers</span><span class="token punctuation">(</span><span class="token parameter">count</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> count<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">alert</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">alert</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token comment">// 报错</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_7-4-私有变量"><a href="#_7-4-私有变量" class="header-anchor">#</a> 7.4 私有变量</h3> <p>js中没有私有成员的概念，所有对象属性都是公有的，不过有私有变量的概念，任何函数中定义的变量，都可以认为是私有变量，因为不能在函数的外部访问这些变量<br>
私有变量包括函数的参数，局部变量和函数内部定义的其他函数</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> sum <span class="token operator">=</span> num1 <span class="token operator">+</span> num2
  <span class="token keyword">return</span> sum
<span class="token punctuation">}</span>
</code></pre></div><p>add函数包括三个局部变量，num1,num2,sum，在函数内部可以访问这些变量，但在函数外部访问不到<br>
如果在函数内部创建一个闭包，那么闭包通过自己的作用域链也可以访问这些变量，利用这一点，就可以创建用于访问私有变量的公有方法<br>
我们把有权访问私有变量和私有函数的公有方法成为特权方法<br>
有两种在对象上创建特权方法的方式，第一种是在构造函数中定义特权方法，基本模式如下： (第二种是私有作用域方式)</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">MyObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 私有变量和私有函数</span>
  <span class="token keyword">var</span> privateVariable <span class="token operator">=</span> <span class="token number">10</span>
  <span class="token keyword">function</span> <span class="token function">privateFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 特权方法</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">publicMethod</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    privateVariable <span class="token operator">++</span>
    <span class="token keyword">return</span> <span class="token function">privateFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>对于这个例子，变量privateVariable和函数privateFunction()只能通过特权方法publicMethod()来访问</p> <h4 id="_7-4-1-静态私有变量"><a href="#_7-4-1-静态私有变量" class="header-anchor">#</a> 7.4.1 静态私有变量</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="_7-4-2-模块模式"><a href="#_7-4-2-模块模式" class="header-anchor">#</a> 7.4.2 模块模式</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">singleton</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// singleton是单例的意思</span>
  <span class="token comment">// 私有变量和私有函数</span>
  <span class="token keyword">var</span> privateVariable <span class="token operator">=</span> <span class="token number">10</span>
  <span class="token keyword">function</span> <span class="token function">privateFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 特权/公有方法和属性</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    publicProperty<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token function-variable function">publicMethod</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      privateVariable <span class="token operator">++</span>
      <span class="token keyword">return</span> <span class="token function">privateFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这个函数返回的对象字面量只包含公开的属性和方法</p> <h4 id="_7-4-3-增强的模块模式"><a href="#_7-4-3-增强的模块模式" class="header-anchor">#</a> 7.4.3 增强的模块模式</h4> <h3 id="_7-5-小结"><a href="#_7-5-小结" class="header-anchor">#</a> 7.5 小结</h3> <ul><li>函数表达式不同于函数声明，函数声明要求有名字，但是函数表达式并不需要，没有名字的函数表达式也叫匿名函数</li> <li>在函数内部定义了其他函数时，就创建了闭包，闭包有权访问包含函数内部的所有变量</li> <li>通常，函数的作用域及其所有变量都会在函数执行结束后被销毁，但是，当一个函数返回了一个闭包时，这个函数的作用域将一直在内存中保存到闭包不存在为止</li></ul> <h2 id="第8章-bom"><a href="#第8章-bom" class="header-anchor">#</a> 第8章 BOM</h2> <h3 id="_8-1-window对象"><a href="#_8-1-window对象" class="header-anchor">#</a> 8.1 window对象</h3> <p>BOM核心是window，它表示浏览器的一个实例，在浏览器中，window扮演着双重角色，它既是javascript访问浏览器窗口的一个接口，又是ECMAScript规定的Global对象(?)，这意味着在网页中定义的任何一个对象，变量和函数，都已window作为其Global对象，因此有权访问parseInt()等方法</p> <h4 id="_8-1-1-全局作用域"><a href="#_8-1-1-全局作用域" class="header-anchor">#</a> 8.1.1 全局作用域</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> age <span class="token operator">=</span> <span class="token number">22</span>
<span class="token keyword">function</span> <span class="token function">sayAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">alert</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>age<span class="token punctuation">)</span> <span class="token comment">// 29</span>
<span class="token function">sayAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 29</span>
window<span class="token punctuation">.</span><span class="token function">sayAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 29</span>
</code></pre></div><h4 id="_8-1-2-窗口关系及框架"><a href="#_8-1-2-窗口关系及框架" class="header-anchor">#</a> 8.1.2 窗口关系及框架</h4> <h4 id="_8-1-3-窗口位置"><a href="#_8-1-3-窗口位置" class="header-anchor">#</a> 8.1.3 窗口位置</h4> <div class="language-js extra-class"><pre class="language-js"><code>screenTop screenLeft <span class="token operator">?</span>
screenX screenY <span class="token operator">?</span>
</code></pre></div><h4 id="_8-1-4-窗口大小"><a href="#_8-1-4-窗口大小" class="header-anchor">#</a> 8.1.4 窗口大小</h4> <div class="language-js extra-class"><pre class="language-js"><code>innerHeight innerWidth <span class="token comment">// 页面可视部分</span>
outerHeight outerWidth
调整窗口 window<span class="token punctuation">.</span><span class="token function">resizeTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">?</span>
</code></pre></div><h4 id="_8-1-5-导航和打开窗口"><a href="#_8-1-5-导航和打开窗口" class="header-anchor">#</a> 8.1.5 导航和打开窗口</h4> <p><code>window.open()</code><br>
接收四个参数，要加载的URL，窗口目标，一个特性字符串，一个表示新页面是否取代浏览器历史记录中当前加载页面的布尔值<br>
如果给window.open传递的第二个参数并不是一个已经存在的窗口或者框架，那么该方法会对第三个参数上传入的字符串创建一个新窗口或标签页<br>
第三个参数包含<code>left top width height resizable scrollbars</code> 等等，如</p> <div class="language-js extra-class"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'http://baidu.com'</span><span class="token punctuation">,</span> <span class="token string">'height=500, width=200, top=10, left=20, resizable=yes'</span><span class="token punctuation">)</span>
<span class="token comment">// 打开与关闭</span>
<span class="token keyword">var</span> newWindow <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'http://baidu.com'</span><span class="token punctuation">,</span> <span class="token string">'height=500, width=200, top=10, left=20, resizable=yes'</span><span class="token punctuation">)</span>
newWindow<span class="token punctuation">.</span><span class="token function">resizeTo</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span> <span class="token comment">// 调整大小</span>
newWindow<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment">// 移动位置</span>
newWindow<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 关闭窗口，仅限通过window.open()打开的窗口</span>
</code></pre></div><p>安全限制：曾经有一段时间，广告商经常会把弹出窗口打扮成系统对话框的模样，引诱用户去点击其中的广告，浏览器有各自的屏蔽策略</p> <h4 id="_8-1-6-间歇调用与超时调用"><a href="#_8-1-6-间歇调用与超时调用" class="header-anchor">#</a> 8.1.6 间歇调用与超时调用</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 不推荐</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token string">'alert(&quot;hello word&quot;)'</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>  <span class="token comment">// 如果第一个参数传入字符串，则会像eval()函数表现一致，即执行字符串里的代码</span>
<span class="token comment">// 推荐的写法</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
</code></pre></div><p>setTimeout第二个参数是一个表示等待多长事件的毫秒数，但经过该时间的指定的代码并不一定会执行，js是单线程解释器，因此一段时间只能执行一段代码，为了控制要执行的代码，就有一个javascript任务队列，这些任务会按照它们被添加的顺序执行，setTimeout第二个参数告诉js再过多长时间把当前任务添加的js任务队列，如果队列是空的，那么添加的代码会立即执行，如果队列不是空的，那么它就要等前面的代码执行完了以后再执行</p> <p>调用setTimeout之后，该方法会return一个数值ID，这个超时ID是计划执行代码的唯一标识符，可以通过它取消超时调用。要取消尚未调用的超时调用计划，可以调用clearTimeout()方法并将相应的超时ID作为参数传递给它</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 设置超时调用</span>
<span class="token keyword">var</span> timeId <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 把它取消</span>
<span class="token function">clearTimeout</span><span class="token punctuation">(</span>timeoutId<span class="token punctuation">)</span>
</code></pre></div><p>在设置超时调用之前调用clearTimeout，就像什么都没有发生一样</p> <p>间歇调用setInterval,接收参数与setTimeout相同<br>
调用setInterval也同样会返回一个间歇调用ID，该ID可用于在将来某个时间取消间歇调用<br>
取消间歇调用的重要性要远远超过取消超时调用，因为在不加干涉的情况下，间歇调用会一直执行到页面卸载</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> num <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">var</span> max <span class="token operator">=</span> <span class="token number">10</span>
<span class="token keyword">var</span> interval <span class="token operator">=</span> <span class="token keyword">null</span>

<span class="token keyword">function</span> <span class="token function">incrementNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  num <span class="token operator">++</span>
  <span class="token comment">// 执行次数达到max指定值，则取消尚未执行的调用</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token operator">===</span> max<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">clearInterval</span><span class="token punctuation">(</span>intervalId<span class="token punctuation">)</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Done'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

intervalId <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span>incrementNumber<span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>
</code></pre></div><p>可以使用超时调用，模拟间歇调用，最好不要使用间歇调用</p> <h4 id="_8-1-7-系统对话框"><a href="#_8-1-7-系统对话框" class="header-anchor">#</a> 8.1.7 系统对话框</h4> <p><code>alert() confirm() prompt()</code>可以调用系统对话框向用户展示信息，外观由操作系统或浏览器决定，通过这几个方法打开的对话框都是同步和模态的，显示这些对话框的时候代码会停止执行，关掉这些对话框代码又恢复执行<br>
异步执行的对话框</p> <div class="language-js extra-class"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 打印</span>
window<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 查找页面中的值</span>
</code></pre></div><h3 id="_8-2-location对象"><a href="#_8-2-location对象" class="header-anchor">#</a> 8.2 location对象</h3> <p>location对象是一个很特别的对象，因为它既是window对象的属性，也是document对象的属性</p> <table><thead><tr><th>属性名</th> <th>例子</th> <th>说明</th></tr></thead> <tbody><tr><td>hash</td> <td>#mine</td> <td></td></tr> <tr><td>host</td> <td>m.com:80</td> <td></td></tr> <tr><td>hostname</td> <td>m.com</td> <td></td></tr> <tr><td>href</td> <td>m.com/user</td> <td></td></tr> <tr><td>pathname</td> <td>/user</td> <td></td></tr> <tr><td>port</td> <td>80</td> <td></td></tr> <tr><td>protocol</td> <td>http:</td> <td></td></tr> <tr><td>search</td> <td>?name=li</td> <td></td></tr></tbody></table> <h4 id="_8-2-1-查询字符串参数"><a href="#_8-2-1-查询字符串参数" class="header-anchor">#</a> 8.2.1 查询字符串参数</h4> <p>search属性并不能逐个访问其中的每个查询字符串参数，我们可以创建一个函数，用以解析查询字符串，然后返回包含所有参数的一个对象</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">getQueryStringArgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 取得查询字符串并去掉开头的?</span>
  <span class="token keyword">var</span> qs <span class="token operator">=</span> location<span class="token punctuation">.</span>search<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> location<span class="token punctuation">.</span>search<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token string">''</span>
  <span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// 保存数据的对象</span>
  <span class="token comment">// 取得每一项，即保存到数组</span>
  <span class="token keyword">var</span> items <span class="token operator">=</span> qs<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> qs<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'&amp;'</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">var</span> len <span class="token operator">=</span> items<span class="token punctuation">.</span>length

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> item <span class="token operator">=</span> items<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'='</span><span class="token punctuation">)</span> <span class="token comment">// item也是一个被分割的数组</span>
    <span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token function">decodeURIComponent</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// 字符串是被编码过的</span>
    <span class="token keyword">var</span> value <span class="token operator">=</span> <span class="token function">decodeURIComponent</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>name<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      args<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> value
    <span class="token punctuation">}</span> 
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> args
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_8-2-2-位置操作"><a href="#_8-2-2-位置操作" class="header-anchor">#</a> 8.2.2 位置操作</h4> <p>location.href, hash, host, hostname, port, search 等等都会在浏览器产生历史记录，可以通过后退返回<br>
要禁用这种行为，可以使用<code>replace</code><br> <code>reload</code> 可以重新加载当前页面</p> <h3 id="_8-3-navigator对象"><a href="#_8-3-navigator对象" class="header-anchor">#</a> 8.3 navigator对象</h3> <table><thead><tr><th>属性或方法</th> <th>说明</th></tr></thead> <tbody><tr><td>userAgent</td> <td>浏览器的用户代理字符串</td></tr> <tr><td>...</td> <td>...</td></tr></tbody></table> <h4 id="_8-3-1-检测插件"><a href="#_8-3-1-检测插件" class="header-anchor">#</a> 8.3.1 检测插件</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">hasPlugin</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  name <span class="token operator">=</span> name<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> navigator<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>navigator<span class="token punctuation">.</span>plugins<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
<span class="token function">alert</span><span class="token punctuation">(</span><span class="token function">hasPlugin</span><span class="token punctuation">(</span><span class="token string">'Chrome PDF Plugin'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="_8-3-2-注册处理程序"><a href="#_8-3-2-注册处理程序" class="header-anchor">#</a> 8.3.2 注册处理程序</h4> <h3 id="_8-4-screen对象"><a href="#_8-4-screen对象" class="header-anchor">#</a> 8.4 screen对象</h3> <p>获取的是<strong>设备</strong>屏幕相关属性</p> <table><thead><tr><th>属性</th> <th>说明</th></tr></thead> <tbody><tr><td>width</td> <td></td></tr> <tr><td>height</td> <td></td></tr></tbody></table> <h3 id="_8-5-history对象"><a href="#_8-5-history对象" class="header-anchor">#</a> 8.5 history对象</h3> <div class="language-js extra-class"><pre class="language-js"><code>history<span class="token punctuation">.</span><span class="token function">go</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
history<span class="token punctuation">.</span><span class="token function">go</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
history<span class="token punctuation">.</span><span class="token function">go</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
history<span class="token punctuation">.</span><span class="token function">go</span><span class="token punctuation">(</span><span class="token string">'baidu.com'</span><span class="token punctuation">)</span> <span class="token comment">// 只要浏览器历史记录里有这个值，就会跳转</span>
<span class="token comment">// 代替go</span>
history<span class="token punctuation">.</span><span class="token function">forward</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
history<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
history<span class="token punctuation">.</span>length <span class="token comment">// 历史记录的条数 ？？</span>
</code></pre></div><h3 id="_8-6-小结"><a href="#_8-6-小结" class="header-anchor">#</a> 8.6 小结</h3> <h2 id="第9章-客户端检测"><a href="#第9章-客户端检测" class="header-anchor">#</a> 第9章 客户端检测</h2> <p>由于浏览器之间的差异</p> <h3 id="_9-1-能力检测"><a href="#_9-1-能力检测" class="header-anchor">#</a> 9.1 能力检测</h3> <p>识别浏览器的能力</p> <h3 id="_9-2-怪癖检测-quirks-detection"><a href="#_9-2-怪癖检测-quirks-detection" class="header-anchor">#</a> 9.2 怪癖检测(quirks detection)</h3> <h3 id="_9-3-用户代理检测"><a href="#_9-3-用户代理检测" class="header-anchor">#</a> 9.3 用户代理检测</h3> <p>navigator.userAgent
Mozilla/版本号 [语言] (平台：加密类型)
<code>&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36&quot;</code></p> <h3 id="_9-4-总结"><a href="#_9-4-总结" class="header-anchor">#</a> 9.4 总结</h3> <h2 id="第10章-dom"><a href="#第10章-dom" class="header-anchor">#</a> 第10章 DOM</h2> <h3 id="_10-1-节点层次"><a href="#_10-1-节点层次" class="header-anchor">#</a> 10.1 节点层次</h3> <p><code>&lt;html&gt;</code>元素称之为文档元素
<img src="/reading-notes/assets/img/document_tree.8f7f308c.jpg" alt="文档树解构"></p> <h4 id="_10-1-1-node类型"><a href="#_10-1-1-node类型" class="header-anchor">#</a> 10.1.1 Node类型</h4> <p><em>nodeName, nodeType, nodeValue属性</em><br>
nodeName是大写如<code>LI``DIV</code>,但是document除外，nodeType为1说明是元素节点
节点关系使用childNodes属性，其中包含一个NodeList对象，类数组对象，可以使用<code>Array.prototype.slice(xxx, 0)</code> 或<code>Array.from()</code>将其转换成数组对象<br>
每个节点都有parentNode, previousSibling, nextSibling属性<br>
父节点的firstChild和 lastChild分别指向父节点的第一个和最后一个节点</p> <div class="language-js extra-class"><pre class="language-js"><code>someNode<span class="token punctuation">.</span>childNodes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
someNode<span class="token punctuation">.</span><span class="token function">previousSibling</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>操作节点<br> <code>appendChild()</code> 末尾增加节点<br> <code>insertBefore()</code> 插入到指定节点<br> <code>replaceChild()</code>接收两个参数，要插入的节点和要替换的节点<br> <code>cloneNode()</code></p> <h4 id="_10-1-2-document类型"><a href="#_10-1-2-document类型" class="header-anchor">#</a> 10.1.2 Document类型</h4> <p>Document对象是window对象的一个属性<br>
Document节点具有以下特征：<br>
nodeType为9，nodeName为'#document',nodeValue为null,parentNode为null,ownerDocument为null</p> <p>文档的子节点：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> html <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement  <span class="token comment">// 取得对&lt;html&gt;的引用</span>
<span class="token keyword">var</span> body <span class="token operator">=</span> document<span class="token punctuation">.</span>body  <span class="token comment">// 取得对&lt;body&gt;的引用</span>
<span class="token keyword">var</span> doctype <span class="token operator">=</span> document<span class="token punctuation">.</span>doctype  <span class="token comment">// 取得对&lt;!DOCTYPE&gt;的引用</span>
<span class="token keyword">var</span> originTitle <span class="token operator">=</span> document<span class="token punctuation">.</span>title <span class="token comment">// 取得文档标题</span>
document<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">'New Page'</span> <span class="token comment">// 设置文档标题</span>
<span class="token keyword">var</span> url <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token constant">URL</span> <span class="token comment">// 取得完整的URL</span>
<span class="token keyword">var</span> domain <span class="token operator">=</span> document<span class="token punctuation">.</span>domain <span class="token comment">// 取得域名</span>
</code></pre></div><p>查找元素<br>
getElementById,getElementByTagName......<br>
文档写入<br>
write,open</p> <h4 id="_10-1-3-element类型"><a href="#_10-1-3-element类型" class="header-anchor">#</a> 10.1.3 Element类型</h4> <p>Element节点具有以下特征：<br>
nodeType, nodeName, nodeValue值为null, parentNode可能是Document或者Element</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">.</span>tagName<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'div'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 在此执行某些操作</span>
<span class="token punctuation">}</span>
</code></pre></div><h5 id="_1-html元素"><a href="#_1-html元素" class="header-anchor">#</a> 1.HTML元素</h5> <h5 id="_2-取得属性"><a href="#_2-取得属性" class="header-anchor">#</a> 2.取得属性</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span>  div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'myDiv'</span><span class="token punctuation">)</span>
<span class="token function">alert</span><span class="token punctuation">(</span>div<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 获取id属性的值</span>
</code></pre></div><h5 id="_3-设置属性"><a href="#_3-设置属性" class="header-anchor">#</a> 3.设置属性</h5> <p><code>setAttribute</code></p> <h5 id="_4-attributes属性"><a href="#_4-attributes属性" class="header-anchor">#</a> 4.Attributes属性</h5> <h5 id="_5-创建元素"><a href="#_5-创建元素" class="header-anchor">#</a> 5.创建元素</h5> <p><code>document.createElement</code></p> <h5 id="_6-元素的子元素"><a href="#_6-元素的子元素" class="header-anchor">#</a> 6.元素的子元素</h5> <p><code>childNodes</code><br> <code>nodeType === 1</code>表明是元素节点</p> <h4 id="_10-1-4-text类型"><a href="#_10-1-4-text类型" class="header-anchor">#</a> 10.1.4 Text类型</h4> <p>nodeType是3，nodeName是'#text', nodeValue的值为节点所包含的文本，parentNode是一个Element，没有子节点</p> <ul><li>创建文本节点，规范化文本节点，分割文本节点</li></ul> <h4 id="_10-1-5-comment类型"><a href="#_10-1-5-comment类型" class="header-anchor">#</a> 10.1.5 Comment类型</h4> <h4 id="_10-1-6-cdatasection类型"><a href="#_10-1-6-cdatasection类型" class="header-anchor">#</a> 10.1.6 CDATASection类型</h4> <h4 id="_10-1-7-documenttype类型"><a href="#_10-1-7-documenttype类型" class="header-anchor">#</a> 10.1.7 DocumentType类型</h4> <h4 id="_10-1-8-documentfragment类型"><a href="#_10-1-8-documentfragment类型" class="header-anchor">#</a> 10.1.8 DocumentFragment类型</h4> <h4 id="_10-1-9-attr类型"><a href="#_10-1-9-attr类型" class="header-anchor">#</a> 10.1.9 Attr类型</h4> <h3 id="_10-2-dom操作技术"><a href="#_10-2-dom操作技术" class="header-anchor">#</a> 10.2 DOM操作技术</h3> <h4 id="_10-2-1-动态脚本"><a href="#_10-2-1-动态脚本" class="header-anchor">#</a> 10.2.1 动态脚本</h4> <p><code>&lt;script&gt;</code></p> <h4 id="_10-2-2-动态样式"><a href="#_10-2-2-动态样式" class="header-anchor">#</a> 10.2.2 动态样式</h4> <p><code>&lt;style&gt;``&lt;link&gt;</code></p> <h4 id="_10-2-3-操作表格"><a href="#_10-2-3-操作表格" class="header-anchor">#</a> 10.2.3 操作表格</h4> <p><code>&lt;table&gt;</code>元素是HTML中最复杂的结构之一</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tbody</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>Cell 1,1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>Cell 2,1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>Cell 1,2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>Cell 2,2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tbody</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h4 id="_10-2-4-使用nodelist"><a href="#_10-2-4-使用nodelist" class="header-anchor">#</a> 10.2.4 使用NodeList</h4> <h3 id="_10-3-小结"><a href="#_10-3-小结" class="header-anchor">#</a> 10.3 小结</h3> <h2 id="第11章-dom扩展"><a href="#第11章-dom扩展" class="header-anchor">#</a> 第11章 DOM扩展</h2> <h3 id="_11-1-选择符api"><a href="#_11-1-选择符api" class="header-anchor">#</a> 11.1 选择符API</h3> <h4 id="_11-1-1-queryselector-方法"><a href="#_11-1-1-queryselector-方法" class="header-anchor">#</a> 11.1.1 querySelector()方法</h4> <h4 id="_11-1-2-queryselectorall-方法"><a href="#_11-1-2-queryselectorall-方法" class="header-anchor">#</a> 11.1.2 querySelectorAll()方法</h4> <h4 id="_11-1-3-matchesselector-方法"><a href="#_11-1-3-matchesselector-方法" class="header-anchor">#</a> 11.1.3 matchesSelector()方法</h4> <h3 id="_11-2-元素遍历"><a href="#_11-2-元素遍历" class="header-anchor">#</a> 11.2 元素遍历</h3> <h3 id="_11-3-html5"><a href="#_11-3-html5" class="header-anchor">#</a> 11.3 HTML5</h3> <h4 id="_11-3-1-与类相关的扩充"><a href="#_11-3-1-与类相关的扩充" class="header-anchor">#</a> 11.3.1 与类相关的扩充</h4> <p>getElementsByClassName</p> <h4 id="_11-3-2-焦点管理"><a href="#_11-3-2-焦点管理" class="header-anchor">#</a> 11.3.2 焦点管理</h4> <h4 id="_11-3-3-htmldocument的变化"><a href="#_11-3-3-htmldocument的变化" class="header-anchor">#</a> 11.3.3 HTMLDocument的变化</h4> <h4 id="_11-3-4-字符集属性"><a href="#_11-3-4-字符集属性" class="header-anchor">#</a> 11.3.4 字符集属性</h4> <h4 id="_11-3-5-自定义数据属性"><a href="#_11-3-5-自定义数据属性" class="header-anchor">#</a> 11.3.5 自定义数据属性</h4> <p>要添加前缀 data-</p> <h4 id="_11-3-6-插入标记"><a href="#_11-3-6-插入标记" class="header-anchor">#</a> 11.3.6 插入标记</h4> <p>innerHTML outerHTML</p> <h4 id="_11-3-7-scrollintoview-方法"><a href="#_11-3-7-scrollintoview-方法" class="header-anchor">#</a> 11.3.7  scrollIntoView()方法</h4> <h3 id="_11-4-专有扩展"><a href="#_11-4-专有扩展" class="header-anchor">#</a> 11.4 专有扩展</h3> <h4 id="_11-4-1-文档模式"><a href="#_11-4-1-文档模式" class="header-anchor">#</a> 11.4.1 文档模式</h4> <h4 id="_11-4-2-children属性"><a href="#_11-4-2-children属性" class="header-anchor">#</a> 11.4.2 children属性</h4> <h4 id="_11-4-3-contains-方法"><a href="#_11-4-3-contains-方法" class="header-anchor">#</a> 11.4.3 contains()方法</h4> <h4 id="_11-4-4-插入文本"><a href="#_11-4-4-插入文本" class="header-anchor">#</a> 11.4.4 插入文本</h4> <p>innerText outText</p> <h4 id="_11-4-5-滚动"><a href="#_11-4-5-滚动" class="header-anchor">#</a> 11.4.5 滚动</h4> <h3 id="_11-5-小结"><a href="#_11-5-小结" class="header-anchor">#</a> 11.5 小结</h3> <h2 id="第12章-dom2和dom3"><a href="#第12章-dom2和dom3" class="header-anchor">#</a> 第12章 DOM2和DOM3</h2> <h3 id="_12-1-dom的变化"><a href="#_12-1-dom的变化" class="header-anchor">#</a> 12.1 DOM的变化</h3> <h3 id="_12-2-样式"><a href="#_12-2-样式" class="header-anchor">#</a> 12.2 样式</h3> <h4 id="_12-2-1-访问元素的样式"><a href="#_12-2-1-访问元素的样式" class="header-anchor">#</a> 12.2.1 访问元素的样式</h4> <p>支持style属性的HTML元素在JS中都有一个对应的style属性，对于使用短划线-的属性要使用驼峰命名法<br>
虽然style对象能够提供支持style特性的任何元素的样式信息，但它不包含那些从其他样式表层叠而来并影响到当前元素的样式信息<br>
DOM2级样式提供了getComputedStyle()方法，可以传入两个参数</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> elem1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;elemId&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> style <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">getComputedStyle</span><span class="token punctuation">(</span>elem1<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 它等价于</span>
<span class="token comment">// let style = document.defaultView.getComputedStyle(elem1, null);</span>
</code></pre></div><h4 id="_12-2-2-操作样式表"><a href="#_12-2-2-操作样式表" class="header-anchor">#</a> 12.2.2 操作样式表</h4> <h4 id="_12-2-3-元素大小"><a href="#_12-2-3-元素大小" class="header-anchor">#</a> 12.2.3 元素大小</h4> <p>偏移量(offset dimension)</p> <div class="language-js extra-class"><pre class="language-js"><code>offsetHeight <span class="token comment">// 垂直方向</span>
offsetWidth <span class="token comment">// 水平方向，包括元素宽度，滚动条，左右边框宽度</span>
offsetLeft <span class="token comment">// 左外边框至元素左内边框距离</span>
offsetTop <span class="token comment">// 元素上外边框至元素上内边框距离</span>
</code></pre></div><p><img src="data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAXsAAADTCAYAAABgBrM8AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAACU/SURBVHhe7Z15sBTV2Ye//yQmUYMo0cRYgEvcrWASUzGLSipaSQwaKzFJJZCoxB0NmyIoi6wqiyCrsu/7vqhAQPZVkEVkR9llEZCdnK+elzk3zdCXe+fembkz3b+n6q07faanu2du99On3z59zv85IYQQkUeyF0KIGCDZCyFEDJDshRAiBkj2QggRA8pE9iNHjnQdOnSwmDt3rpUdOXLEjRo1qqB88eLFVi6EEKL0ZF32X331lbvqqqvcvffe626//XY3bdo0K1+zZo2rUKGCq1Sp0lnl5+PYsWNu//79iakzNG/e3M2ePTsxdYYuXbq4H/3oRwVRrVo1N336dPff//43MUf6OHz4cOKVs+X37dvXtW/fPlEihBBlQ8Zk361bN9eoUSOLVq1auW3btrnNmze7mjVrugsvvNA9/PDD7o033nA7d+50q1atcs8995y74IIL3EMPPWSf+fTTT93JkyfdsGHDCpbTokULt3btWlv+0KFD3VNPPeUefPBBk+m+ffvc1KlT3c033+x+97vf2fwTJkyweblKuO2229xdd93l2rRpY/PUqlXL7dmzx7311lsFyx8wYICdQBYuXOgaN25swYmC95D2F1984Xr37l0wf9euXa2MbfFlf//73+0vVyps6/e+9z134403Whnr3r59u22TEEJkk4zIvk6dOq5y5cqudevWrmPHju773/++GzRokMn+xRdfdN/+9rddjRo13ODBg92uXbtMjJQj+2eeecZeU0P+8ssv3SWXXGJC/8Mf/uCuvPJKN3nyZEv3UE4N/dFHH3Vf//rXXbt27dzSpUvdDTfcYPOyDOQNhw4dspML5TNnzjTp16tXz3322Wfu2WefdU2bNnX33Xefu+KKK6yM5bz00kvuoosusnV07tzZNWnSxK4GKPvTn/5kJype169f382YMcNdffXV7tprr7Vyrh5IRfEdbrnlFov//Oc/dsI7fvy4bZMQQmSTtMueGvZvf/tbq+F6ECu1cs8999zjNm7cmJg6w4oVK0z2wZrvgQMHrOyOO+6wQKYLFixwDRo0sHLSPYib14899ph9htp+cgrIy54TxJ13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" alt="图示"></p> <p>客户区大小(client dimension)</p> <div class="language-js extra-class"><pre class="language-js"><code>clientHeight <span class="token comment">// 不包含边框的元素高度</span>
clientWidth
</code></pre></div><p><img src="data:image/jpeg;base64,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" alt="client dimension"></p> <p>滚动大小(scroll dimension)</p> <div class="language-js extra-class"><pre class="language-js"><code>scrollHeight <span class="token comment">// 元素内容总高度(真实高度，&gt;=scrollTop)</span>
scrollWidth
scrollLeft 
scrollTop  <span class="token comment">// 当前元素页面显示区域距离顶部距离，包含滚动条，&lt;= scrollHeight，除了html元素其他为0？</span>
document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>scrollHeight <span class="token comment">// 带有滚动条的页面总高度 &lt;html&gt;</span>
document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>scrollTop  <span class="token comment">// 视口</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>scrollHeight <span class="token comment">// 带有滚动条的页面总高度 &lt;body&gt; , 可以替代上面的方式</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>scrollTop <span class="token comment">// 视口</span>
</code></pre></div><p><img src="/reading-notes/assets/img/scroll_dimension.98662f25.jpg" alt="client dimension"></p> <p>元素大小<br>
getBoundingClientRect(), 这个方法会返回一个矩形对象，包含四个属性: left,top,right,bottom, 获取元素在页面中相对于视口(视觉区域)的位置</p> <h3 id="_12-3-遍历"><a href="#_12-3-遍历" class="header-anchor">#</a> 12.3 遍历</h3> <p>dom节点的遍历</p> <h4 id="_12-3-1-nodeiterator"><a href="#_12-3-1-nodeiterator" class="header-anchor">#</a> 12.3.1 NodeIterator</h4> <h4 id="_12-3-2-treewalker"><a href="#_12-3-2-treewalker" class="header-anchor">#</a> 12.3.2 TreeWalker</h4> <h3 id="_12-4-范围"><a href="#_12-4-范围" class="header-anchor">#</a> 12.4 范围</h3> <h4 id="_12-4-1-dom中的范围"><a href="#_12-4-1-dom中的范围" class="header-anchor">#</a> 12.4.1 DOM中的范围</h4> <h4 id="_12-4-2-ie8及更早版本的范围"><a href="#_12-4-2-ie8及更早版本的范围" class="header-anchor">#</a> 12.4.2 IE8及更早版本的范围</h4> <h3 id="_12-5-小结"><a href="#_12-5-小结" class="header-anchor">#</a> 12.5 小结</h3> <p>DOM2级规范定义了一些模块，用于增强DOM1级<br>
DOM2级样式模块主要针对操作元素的样式信息而开发，其特性简洁总结如下：</p> <ul><li>每个元素有一个关联的style对象，用来确定和修改元素的行内样式</li> <li>确定某个元素的计算样式，使用getComputedStyle()</li></ul> <h2 id="第13章-事件"><a href="#第13章-事件" class="header-anchor">#</a> 第13章 事件</h2> <h3 id="_13-1-事件流"><a href="#_13-1-事件流" class="header-anchor">#</a> 13.1 事件流</h3> <h4 id="_13-1-1-事件冒泡-event-bubbling"><a href="#_13-1-1-事件冒泡-event-bubbling" class="header-anchor">#</a> 13.1.1 事件冒泡(event bubbling)</h4> <p>事件开始由最具体的元素(文档嵌套层次最深的那个节点)接收，然后逐级向上传播到较为不具体的节点(文档)</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>Click me<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>当点击了div元素，那么这个click事件会按照下面顺序传播：div -&gt; body -&gt; html -&gt; document</p> <h4 id="_13-1-2-事件捕获-event-capturing"><a href="#_13-1-2-事件捕获-event-capturing" class="header-anchor">#</a> 13.1.2 事件捕获(event capturing)</h4> <p>事件捕获的思想是不太具体的节点更早接收事件，而具体的节点应该最后接收到事件，事件捕获的用意在于在事件到达预定目标之前捕获它<br>
当点击了div元素，会以下面顺序触发click事件：document -&gt; html -&gt; body -&gt; div<br>
不过大部分浏览器是从window对象开始的</p> <h4 id="_13-1-3-dom事件流"><a href="#_13-1-3-dom事件流" class="header-anchor">#</a> 13.1.3 DOM事件流</h4> <p>DOM2级事件规定的事件流包括三个阶段，事件捕获阶段，处于目标阶段和事件冒泡阶段</p> <h3 id="_13-2-事件处理程序"><a href="#_13-2-事件处理程序" class="header-anchor">#</a> 13.2 事件处理程序</h3> <p>事件就是用户或者浏览器自身执行的某种动作，如click, load和mouseover都是事件的名字，而相应某个事件的函数就叫做事件处理程序(或事件监听器)，事件处理程序的名字以“on”开头，因此click事件的处理程序就是onclick, load的事件处理程序就是onload</p> <h4 id="_13-2-1-html事件处理程序"><a href="#_13-2-1-html事件处理程序" class="header-anchor">#</a> 13.2.1 HTML事件处理程序</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 通过指定onclick特性并将一些Javascript代码作为它的值来定义的，因为这个值是Js,所以不能再其中使用未经转义的HTML语法字符，如&amp;，双引号&quot;&quot;, &lt;或&gt;</span>
<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;button&quot;</span> value<span class="token operator">=</span><span class="token string">&quot;Click Me&quot;</span> onclick<span class="token operator">=</span><span class="token string">&quot;alert('clicked !')&quot;</span><span class="token operator">&gt;</span>

<span class="token comment">// 调用在其他页面定义的脚本</span>
<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;button&quot;</span> value<span class="token operator">=</span><span class="token string">&quot;Click Me&quot;</span> onclick<span class="token operator">=</span><span class="token string">&quot;showMessage()&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
    <span class="token keyword">function</span> <span class="token function">showMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Hello World'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><p>指定事件处理程序会创建一个封装着元素属性值的函数，这个函数有一个局部变量event，也就是事件对象<br>
如果用户在解析showMessage函数之前就单击了按钮，就会引发错误，可以使用try...catch把showMessage包裹起来<br>
HTML指定事件处理程序一个缺点是HTML与JS代码紧密耦合，如果要更换事件处理程序，要同时改动HTML代码和Javascript代码，更多转而使用JS指定事件处理程序</p> <h4 id="_13-2-2-dom0级事件处理程序"><a href="#_13-2-2-dom0级事件处理程序" class="header-anchor">#</a> 13.2.2 DOM0级事件处理程序</h4> <p>每个元素都有自己的事件处理程序属性，这些属性通常小写，如onclick，将这种属性的值设置为一个函数，就可以指定事件处理程序</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'myBtn'</span><span class="token punctuation">)</span>
btn<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Clicked'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>使用DOM0级方法指定的事件处理程序是在元素的作用域中执行，换句话说，程序中的this引用当前元素</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'myBtn'</span><span class="token punctuation">)</span>
btn<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token comment">// myBtn</span>
<span class="token punctuation">}</span>
btn<span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token keyword">null</span> <span class="token comment">// 删除事件处理程序</span>
</code></pre></div><h4 id="_13-2-3-dom2级事件处理程序"><a href="#_13-2-3-dom2级事件处理程序" class="header-anchor">#</a> 13.2.3 DOM2级事件处理程序</h4> <p>&quot;DOM2级事件处理程序&quot;定义了两个方法，用于指定和删除事件处理程序的操作：addEventListener() 和 removeEventListener()，所有DOM节点都包含这两个方法，他们接收三个参数，要处理的事件名，作为事件处理的函数，一个布尔值，布尔值如果是true，表示在捕获阶段调用事件处理程序，若为false，则在冒泡阶段调用事件处理程序，默认是false</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'myBtn'</span><span class="token punctuation">)</span>
btn<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
btn<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 没有用， 参数必须要与传入addEventListener相同</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'myBtn'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> <span class="token function-variable function">handler</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
btn<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> handler<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
btn<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> handler<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token comment">// 有效</span>
</code></pre></div><h4 id="_13-2-4-ie事件处理程序"><a href="#_13-2-4-ie事件处理程序" class="header-anchor">#</a> 13.2.4 IE事件处理程序</h4> <p>attachEvent, detachEvent, 两个参数，第一个参数加on</p> <h4 id="_13-2-5-跨浏览器的事件处理程序"><a href="#_13-2-5-跨浏览器的事件处理程序" class="header-anchor">#</a> 13.2.5 跨浏览器的事件处理程序</h4> <h3 id="_13-3-事件对象"><a href="#_13-3-事件对象" class="header-anchor">#</a> 13.3 事件对象</h3> <p>触发DOM的某个事件时，会产生一个事件对象event, 这个对象包含着所有与事件相关的信息，包括导致事件的元素，事件的类型，及其他与特定事件相关的信息，例如，鼠标操作导致的事件对象中，会包含鼠标位置的信息，而键盘操作导致的事件对象中，会包含与按下的键有关的信息<br>
只有在事件处理程序执行期间，event</p> <h4 id="_13-3-1-dom中的事件对象"><a href="#_13-3-1-dom中的事件对象" class="header-anchor">#</a> 13.3.1 DOM中的事件对象</h4> <table><thead><tr><th>属性/方法</th> <th>类型</th> <th>读/写</th> <th>说明</th></tr></thead> <tbody><tr><td>bubbles</td> <td>Boolean</td> <td>只读</td> <td>表示事件是否冒泡</td></tr> <tr><td>cancelable</td> <td>Boolean</td> <td>只读</td> <td>表示是否可以取消事件的默认行为</td></tr> <tr><td>currentTarget</td> <td>Element</td> <td>只读</td> <td>其事件处理程序当前正在处理事件的那个元素</td></tr> <tr><td>detail</td> <td>Integer</td> <td>只读</td> <td>与事件相关的细节信息</td></tr> <tr><td>eventPhase</td> <td>Integer</td> <td>只读</td> <td>调用事件处理程序的阶段，1表示捕获，2表示处理目标，3表示冒泡阶段</td></tr> <tr><td>preventDefault</td> <td>Function</td> <td>只读</td> <td>取消事件默认行为，cancelable是true，可以使用这个方法</td></tr> <tr><td>stopPropagation</td> <td>Function</td> <td>只读</td> <td>取消事件的进一步捕获或冒泡，如果bubbles为true，可以使用这个方法</td></tr> <tr><td>stopImmediatePropagation</td> <td>Function</td> <td>只读</td> <td>取消事件的进一步捕获或冒泡，同时阻止任何事件处理程序被调用(DOM3级事件中新增)</td></tr> <tr><td>target</td> <td>Element</td> <td>只读</td> <td>事件的目标元素</td></tr> <tr><td>type</td> <td>String</td> <td>只读</td> <td>触发事件的类型</td></tr></tbody></table> <p>在事件处理程序内部，对象this始终等于currentTarget的值，而target只包含事件的实际目标，如果直接将事件处理程序指定给了目标元素，则this, currentTarget, target包含相同的值</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'myBtn'</span><span class="token punctuation">)</span>
btn<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>currentTarget <span class="token operator">===</span> <span class="token keyword">this</span><span class="token punctuation">)</span>  <span class="token comment">// true</span>
  <span class="token function">alert</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>target <span class="token operator">===</span> <span class="token keyword">this</span><span class="token punctuation">)</span>  <span class="token comment">// true</span>
<span class="token punctuation">}</span>
</code></pre></div><p>由于click事件的目标是按钮，因此这三个值是相等的<br>
如果事件处理程序在父元素body上面，但是点击了btn元素</p> <div class="language-js extra-class"><pre class="language-js"><code>document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>currentTarget <span class="token operator">===</span> document<span class="token punctuation">.</span>body<span class="token punctuation">)</span> <span class="token comment">// true</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">===</span> document<span class="token punctuation">.</span>body<span class="token punctuation">)</span> <span class="token comment">// true</span>
  <span class="token function">alert</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>target <span class="token operator">===</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'myBtn'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
<span class="token punctuation">}</span>
</code></pre></div><p>this和currentTarget等于document 因为事件处理程序是注册到这个元素上的，而target却等于按钮元素，因为它是target的真正目标<br>
当需要通过一个函数处理多个事件时，可以使用type属性</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'myBtn'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> <span class="token function-variable function">handler</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">&quot;click&quot;</span><span class="token operator">:</span>
      <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Clicked!'</span><span class="token punctuation">)</span>
      <span class="token keyword">break</span>
    <span class="token keyword">case</span> <span class="token string">&quot;mouseover&quot;</span><span class="token operator">:</span>
      event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> <span class="token string">'red'</span>
      <span class="token keyword">break</span>
    <span class="token keyword">case</span> <span class="token string">&quot;mouseout&quot;</span><span class="token operator">:</span>
      event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> <span class="token string">''</span>
      <span class="token keyword">break</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
btn<span class="token punctuation">.</span>onclick <span class="token operator">=</span> handler
btn<span class="token punctuation">.</span>mouseover <span class="token operator">=</span> handler
btn<span class="token punctuation">.</span>mouseout <span class="token operator">=</span> handler
</code></pre></div><p>阻止事件默认行为，如链接的默认行为<br>
阻止事件的传播，即取消事件的冒泡与捕获</p> <h4 id="_13-3-2-ie中的事件对象"><a href="#_13-3-2-ie中的事件对象" class="header-anchor">#</a> 13.3.2 IE中的事件对象</h4> <h4 id="_13-3-3-跨浏览器的事件对象"><a href="#_13-3-3-跨浏览器的事件对象" class="header-anchor">#</a> 13.3.3 跨浏览器的事件对象</h4> <h3 id="_13-4-事件类型"><a href="#_13-4-事件类型" class="header-anchor">#</a> 13.4 事件类型</h3> <p>DOM3级事件规定了以下几类事件</p> <ul><li>UI(User Interface，用户界面)事件，当用户与界面上的元素交互时触发</li> <li>焦点事件，当元素获得或者失去焦点时触发</li> <li>鼠标事件，当用户通过鼠标在页面执行操作时触发</li> <li>滚轮事件</li> <li>文本事件</li> <li>键盘事件</li> <li>合成事件，输入法输入字符时触发</li> <li>变动事件，底层DOM结构发生变化时触发</li></ul> <h4 id="_13-4-1-ui事件"><a href="#_13-4-1-ui事件" class="header-anchor">#</a> 13.4.1 UI事件</h4> <ul><li>load 页面加载完，在window上面触发，包括所有图像,js,css</li> <li>unload 页面完全卸载在window上面触发</li> <li>error JS发生错误时在window上触发</li> <li>resize</li> <li>scroll</li></ul> <h4 id="_13-4-2-焦点事件"><a href="#_13-4-2-焦点事件" class="header-anchor">#</a> 13.4.2 焦点事件</h4> <ul><li>blur 元素失去焦点时触发，这个事件不会冒泡</li> <li>focus 元素获得焦点时触发，这个事件不会冒泡</li> <li>focusin 元素获得焦点时触发，这个事件会冒泡</li> <li>focusout</li></ul> <h4 id="_13-4-3-鼠标与滚轮事件"><a href="#_13-4-3-鼠标与滚轮事件" class="header-anchor">#</a> 13.4.3 鼠标与滚轮事件</h4> <ul><li>click</li> <li>dbclick</li> <li>mousedown</li> <li>mouseenter</li> <li>mouseleave</li> <li>mousemove</li> <li>mouseout</li> <li>mouseover</li> <li>mouseup</li></ul> <p>鼠标事件的事件对象</p> <ul><li>客户区坐标位置，clientX, clientY，在视口中的位置</li> <li>页面坐标位置， pageX, pageY，页面本身包括滚动区域，pageX = clientX + document.documentElement.scrollLeft/document.body.scrollLeft</li> <li>屏幕坐标位置，相对于整个电脑屏幕的位置，screenX, screenY</li> <li>修改键？</li> <li>相关元素？</li> <li>鼠标按钮</li> <li>更多的事件信息</li></ul> <h4 id="_13-4-4-键盘与文本事件"><a href="#_13-4-4-键盘与文本事件" class="header-anchor">#</a> 13.4.4 键盘与文本事件</h4> <ul><li>keydown 用户按键盘任意键触发，按住不发会重复触发</li> <li>keypress 用户按键盘字符键触发，按住不放会重复触发</li> <li>keyup 用户释放键盘上的键触发</li></ul> <p>键码，keydown,keyup事件发生时，event对象keyCode属性会包含一个代码，与键盘上一个特定的键对应</p> <h6 id="textinput事件"><a href="#textinput事件" class="header-anchor">#</a> textInput事件</h6> <p>event对象有一个inputMethod属性，1表示键盘输入，2表示粘贴的，手写，语音...</p> <h4 id="_13-4-5-复合事件-composition-event"><a href="#_13-4-5-复合事件-composition-event" class="header-anchor">#</a> 13.4.5 复合事件(composition event)</h4> <h4 id="_13-4-6-变动事件"><a href="#_13-4-6-变动事件" class="header-anchor">#</a> 13.4.6 变动事件</h4> <h4 id="_13-4-7-html5事件"><a href="#_13-4-7-html5事件" class="header-anchor">#</a> 13.4.7 HTML5事件</h4> <ul><li>...hashchange</li></ul> <h4 id="_13-4-8-设备事件"><a href="#_13-4-8-设备事件" class="header-anchor">#</a> 13.4.8 设备事件</h4> <p>监听设备方向变化与移动</p> <h4 id="_13-4-9-触摸与手势事件"><a href="#_13-4-9-触摸与手势事件" class="header-anchor">#</a> 13.4.9 触摸与手势事件</h4> <h5 id="_1-触摸事件"><a href="#_1-触摸事件" class="header-anchor">#</a> 1.触摸事件</h5> <ul><li>touchstart, touchmove, touchend, touchcancel</li> <li>触摸事件也有event对象</li></ul> <h5 id="_2-手势事件"><a href="#_2-手势事件" class="header-anchor">#</a> 2.手势事件</h5> <h3 id="_13-5-内存和性能"><a href="#_13-5-内存和性能" class="header-anchor">#</a> 13.5 内存和性能</h3> <p>添加过多事件处理程序会影响页面的整体运行性能，导致这一问题的原因是多方面的，首先，每个函数都是对象，都会占用内存，内存中对象越多，性能就越差，其次，必须事先指定所有事件处理程序而导致的DOM访问次数，会延迟整个页面的交互就绪时间，从如何利用好事件处理程序的角度来说，还是有一些方法可以提高性能的</p> <h4 id="_13-5-1-事件委托"><a href="#_13-5-1-事件委托" class="header-anchor">#</a> 13.5.1 事件委托</h4> <p>事件委托利用事件冒泡原理，将事件处理程序添加到最外面的元素</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>ul id<span class="token operator">=</span><span class="token string">&quot;myList&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>li id<span class="token operator">=</span><span class="token string">&quot;something&quot;</span><span class="token operator">&gt;</span>Go somewhere<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>li id<span class="token operator">=</span><span class="token string">&quot;somewhere&quot;</span><span class="token operator">&gt;</span>Do something<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>li id<span class="token operator">=</span><span class="token string">&quot;sayHi&quot;</span><span class="token operator">&gt;</span>Say Hi<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
<span class="token keyword">var</span> list <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;myList&quot;</span><span class="token punctuation">)</span>
list<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> target <span class="token operator">=</span> event<span class="token punctuation">.</span>target  <span class="token comment">// target 捕获到触发事件的最小元素</span>
  <span class="token keyword">switch</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">&quot;something&quot;</span><span class="token operator">:</span>
      document<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">&quot;change the document title&quot;</span>
      <span class="token keyword">break</span>
    <span class="token keyword">case</span> <span class="token string">&quot;somewhere&quot;</span><span class="token operator">:</span>
      location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">&quot;xblcity.com&quot;</span>
      <span class="token keyword">break</span>
    <span class="token keyword">case</span> <span class="token string">&quot;sayHi&quot;</span><span class="token operator">:</span>
      <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;hi&quot;</span><span class="token punctuation">)</span>
      <span class="token keyword">break</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>由于事件会冒泡，最终都会由这个函数处理</p> <h4 id="_13-5-2-移除事件处理程序"><a href="#_13-5-2-移除事件处理程序" class="header-anchor">#</a> 13.5.2 移除事件处理程序</h4> <p>当你知道某个元素即将被移除，最好手动移除事件处理程序</p> <h3 id="_13-6-模拟事件"><a href="#_13-6-模拟事件" class="header-anchor">#</a> 13.6 模拟事件</h3> <h4 id="_13-6-1-dom中的事件模拟"><a href="#_13-6-1-dom中的事件模拟" class="header-anchor">#</a> 13.6.1 DOM中的事件模拟</h4> <h4 id="_13-6-2-ie中的事件模拟"><a href="#_13-6-2-ie中的事件模拟" class="header-anchor">#</a> 13.6.2 IE中的事件模拟</h4> <h3 id="_13-7-小结"><a href="#_13-7-小结" class="header-anchor">#</a> 13.7 小结</h3> <h2 id="第14章-表单脚本"><a href="#第14章-表单脚本" class="header-anchor">#</a> 第14章 表单脚本</h2> <h3 id="_14-1-表单的基本知识"><a href="#_14-1-表单的基本知识" class="header-anchor">#</a> 14.1 表单的基本知识</h3> <p>在HTML中，表单是由<code>&lt;form&gt;</code>元素来表示的，而在javascript中，表单对应的是HTMLFormElement类型，HTMLFormElement继承了HTMLElement，因而与其他HTML元素有相同的默认属性，但是,HTMLFormElement也有自己独有的方法和属性</p> <table><thead><tr><th>属性/方法</th> <th>说明</th></tr></thead> <tbody><tr><td>action</td> <td>接收请求的URL</td></tr> <tr><td>method</td> <td>要发送的HTTP请求类型，通常是get或者post</td></tr> <tr><td>name</td> <td>表单的名称</td></tr> <tr><td>submit()</td> <td>提交表单</td></tr> <tr><td>reset()</td> <td>将所有表单域重置为默认值</td></tr></tbody></table> <h4 id="_14-1-1-提交表单"><a href="#_14-1-1-提交表单" class="header-anchor">#</a> 14.1.1 提交表单</h4> <p>使用input或者button都可以定义提交按钮，只要把type设置为submit即可</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;submit&quot;</span> value<span class="token operator">=</span><span class="token string">&quot;Submit Form&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>button type<span class="token operator">=</span><span class="token string">&quot;submit&quot;</span><span class="token operator">&gt;</span>Submit Form<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
<span class="token comment">// 图像按钮</span>
<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;image&quot;</span> src<span class="token operator">=</span><span class="token string">&quot;button.gif&quot;</span><span class="token operator">&gt;</span>
</code></pre></div><p>校验表单数据，并阻止默认行为</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> form <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;myForm&quot;</span><span class="token punctuation">)</span>
form<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'submit'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 阻止默认事件</span>
  e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 或者</span>
form<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 不会触发submit事件，</span>
</code></pre></div><h4 id="_14-1-2-重置表单"><a href="#_14-1-2-重置表单" class="header-anchor">#</a> 14.1.2 重置表单</h4> <p>表单控件type时reset或者添加reset事件或者给formElement调用reset()方法</p> <h4 id="_14-1-3-表单字段"><a href="#_14-1-3-表单字段" class="header-anchor">#</a> 14.1.3 表单字段</h4> <h6 id="_1-共有的表单字段属性"><a href="#_1-共有的表单字段属性" class="header-anchor">#</a> 1.共有的表单字段属性</h6> <table><thead><tr><th>属性</th> <th>作用</th></tr></thead> <tbody><tr><td>disabled</td> <td>布尔值，当前字段是否被禁用</td></tr> <tr><td>name</td> <td>当前字段的属性</td></tr> <tr><td>type</td> <td>当前字段的类型</td></tr> <tr><td>value</td> <td>当前字段被提交给服务器的值，对文件字段来说，这个属性是只读的，包含着文件在计算机中的路径</td></tr></tbody></table> <p>也可以通过js动态修改属性值</p> <div class="language-js extra-class"><pre class="language-js"><code>input<span class="token punctuation">.</span>disabled <span class="token operator">=</span> <span class="token boolean">true</span>
</code></pre></div><h6 id="_2-共有的表单字段方法"><a href="#_2-共有的表单字段方法" class="header-anchor">#</a> 2.共有的表单字段方法</h6> <p>focus()和blur()<br>
focus方法用于将浏览器的焦点设置到表单字段，即激活表单字段，使其可以响应键盘事件<br>
在页面加载完毕后，将焦点转移到表单的第一个字段，为此，可以监听表单的load事件，并在该事件发生时在表单的第一个字段调用focus方法</p> <div class="language-js extra-class"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'load'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  inputElement<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>HTML5增加了autofocus属性(布尔值)，设置该属性，不用js就可以自动把焦点移动到相应字段</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">autofocus</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>blur()使表单元素失去焦点</p> <h6 id="_2-共有的表单字段方法-2"><a href="#_2-共有的表单字段方法-2" class="header-anchor">#</a> 2.共有的表单字段方法</h6> <p>blur,change,focus，change对于<code>&lt;input/&gt;</code>和<code>&lt;textarea/&gt;</code>元素，在他们失去焦点且value值改变时触发，对于<code>&lt;select/&gt;</code>元素，在其选项改变时触发<br>
focus和blur事件以某种方式改变用户界面，如文本框显示一个下拉选项菜单，或者在focus或者blur的时候改变它的样式<br>
change用于验证表单</p> <h3 id="_14-2-文本框脚本"><a href="#_14-2-文本框脚本" class="header-anchor">#</a> 14.2 文本框脚本</h3> <p><code>&lt;input/&gt;</code>以及<code>&lt;textarea/&gt;</code></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>25<span class="token punctuation">&quot;</span></span> <span class="token attr-name">maxlength</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>50<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>initial value<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>size表示能显示的最大字符数，maxlength表示能输入的最大字符数，value用于设置文本框的初始值<br> <code>&lt;textarea/&gt;</code>可以使用rows和cols属性，初始值必须要放在<code>&lt;textarea&gt;init value&lt;/textarea&gt;</code>闭合标签内</p> <h4 id="_14-2-1-选择文本"><a href="#_14-2-1-选择文本" class="header-anchor">#</a> 14.2.1 选择文本</h4> <p>select()，在文本框获得焦点时选择其所有文本</p> <h6 id="_1-select事件"><a href="#_1-select事件" class="header-anchor">#</a> 1.select事件</h6> <h6 id="_2-取得选择的文本"><a href="#_2-取得选择的文本" class="header-anchor">#</a> 2.取得选择的文本</h6> <p>两个属性selectionStart，selectionEnd</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">getSelectedText</span><span class="token punctuation">(</span><span class="token parameter">textbox</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> textbox<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>textbox<span class="token punctuation">.</span>selectionStart<span class="token punctuation">,</span> textbox<span class="token punctuation">.</span>selectionEnd<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_14-2-2-过滤输入"><a href="#_14-2-2-过滤输入" class="header-anchor">#</a> 14.2.2 过滤输入</h4> <h6 id="_1-屏蔽字符"><a href="#_1-屏蔽字符" class="header-anchor">#</a> 1.屏蔽字符</h6> <div class="language-js extra-class"><pre class="language-js"><code>textbox<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'keypress'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\d</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// 如果测试失败，屏蔽默认提交事件</span>
    event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h6 id="_1-操作粘贴板"><a href="#_1-操作粘贴板" class="header-anchor">#</a> 1.操作粘贴板</h6> <table><thead><tr><th>剪贴板事件</th> <th>作用</th></tr></thead> <tbody><tr><td>beforecopy</td> <td>复制操作前触发</td></tr> <tr><td>copy</td> <td>发生复制时触发</td></tr> <tr><td>beforecut</td> <td>发生剪切操作前触发</td></tr> <tr><td>cut</td> <td></td></tr> <tr><td>beforepaste</td> <td></td></tr> <tr><td>paste</td> <td></td></tr></tbody></table> <h4 id="_14-2-3-自动切换焦点"><a href="#_14-2-3-自动切换焦点" class="header-anchor">#</a> 14.2.3 自动切换焦点</h4> <p>在用户填写完当前字段，自动将焦点切换到下一字段<br>
监听input的length值，达到某一临界点则将下一个input元素focus</p> <h4 id="_14-2-4-html5约束验证api"><a href="#_14-2-4-html5约束验证api" class="header-anchor">#</a> 14.2.4 HTML5约束验证API</h4> <h6 id="_1-必填字段"><a href="#_1-必填字段" class="header-anchor">#</a> 1.必填字段</h6> <p>required</p> <h6 id="_2-其他输入类型"><a href="#_2-其他输入类型" class="header-anchor">#</a> 2.其他输入类型</h6> <p>type = email/url</p> <h6 id="_3-数值范围"><a href="#_3-数值范围" class="header-anchor">#</a> 3.数值范围</h6> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>number<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">min</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">max</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span> <span class="token attr-name">step</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>5<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>count<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>数值范围0-100，每次加减5，也可以用js限制</p> <div class="language-js extra-class"><pre class="language-js"><code>input<span class="token punctuation">.</span><span class="token function">stepUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
input<span class="token punctuation">.</span><span class="token function">stepUp</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
input<span class="token punctuation">.</span><span class="token function">stepDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
input<span class="token punctuation">.</span><span class="token function">stepDown</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
</code></pre></div><h6 id="_4-输入模式"><a href="#_4-输入模式" class="header-anchor">#</a> 4.输入模式</h6> <p>pattern属性，这个属性是一个正则表达式，用于匹配文本框中的值<br>
例如，如果只想允许在文本字段中输入数值</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> pattern<span class="token operator">=</span><span class="token string">&quot;\d+&quot;</span> name<span class="token operator">=</span><span class="token string">&quot;count&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre></div><h6 id="_5-检测有效性"><a href="#_5-检测有效性" class="header-anchor">#</a> 5.检测有效性</h6> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>value<span class="token punctuation">.</span><span class="token function">checkValidity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 字段有效，继续</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token comment">// 字段无效</span>
<span class="token punctuation">}</span>
</code></pre></div><p>checkValidity()方法可以简单的告诉你字段是否有效，validity属性会告诉为什么有效或无效，这个对象包含一系列属性，每个属性返回一个布尔值，如<br>
valid,rangeOverflow,tooLong 等等</p> <h6 id="_6-禁用验证"><a href="#_6-禁用验证" class="header-anchor">#</a> 6.禁用验证</h6> <p>novalidate属性</p> <h3 id="_14-3-选择框脚本"><a href="#_14-3-选择框脚本" class="header-anchor">#</a> 14.3 选择框脚本</h3> <p><code>&lt;select/&gt;</code>与<code>&lt;option/&gt;</code><br>
HTMLSelectElement还提供了下面属性和方法<br>
multiple，selectedIndex, size, options(是一个包含子元素的数组), add(newOption, relOption)<br>
HTMLOptionElement还有下面属性和方法
index, label, selected(布尔值,true表示被选中), value, text(选项的文本)</p> <h4 id="_14-3-1-选择选项"><a href="#_14-3-1-选择选项" class="header-anchor">#</a> 14.3.1 选择选项</h4> <p>selected属性</p> <h4 id="_14-3-2-添加选项"><a href="#_14-3-2-添加选项" class="header-anchor">#</a> 14.3.2 添加选项</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> newOption <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;option&quot;</span><span class="token punctuation">)</span>
newOption<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">createTextNode</span><span class="token punctuation">(</span><span class="token string">&quot;Option Text&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
newOption<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Option Value&quot;</span><span class="token punctuation">)</span>

selectbox<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>newOption<span class="token punctuation">)</span>
</code></pre></div><h4 id="_14-3-3-移动和重排选项"><a href="#_14-3-3-移动和重排选项" class="header-anchor">#</a> 14.3.3 移动和重排选项</h4> <h3 id="_14-4-表单序列化"><a href="#_14-4-表单序列化" class="header-anchor">#</a> 14.4 表单序列化</h3> <p>表单提交期间，浏览器是怎样将数据发送给浏览器的</p> <ul><li>对表单的名称和值进行URL编码，使用和号(&amp;)分割</li> <li>不发送禁用的表单字段</li> <li>只发送勾选的复选框和单选按钮</li> <li>不发送type为reset的button按钮</li> <li>多选选择框中的每个选中的值单独一个条目</li> <li>在单击提交按钮提交表单情况下，也会发送提交按钮，否则，不发送提交按钮</li> <li>select元素的值，就是选中的option的value特性的值</li></ul> <h3 id="_14-5-富文本编辑"><a href="#_14-5-富文本编辑" class="header-anchor">#</a> 14.5 富文本编辑</h3> <p>在页面内嵌入一个包含空HTML页面的iframe<br>
designMode设置为on，整个文档就变得可编辑</p> <h4 id="_14-5-1-使用contenteditable属性"><a href="#_14-5-1-使用contenteditable属性" class="header-anchor">#</a> 14.5.1 使用contenteditable属性</h4> <h4 id="_14-5-2-操作富文本"><a href="#_14-5-2-操作富文本" class="header-anchor">#</a> 14.5.2 操作富文本</h4> <h4 id="_14-5-3-富文本选区"><a href="#_14-5-3-富文本选区" class="header-anchor">#</a> 14.5.3 富文本选区</h4> <p>getSelection方法,document.getSelection()返回一个对象</p> <h4 id="_14-5-3-表单与富文本"><a href="#_14-5-3-表单与富文本" class="header-anchor">#</a> 14.5.3 表单与富文本</h4> <h3 id="_14-6-小结"><a href="#_14-6-小结" class="header-anchor">#</a> 14.6 小结</h3> <h2 id="第15章-使用canvas绘图"><a href="#第15章-使用canvas绘图" class="header-anchor">#</a> 第15章 使用Canvas绘图</h2> <h3 id="_15-1-基本用法"><a href="#_15-1-基本用法" class="header-anchor">#</a> 15.1 基本用法</h3> <p>先设置width与height属性值，单位px，然后获取绘图上下文(调用getContext()并传入上下文的名字)</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>canvas id<span class="token operator">=</span><span class="token string">&quot;drawing&quot;</span> width<span class="token operator">=</span><span class="token string">&quot;200&quot;</span> height<span class="token operator">=</span><span class="token string">&quot;200&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>canvas<span class="token operator">&gt;</span>
<span class="token keyword">var</span> drawing <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;drawing&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> context <span class="token operator">=</span> drawing<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&quot;2d&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_15-2-2d上下文"><a href="#_15-2-2d上下文" class="header-anchor">#</a> 15.2 2D上下文</h3> <h4 id="_15-2-1-填充和描边"><a href="#_15-2-1-填充和描边" class="header-anchor">#</a> 15.2.1 填充和描边</h4> <p>填充，就是用指定的样式(颜色，渐变或图像)填充图形，描边，就是只在图形的边缘描线<br>
设置fillStyle以及strokeStyle</p> <h4 id="_15-2-2-绘制矩形"><a href="#_15-2-2-绘制矩形" class="header-anchor">#</a> 15.2.2 绘制矩形</h4> <p>矩形是唯一一种可以直接在2D上下文中绘制的图形，方法包括<code>fillRect()``strokeRect()``clearRect()</code>，这三个方法都能接收四个参数，矩形的x坐标，y坐标，宽度，高度。单位都是像素</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> drawing <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;drawing&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> context <span class="token operator">=</span> drawing<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&quot;2d&quot;</span><span class="token punctuation">)</span>
<span class="token comment">// 绘制红色矩形, 注意，fillStyle要在fillRect前面，否则不生效，canvas默认颜色是黑色</span>
context<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">&quot;#ff0000&quot;</span>
context<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span>
<span class="token comment">// 绘制半透明蓝色矩形,两个矩形会有重叠</span>
context<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">&quot;rgba(0,0,255,0.5)&quot;</span>
context<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span>
<span class="token comment">// 清除一部分矩形</span>
context<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token comment">// 绘制线矩形边</span>
context<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">&quot;#ddd&quot;</span>
context<span class="token punctuation">.</span><span class="token function">strokeRect</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="_15-2-3-绘制路径"><a href="#_15-2-3-绘制路径" class="header-anchor">#</a> 15.2.3 绘制路径</h4> <p>通过路径可以创建复杂的形状和线条，要绘制路径，首先要调用beginPath()方法，然后再调用下列方法实际的绘制路径</p> <table><thead><tr><th>方法</th> <th>作用</th></tr></thead> <tbody><tr><td>arc(x,y,radius,startAngle,endAngle,counterclockwise)</td> <td>以(x,y)为圆心绘制弧线，半径为radius，设置起始终止角，最后一个是否按逆时针计算，false表示顺时针</td></tr> <tr><td>arcTo(x1,y1,x2,y2,radius)</td> <td>从上一点开始绘制一条弧线，到(x2,y2)为止，并且以给定的半径radius穿过(x1,y1)</td></tr> <tr><td>bezierCurveTo(clx,cly,c2x,c2y,x,y)</td> <td>从上一点开始绘制一条曲线，到(x,y)为止，并且(c1x,c1y)和(c2x,c2y)为控制点</td></tr> <tr><td>lineTo(x,y)</td> <td>从上一点绘制一条直线，到(x,y)为止</td></tr> <tr><td>moveTo(x,y)</td> <td>将绘图游标移动到(x,y)，不画线</td></tr> <tr><td>quadraticCurveTo(cx,cy,x,y)</td> <td>从上一点绘制一条二次曲线，到(x,y)为止，并且以(cx,cy)为控制点</td></tr> <tr><td>rect(x,y,width,height)</td> <td>从点(x,y)开始绘制一个矩形，这个方法绘制的是矩形路径，而不是strokeRect()和fillRect()所绘制的独立的形状</td></tr> <tr><td>fill()</td> <td></td></tr> <tr><td>fillStyle</td> <td></td></tr> <tr><td>stroke()</td> <td></td></tr> <tr><td>strokeStyle</td> <td></td></tr></tbody></table> <p>创建路径之后，接下来有几种可能的选择，如果想绘制一条连接到路径起点的线条，可以调用closePath()，如果路径已经完成，你想用fillStyle()填充它，可以调用fill()方法。另外，还可以调用stroke()方法对路径进行描边，描边使用的是strokeStyle。最后还可以调用clip()，这个方法可以在路径上创建一个剪切区域。</p> <p>closePath()会创建一个起始点到终点的线</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> drawing <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;drawing&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> context <span class="token operator">=</span> drawing<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&quot;2d&quot;</span><span class="token punctuation">)</span>
<span class="token comment">// 开始路径</span>
context<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 绘制外圆</span>
context<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token comment">// 绘制内圆</span>
context<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">194</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
context<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">94</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">*</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token comment">// 绘制分针</span>
context<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
context<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span>
<span class="token comment">// 绘制时针</span>
context<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
context<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token comment">// 描边路径</span>
context<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>绘制一个简单的Q</p> <div class="language-js extra-class"><pre class="language-js"><code>context<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
context<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
context<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">&quot;#cdf&quot;</span>
context<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
context<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">)</span>
context<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span>
context<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">10</span>
context<span class="token punctuation">.</span>lineCap <span class="token operator">=</span> <span class="token string">&quot;round&quot;</span>
context<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">&quot;#cee&quot;</span>
context<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="_15-2-4-绘制文本"><a href="#_15-2-4-绘制文本" class="header-anchor">#</a> 15.2.4 绘制文本</h4> <p>绘制文本主要有两个方法 <code>fillText()</code>和<code>strokeText()</code>,两个方法都接收四个参数: 要绘制的文本字符串，x坐标, y坐标, 可选的最大像素宽度，这两个方法都以下列三个属性为基础：font,textAlign,textBaseline，他们都有默认初始值</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 在上面代码基础上</span>
context<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token string">&quot;bold 14px Arial&quot;</span>
context<span class="token punctuation">.</span>textAlign <span class="token operator">=</span> <span class="token string">&quot;center&quot;</span> <span class="token comment">// 中间对齐</span>
context<span class="token punctuation">.</span>textBaseline <span class="token operator">=</span> <span class="token string">&quot;middle&quot;</span> <span class="token comment">// 中间对齐</span>
context<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span><span class="token string">&quot;12&quot;</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="_15-2-5-变换"><a href="#_15-2-5-变换" class="header-anchor">#</a> 15.2.5 变换</h4> <p>通过如下方法改变矩阵: rotate(angle), scale(scaleX, scaleY), translate(x,y), transform(...)</p> <h4 id="_15-2-6-绘制图像"><a href="#_15-2-6-绘制图像" class="header-anchor">#</a> 15.2.6 绘制图像</h4> <p>drawImage(), 传入一个HTML图片元素，并传入图像起点的x,y坐标</p> <h4 id="_15-2-7-阴影"><a href="#_15-2-7-阴影" class="header-anchor">#</a> 15.2.7 阴影</h4> <p>shadowColor shadowOffsetX shadowOffsetY shadowBlur</p> <h4 id="_15-2-8-渐变"><a href="#_15-2-8-渐变" class="header-anchor">#</a> 15.2.8 渐变</h4> <p>创建渐变对象，gradient, <code>context.createLinearGradient()</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> drawing <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;drawing&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> context <span class="token operator">=</span> drawing<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&quot;2d&quot;</span><span class="token punctuation">)</span>
<span class="token comment">// 渐变</span>
<span class="token keyword">var</span> gradient <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">createLinearGradient</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span> <span class="token comment">// 起始坐标与终点坐标</span>
gradient<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&quot;white&quot;</span><span class="token punctuation">)</span>
gradient<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;black&quot;</span><span class="token punctuation">)</span>
<span class="token comment">// 绘制渐变色矩形</span>
context<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> gradient
context<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="_15-2-9-模式"><a href="#_15-2-9-模式" class="header-anchor">#</a> 15.2.9 模式</h4> <p>重复的图像</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> pattern <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">createPattern</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> <span class="token string">&quot;repeat&quot;</span><span class="token punctuation">)</span> 
<span class="token comment">// 绘制图形</span>
context<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> pattern
context<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">150</span><span class="token punctuation">,</span><span class="token number">150</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="_15-2-10-使用图像数据"><a href="#_15-2-10-使用图像数据" class="header-anchor">#</a> 15.2.10 使用图像数据</h4> <p>通过getImageData()获得原始图像数据，接收四个参数</p> <h4 id="_15-2-11-合成"><a href="#_15-2-11-合成" class="header-anchor">#</a> 15.2.11 合成</h4> <p>globalAlpha和globalCompositionOperation,前者用于设置透明度</p> <h3 id="_15-3-webgl"><a href="#_15-3-webgl" class="header-anchor">#</a> 15.3 WebGL</h3> <p>WebGL是针对canvas的3d上下文</p> <h4 id="_15-3-1-类型化数组"><a href="#_15-3-1-类型化数组" class="header-anchor">#</a> 15.3.1 类型化数组</h4> <p>WebGL涉及的复杂计算需要提前知道数值的精度，而标准的javascript无法满足需求，为此，WebGL引入了一个概念，叫做类型化数组(typed arrays)<br>
类型化数组的核心就是一个叫ArrayBuffer的类型</p> <h4 id="_15-3-2-webgl上下文"><a href="#_15-3-2-webgl上下文" class="header-anchor">#</a> 15.3.2 WebGL上下文</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>canvas id<span class="token operator">=</span><span class="token string">&quot;drawing&quot;</span> width<span class="token operator">=</span><span class="token string">&quot;200&quot;</span> height<span class="token operator">=</span><span class="token string">&quot;200&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>canvas<span class="token operator">&gt;</span>
<span class="token keyword">var</span> drawing <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;drawing&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> gl <span class="token operator">=</span> drawing<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="_15-3-3-支持"><a href="#_15-3-3-支持" class="header-anchor">#</a> 15.3.3 支持</h4> <p>浏览器 WebGL API, 计算机的显示驱动程序</p> <h3 id="_15-4-小结"><a href="#_15-4-小结" class="header-anchor">#</a> 15.4 小结</h3> <h2 id="第16章-html5脚本编程"><a href="#第16章-html5脚本编程" class="header-anchor">#</a> 第16章 HTML5脚本编程</h2> <h3 id="_16-1-跨文档消息传递"><a href="#_16-1-跨文档消息传递" class="header-anchor">#</a> 16.1 跨文档消息传递</h3> <p>cross-document messaging, 有时简称XDM,指的是不同域的页面间传递信息<br>
核心是postMessage()方法，接收两个参数，一条消息和一个表示接收方来自哪个域的字符串</p> <h3 id="_16-2-原生拖放"><a href="#_16-2-原生拖放" class="header-anchor">#</a> 16.2 原生拖放</h3> <h4 id="_16-2-1-拖放事件"><a href="#_16-2-1-拖放事件" class="header-anchor">#</a> 16.2.1 拖放事件</h4> <p>拖动某元素时，依次触发下列事件：dragstart, drag, dragend<br>
当某个元素被拖动到一个有效的防止目标时，下列事件会依次发生: dragenter, dragover, dragleave/drop</p> <h4 id="_16-2-2-自定义放置目标"><a href="#_16-2-2-自定义放置目标" class="header-anchor">#</a> 16.2.2 自定义放置目标</h4> <h4 id="_16-2-3-datatransfer对象"><a href="#_16-2-3-datatransfer对象" class="header-anchor">#</a> 16.2.3 dataTransfer对象</h4> <h4 id="_16-2-4-dropeffect与effectallowed"><a href="#_16-2-4-dropeffect与effectallowed" class="header-anchor">#</a> 16.2.4 dropEffect与effectAllowed</h4> <p>利用dataTransfer对象，不光能够传输数据，还能通过它来确定被拖动的元素以及作为放置目标的元素能够接收什么操作，为此，需要访问dataTransfer两个属性，dropEffect和effectAllowed</p> <h4 id="_16-2-5-可拖动"><a href="#_16-2-5-可拖动" class="header-anchor">#</a> 16.2.5 可拖动</h4> <p>默认情况下，图像，链接和文本是可以拖动的，文本只有在被选中的时候才可以拖动，而图像和链接在任何时候都可以拖动<br>
让其他元素可以拖动也是可能的，HTML5为所有元素规定了一个draggable属性，表示元素是否可以拖动，图像和链接自动被设置成了true</p> <h4 id="_16-2-6-其他成员"><a href="#_16-2-6-其他成员" class="header-anchor">#</a> 16.2.6 其他成员</h4> <p>HTML5规定dataTransfer对象还包含下面属性和方法...</p> <h3 id="_16-3-媒体元素"><a href="#_16-3-媒体元素" class="header-anchor">#</a> 16.3 媒体元素</h3> <p><code>&lt;audio&gt;与&lt;video/&gt;</code></p> <h4 id="_16-3-1-属性"><a href="#_16-3-1-属性" class="header-anchor">#</a> 16.3.1 属性</h4> <table><thead><tr><th>属性值</th> <th>作用</th></tr></thead> <tbody><tr><td>src</td> <td></td></tr> <tr><td>width</td> <td></td></tr> <tr><td>height</td> <td></td></tr> <tr><td>poster</td> <td>加载内容时显示一幅图像</td></tr> <tr><td>autoplay</td> <td></td></tr> <tr><td>controls</td> <td>是否显示控件</td></tr> <tr><td>readyState</td> <td>表示媒体是否就绪了</td></tr> <tr><td>...</td> <td>...</td></tr></tbody></table> <h4 id="_16-3-2-事件"><a href="#_16-3-2-事件" class="header-anchor">#</a> 16.3.2 事件</h4> <table><thead><tr><th>事件</th> <th>触发时机</th></tr></thead> <tbody><tr><td>canplay</td> <td>可以播放时，readyState是2</td></tr> <tr><td>play</td> <td>媒体接收指令开始播放</td></tr> <tr><td>playing</td> <td>媒体已实际开始播放</td></tr> <tr><td>...</td> <td>...</td></tr></tbody></table> <h4 id="_16-3-3-自定义媒体播放器"><a href="#_16-3-3-自定义媒体播放器" class="header-anchor">#</a> 16.3.3 自定义媒体播放器</h4> <p>play和pause方法可以手动控制媒体文件的播放</p> <h4 id="_16-3-4-检测编解码器的支持情况"><a href="#_16-3-4-检测编解码器的支持情况" class="header-anchor">#</a> 16.3.4 检测编解码器的支持情况</h4> <h4 id="_16-3-5-audio类型"><a href="#_16-3-5-audio类型" class="header-anchor">#</a> 16.3.5 Audio类型</h4> <p><code>&lt;audio/&gt;</code> 元素有一个原生的js构造函数Audio，可以在任何时候播放音频</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> audio <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Audio</span><span class="token punctuation">(</span><span class="token string">&quot;sound.mp3&quot;</span><span class="token punctuation">)</span>
audio<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;canplaythrough&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  audio<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="_16-4-历史状态管理"><a href="#_16-4-历史状态管理" class="header-anchor">#</a> 16.4 历史状态管理</h4> <p>用户的每一次操作不一定打开一个全新的页面，因此，前进后退也就失去了作用<br>
history.pushState会创建新的历史状态，触发window的popstate事件</p> <h3 id="_16-5-小结"><a href="#_16-5-小结" class="header-anchor">#</a> 16.5 小结</h3> <p>HTML5除了定义新的标记规则，还定义了一些js API, 这些api是为了让开发人员创建出更好的，能够与桌面应用媲美的用户界面而设计的</p> <ul><li>跨文档消息传递API能够让我们在不降低同源策略安全性的前提下，在来自不同域的文档间传递消息</li> <li>原生拖放功能让我们可以方便的指定某个元素可拖动，并在操作系统要放置时做出响应，还可以创建自定义的可拖动元素及放置目标</li> <li>新的媒体元素<code>audio</code>与<code>video</code>拥有自己的视频与音频交互的API</li> <li>历史状态管理让我们可以不必卸载当前页面即可修改浏览器的历史状态栈，有了这种机制，用户就可以通过“前进”，“后退”按钮在页面状态间切换，这些状态完全由js控制</li></ul> <h2 id="第17章-错误处理与调试"><a href="#第17章-错误处理与调试" class="header-anchor">#</a> 第17章 错误处理与调试</h2> <h3 id="_17-1-浏览器报告的错误"><a href="#_17-1-浏览器报告的错误" class="header-anchor">#</a> 17.1 浏览器报告的错误</h3> <h4 id="_17-1-1-ie"><a href="#_17-1-1-ie" class="header-anchor">#</a> 17.1.1 IE</h4> <h4 id="_17-1-2-firefox"><a href="#_17-1-2-firefox" class="header-anchor">#</a> 17.1.2 Firefox</h4> <h4 id="_17-1-3-safari"><a href="#_17-1-3-safari" class="header-anchor">#</a> 17.1.3 Safari</h4> <h4 id="_17-1-4-opera"><a href="#_17-1-4-opera" class="header-anchor">#</a> 17.1.4 Opera</h4> <h4 id="_17-1-5-chrome"><a href="#_17-1-5-chrome" class="header-anchor">#</a> 17.1.5 Chrome</h4> <h3 id="_17-2-错误处理"><a href="#_17-2-错误处理" class="header-anchor">#</a> 17.2 错误处理</h3> <h4 id="_17-2-1-try-catch语句"><a href="#_17-2-1-try-catch语句" class="header-anchor">#</a> 17.2.1 try-catch语句</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 与java相似</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token comment">// 可能会导致错误的代码</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 在错误发生时怎么处理</span>
<span class="token punctuation">}</span>
</code></pre></div><h6 id="_1-finally子句-即使出错-依然会执行"><a href="#_1-finally子句-即使出错-依然会执行" class="header-anchor">#</a> 1.finally子句，即使出错，依然会执行</h6> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">testFinally</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">2</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>catch<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">1</span>
  <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">0</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 最终会返回0</span>
</code></pre></div><h6 id="_2-错误类型"><a href="#_2-错误类型" class="header-anchor">#</a> 2. 错误类型</h6> <p>7种错误类型(构造函数)</p> <table><thead><tr><th>错误类型</th></tr></thead> <tbody><tr><td>Error</td></tr> <tr><td>EvalError</td></tr> <tr><td>RangeError</td></tr> <tr><td>ReferenceError</td></tr> <tr><td>SyntaxError</td></tr> <tr><td>TypeError</td></tr> <tr><td>URIError</td></tr></tbody></table> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token function">someFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>error <span class="token keyword">instanceof</span> <span class="token class-name">TypeError</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 处理类型错误</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>error <span class="token keyword">instanceof</span> <span class="token class-name">ReferenceError</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 处理引用错误</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// 处理其他类型的错误</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>包含在message的属性的错误会因浏览器而异</p> <h4 id="_17-2-2-抛出错误"><a href="#_17-2-2-抛出错误" class="header-anchor">#</a> 17.2.2 抛出错误</h4> <p>与try-catch语句相配的还有一个throw操作符，用于随时抛出自定义错误，这个值是什么类型，没有要求，下面代码都是有效的</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">throw</span> <span class="token number">123456</span>
<span class="token keyword">throw</span> <span class="token boolean">true</span>
</code></pre></div><p>在遇到throw操作符时，代码会立即停止执行。仅当有try-catch语句捕获到被抛出的值时，代码才会继续执行<br> <code>throw new Error('something wrong')</code>，这个代码抛出了一个通用错误，带有一条自定义错误消息，浏览器会像处理自己生成的错误一样，来处理这行代码抛出的错误</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">SyntaxError</span><span class="token punctuation">(</span><span class="token string">&quot;I don't like your syntax&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ReferenceError</span><span class="token punctuation">(</span><span class="token string">&quot;haha&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p>在创建自定义错误类型时，最常用的是Error, RangeError, ReferenceError, TypeError</p> <h6 id="_1-抛出错误的时机"><a href="#_1-抛出错误的时机" class="header-anchor">#</a> 1. 抛出错误的时机</h6> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">process</span><span class="token punctuation">(</span><span class="token parameter">values</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  values<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> values<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>values<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> values<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果给这个函数传递一个字符串参数，sort()调用就会失败，各个浏览器的报错信息可能不一样，这种情况下，带有适当信息的自定义错误能够显著提升代码的可维护性</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">process</span><span class="token punctuation">(</span><span class="token parameter">values</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>values <span class="token keyword">instanceof</span> <span class="token class-name">Array</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;process(): Argument must be an array&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  values<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> values<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>values<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> values<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果values不是数组，就会抛出错误</p> <h4 id="_17-2-3-错误-error-事件"><a href="#_17-2-3-错误-error-事件" class="header-anchor">#</a> 17.2.3 错误(error)事件</h4> <p>任何没有通过try-catch处理的错误都会触发window对象的error事件。onerror事件处理程序不会创建event对象，但它可以接收三个参数，错误消息，错误所在的URL和行号。多数情况下，只有错误信息有用</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 好像没用？</span>
window<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">message<span class="token punctuation">,</span> url<span class="token punctuation">,</span> line</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token boolean">false</span> <span class="token comment">// 阻止浏览器默认处理错误行为，相当于全局的try-catch</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_17-2-4-处理错误的策略"><a href="#_17-2-4-处理错误的策略" class="header-anchor">#</a> 17.2.4 处理错误的策略</h4> <h4 id="_17-2-5-常见的错误类型"><a href="#_17-2-5-常见的错误类型" class="header-anchor">#</a> 17.2.5 常见的错误类型</h4> <p>一般来说，需要关注三种错误：类型转换错误，数据类型错误，通信错误。</p> <h6 id="_1-类型转换错误"><a href="#_1-类型转换错误" class="header-anchor">#</a> 1.类型转换错误</h6> <p>在使用<code>==</code>以及<code>!=</code>以及<code>if()</code>会出现类型转换错误</p> <h6 id="_2-数据类型错误"><a href="#_2-数据类型错误" class="header-anchor">#</a> 2.数据类型错误</h6> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">getQueryString</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> pos <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&quot;?&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> url<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>pos <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token string">&quot;&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果传入其他数据就会导致错误，添加一个简单的类型检测语句，就可以确保函数不那么容易报错</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">getQueryString</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> url <span class="token operator">===</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> pos <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&quot;?&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>pos <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> url<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>pos <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token string">&quot;&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h6 id="_3-通信错误"><a href="#_3-通信错误" class="header-anchor">#</a> 3.通信错误</h6> <p>随着Ajax编程的兴起，Web应用程序在其声明周期内动态加载信息或功能，已经成为一件司空见惯的事，但是，js与服务器之间的任何一次通信，都有可能产生错误</p> <h4 id="_17-2-6-区分致命错误和非致命错误"><a href="#_17-2-6-区分致命错误和非致命错误" class="header-anchor">#</a> 17.2.6 区分致命错误和非致命错误</h4> <p>区分的主要依据是看它们对用户的影响</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> mods<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  mods<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 可能导致致命错误</span>
<span class="token punctuation">}</span>
</code></pre></div><p>对每个模块调用init方法，任何模块的init方法如果出错，都会导致后续模块无法初始化</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> mods<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    mods<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 在这里处理错误</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_17-2-7-把错误记录到服务器"><a href="#_17-2-7-把错误记录到服务器" class="header-anchor">#</a> 17.2.7 把错误记录到服务器</h4> <p>在<code>catch</code>的时候做相应的处理</p> <h3 id="_17-3-调试技术"><a href="#_17-3-调试技术" class="header-anchor">#</a> 17.3 调试技术</h3> <p>alert?!</p> <h4 id="_17-3-1-将消息记录到控制台"><a href="#_17-3-1-将消息记录到控制台" class="header-anchor">#</a> 17.3.1 将消息记录到控制台</h4> <p>通过console对象向JS控制台写入消息，这个对象具有下面方法<br>
error,info,log,warn,dir...</p> <h4 id="_17-3-2-将消息记录到当前页面"><a href="#_17-3-2-将消息记录到当前页面" class="header-anchor">#</a> 17.3.2 将消息记录到当前页面</h4> <h4 id="_17-3-3-抛出错误"><a href="#_17-3-3-抛出错误" class="header-anchor">#</a> 17.3.3 抛出错误</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">divide</span><span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> num1 <span class="token operator">!==</span> <span class="token string">'number'</span> <span class="token operator">||</span> <span class="token keyword">typeof</span> num2 <span class="token operator">!==</span> <span class="token string">'number'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;divide(): Both arguments must be numbers&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> num1<span class="token operator">/</span>num2
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_17-4-常见的ie错误"><a href="#_17-4-常见的ie错误" class="header-anchor">#</a> 17.4 常见的IE错误</h3> <h4 id="_17-4-1-操作终止"><a href="#_17-4-1-操作终止" class="header-anchor">#</a> 17.4.1 操作终止</h4> <h4 id="_17-4-2-无效字符"><a href="#_17-4-2-无效字符" class="header-anchor">#</a> 17.4.2 无效字符</h4> <h4 id="_17-4-3-未找到成员"><a href="#_17-4-3-未找到成员" class="header-anchor">#</a> 17.4.3 未找到成员</h4> <h4 id="_17-4-4-未知运行时错误"><a href="#_17-4-4-未知运行时错误" class="header-anchor">#</a> 17.4.4 未知运行时错误</h4> <h4 id="_17-4-5-语法错误"><a href="#_17-4-5-语法错误" class="header-anchor">#</a> 17.4.5 语法错误</h4> <h4 id="_17-4-6-系统无法找到指定资源"><a href="#_17-4-6-系统无法找到指定资源" class="header-anchor">#</a> 17.4.6 系统无法找到指定资源</h4> <h3 id="_17-5-小结"><a href="#_17-5-小结" class="header-anchor">#</a> 17.5 小结</h3> <p>避免浏览器响应js错误的方法</p> <ul><li>在可能发生错误的地方使用try-catch语句，这样你还有机会以适当的方式对错误进行响应，而不必沿用浏览器处理错误的机制<br>
分析错误来源，并指定错误处理的方案</li> <li>致命错误与非致命错误</li> <li>判断可能发生的错误</li></ul> <h2 id="第18章-javascript与xml"><a href="#第18章-javascript与xml" class="header-anchor">#</a> 第18章 JavaScript与XML</h2> <h3 id="_18-1-浏览器对xml-dom的支持"><a href="#_18-1-浏览器对xml-dom的支持" class="header-anchor">#</a> 18.1 浏览器对XML DOM的支持</h3> <h4 id="_18-1-1-dom2的核心"><a href="#_18-1-1-dom2的核心" class="header-anchor">#</a> 18.1.1 DOM2的核心?</h4> <h4 id="_18-1-2-domparser类型"><a href="#_18-1-2-domparser类型" class="header-anchor">#</a> 18.1.2 DOMParser类型</h4> <h4 id="_18-1-3-xmlserializer类型"><a href="#_18-1-3-xmlserializer类型" class="header-anchor">#</a> 18.1.3 XMLSerializer类型</h4> <h4 id="_18-1-4-ie8及之前版本的xml"><a href="#_18-1-4-ie8及之前版本的xml" class="header-anchor">#</a> 18.1.4 IE8及之前版本的XML</h4> <h4 id="_18-1-5-跨浏览器处理xml"><a href="#_18-1-5-跨浏览器处理xml" class="header-anchor">#</a> 18.1.5 跨浏览器处理XML</h4> <h3 id="_18-2-浏览器对xpath的支持"><a href="#_18-2-浏览器对xpath的支持" class="header-anchor">#</a> 18.2 浏览器对Xpath的支持</h3> <h4 id="_18-2-1-dom3级xpath"><a href="#_18-2-1-dom3级xpath" class="header-anchor">#</a> 18.2.1 DOM3级Xpath</h4> <h4 id="_18-2-2-ie中的xpath"><a href="#_18-2-2-ie中的xpath" class="header-anchor">#</a> 18.2.2 IE中的Xpath</h4> <h4 id="_18-2-3-跨浏览器使用xpath"><a href="#_18-2-3-跨浏览器使用xpath" class="header-anchor">#</a> 18.2.3 跨浏览器使用Xpath</h4> <h3 id="_18-3-浏览器对xslt的支持"><a href="#_18-3-浏览器对xslt的支持" class="header-anchor">#</a> 18.3 浏览器对XSLT的支持</h3> <h4 id="_18-3-1-ie中的xslt"><a href="#_18-3-1-ie中的xslt" class="header-anchor">#</a> 18.3.1 IE中的XSLT</h4> <h4 id="_18-3-2-xsltprocessor类型"><a href="#_18-3-2-xsltprocessor类型" class="header-anchor">#</a> 18.3.2 XSLTProcessor类型</h4> <h4 id="_18-3-3-跨浏览器使用xslt"><a href="#_18-3-3-跨浏览器使用xslt" class="header-anchor">#</a> 18.3.3 跨浏览器使用XSLT</h4> <h3 id="_18-3-小结"><a href="#_18-3-小结" class="header-anchor">#</a> 18.3 小结</h3> <h2 id="第19章-e4x"><a href="#第19章-e4x" class="header-anchor">#</a> 第19章 E4X</h2> <p>E4X目的是为操作XML数据提供与标准ECMAScript更相近的语法</p> <h2 id="第20章-json"><a href="#第20章-json" class="header-anchor">#</a> 第20章 JSON</h2> <p>JSON是一种数据格式，不是一种编程语言</p> <h3 id="_20-1-语法"><a href="#_20-1-语法" class="header-anchor">#</a> 20.1 语法</h3> <p>JSON语法可以标识下面三种类型的值：简单值，对象，数组</p> <h4 id="_20-1-1-简单值"><a href="#_20-1-1-简单值" class="header-anchor">#</a> 20.1.1 简单值</h4> <p>字符串必须使用双引号，简单值也可以是数值，布尔值，null</p> <h4 id="_20-1-2-对象"><a href="#_20-1-2-对象" class="header-anchor">#</a> 20.1.2 对象</h4> <p>属性要加双引号</p> <h4 id="_20-1-3-数组"><a href="#_20-1-3-数组" class="header-anchor">#</a> 20.1.3 数组</h4> <p>采用js数组的字面量形式</p> <h3 id="_20-2-解析与序列化"><a href="#_20-2-解析与序列化" class="header-anchor">#</a> 20.2 解析与序列化</h3> <h4 id="_20-2-1-json对象"><a href="#_20-2-1-json对象" class="header-anchor">#</a> 20.2.1 JSON对象</h4> <p>早期使用js的eval函数，但是会有风险<br>
JSON对象有两个方法， <code>stringify()</code>和<code>parse()</code></p> <h4 id="_20-2-2-序列化选项"><a href="#_20-2-2-序列化选项" class="header-anchor">#</a> 20.2.2 序列化选项</h4> <p>第二个参数是一个数组或函数</p> <h4 id="_20-2-3-解析选项"><a href="#_20-2-3-解析选项" class="header-anchor">#</a> 20.2.3 解析选项</h4> <p>也可以传第二个参数函数，在解析Date函数时可能会用到</p> <h3 id="_20-3-小结"><a href="#_20-3-小结" class="header-anchor">#</a> 20.3 小结</h3> <h2 id="第21章-ajax与comet"><a href="#第21章-ajax与comet" class="header-anchor">#</a> 第21章 Ajax与Comet</h2> <p>Asynchronous JavaScript + XML 的简写</p> <p>Ajax技术的核心是XMLHttpRequest对象，简称XHR</p> <h3 id="_21-1-xmlhttprequest对象"><a href="#_21-1-xmlhttprequest对象" class="header-anchor">#</a> 21.1 XMLHttpRequest对象</h3> <h4 id="_21-1-1-xhr的用法"><a href="#_21-1-1-xhr的用法" class="header-anchor">#</a> 21.1.1 XHR的用法</h4> <p>使用XHR对象时，要调用的第一个方法是open()，接收三个参数，请求类型(如'get','post')，请求的URL路径，是否异步(默认true)</p> <p><code>xhr.open('get', 'cc.com/cc')</code>,这行代码会启动一个针对cc.com/cc的GET请求，调用open方法并不会真正发送请求，而只是启动一个请求以备发送</p> <p>要发送请求，必须要使用<code>send()</code>方法，接收一个参数，即要发送的数据,没有数据则传null</p> <p>在收到响应后，响应数据会自动填充XHR对象的属性，相关属性如下</p> <table><thead><tr><th>属性</th> <th>说明</th></tr></thead> <tbody><tr><td>responseText</td> <td>返回的文本</td></tr> <tr><td>status</td> <td>响应的HTTP状态</td></tr></tbody></table> <p>发送异步请求时，可以检测XHR的readyState属性，该属性表示请求/响应过程的当前活动阶段</p> <table><thead><tr><th>值</th> <th>说明</th></tr></thead> <tbody><tr><td>0</td> <td>未初始化</td></tr> <tr><td>1</td> <td>启动，已调用open()方法，但尚未调用send()方法</td></tr> <tr><td>2</td> <td>发送，已调用send()方法，但尚未收到响应</td></tr> <tr><td>3</td> <td>接收，已收到部分响应数据</td></tr> <tr><td>4</td> <td>完成。已经接收到全部响应数据，而且已经可以在客户端使用了</td></tr></tbody></table> <p>只要readyState属性的值由一个值变成另一个值，就会触发一次readystatechange事件，可以用这个事件来检测每次状态变化之后的readyState的值，通常我们只对readyState为4的值感兴趣</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>state <span class="token operator">&gt;=</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> xhr<span class="token punctuation">.</span>state <span class="token operator">&lt;</span> <span class="token number">300</span> <span class="token operator">||</span> xhr<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token number">304</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">alert</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>responseText<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'request was unsuccessful'</span> <span class="token operator">+</span> xhr<span class="token punctuation">.</span>status<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'get'</span><span class="token punctuation">,</span> <span class="token string">'cc.com'</span><span class="token punctuation">)</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="_21-1-2-http头部信息"><a href="#_21-1-2-http头部信息" class="header-anchor">#</a> 21.1.2 HTTP头部信息</h4> <table><thead><tr><th>值</th> <th>说明</th></tr></thead> <tbody><tr><td>Accept</td> <td>浏览器能够处理的内容类型</td></tr> <tr><td>Accept-Charset</td> <td></td></tr> <tr><td>Accept-Encoding</td> <td></td></tr> <tr><td>Accept-Language</td> <td></td></tr> <tr><td>Connection</td> <td>浏览器与服务器之间的连接类型</td></tr> <tr><td>Cookie</td> <td>当前页面设置的任何cookie</td></tr> <tr><td>Host</td> <td>发出请求的页面所在的域</td></tr> <tr><td>Referer</td> <td></td></tr> <tr><td>User-Agent</td> <td>浏览器的用户代理字符串</td></tr></tbody></table> <p>在调用<code>open</code>之后<code>send</code>之前调用<code>setRequestHeader</code></p> <h4 id="_21-1-3-get请求"><a href="#_21-1-3-get请求" class="header-anchor">#</a> 21.1.3 GET请求</h4> <h4 id="_21-1-4-post请求"><a href="#_21-1-4-post请求" class="header-anchor">#</a> 21.1.4 POST请求</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">submitData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readystate <span class="token operator">===</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>stateCode <span class="token operator">&gt;=</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> xhr<span class="token punctuation">.</span>stateCode <span class="token operator">&lt;</span> <span class="token number">300</span> <span class="token operator">||</span> xhr<span class="token punctuation">.</span>stateCode <span class="token operator">===</span> <span class="token number">304</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>responseText<span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">request is unsuccessful</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> xhr<span class="token punctuation">.</span>status<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;post&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ex.com&quot;</span><span class="token punctuation">)</span>
  xhr<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot; application/x-www-form-urlencoded&quot;</span><span class="token punctuation">)</span> <span class="token comment">// form表单会被编译成key-value发送到服务端</span>
  xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;// from表单的数据&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_21-2-xmlhttprequest-2级"><a href="#_21-2-xmlhttprequest-2级" class="header-anchor">#</a> 21.2 XMLHttpRequest 2级</h3> <h4 id="_21-2-1-formdata"><a href="#_21-2-1-formdata" class="header-anchor">#</a> 21.2.1 FormData</h4> <p>用于表单数据的序列化</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
data<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;nico&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="_21-2-2-超时设定"><a href="#_21-2-2-超时设定" class="header-anchor">#</a> 21.2.2 超时设定</h4> <p>ie8为xhr对象添加了一个timeout属性，表示在等待多少毫秒之后就终止，给定timeout属性后，如果在规定时间内没有收到响应，就会触发timeout事件，进而调用ontimeout事件处理程序</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
xhr<span class="token punctuation">.</span>onreadystatechange <span class="token operator">=</span> <span class="token operator">...</span>
xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>
xhr<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token number">1000</span>
xhr<span class="token punctuation">,</span><span class="token function-variable function">ontimeout</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'request did not return in a second'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>未避免浏览器报错，可以把检查status属性的语句封装在一个try-catch语句中</p> <h4 id="_21-2-3-overridemimetype-方法"><a href="#_21-2-3-overridemimetype-方法" class="header-anchor">#</a> 21.2.3 overrideMimeType()方法</h4> <h3 id="_21-3-进度事件"><a href="#_21-3-进度事件" class="header-anchor">#</a> 21.3 进度事件</h3> <p>6个进度事件：loadstart, progress, error, about, load, loadend</p> <h4 id="_21-3-1-load事件"><a href="#_21-3-1-load事件" class="header-anchor">#</a> 21.3.1 load事件</h4> <h4 id="_21-3-2-progress事件"><a href="#_21-3-2-progress事件" class="header-anchor">#</a> 21.3.2 progress事件</h4> <h3 id="_21-4-跨源资源共享"><a href="#_21-4-跨源资源共享" class="header-anchor">#</a> 21.4 跨源资源共享</h3> <p>通过XHR实现Ajax通信的一个主要限制，来源于跨域安全策略。默认情况下，XHR对象只能访问与包含它的页面位于同一个域中的资源，这种安全策略可以预防某些恶意行为。但是，实现合理的跨域请求对开发某些浏览器的应用也是至关重要的。
CORS(cross-origin resource sharing,跨域资源共享)，定义访问跨域资源时，浏览器域服务器因该如何沟通，CORS背后的思想，就是使用自定义的HTTP头部让浏览器与服务器进行沟通，从而决定请求或响应是否应该成功</p> <p>如发送请求，自定义Origin</p> <div class="language-js extra-class"><pre class="language-js"><code>Origin<span class="token operator">:</span> http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>ex<span class="token punctuation">.</span>com
</code></pre></div><p>服务器如果认为这个请求可以接受，就在Access-Control-Allow-Origin头部回发相同的源信息，如果是公共资源，可以发*</p> <div class="language-js extra-class"><pre class="language-js"><code>Access<span class="token operator">-</span>Control<span class="token operator">-</span>Allow<span class="token operator">-</span>Origin<span class="token operator">:</span> http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>ex<span class="token punctuation">.</span>com
</code></pre></div><p>如果没有这个头部，或者有这个头部但源信息不匹配，浏览器就会驳回请求</p> <h4 id="_21-4-1-ie对cors的实现"><a href="#_21-4-1-ie对cors的实现" class="header-anchor">#</a> 21.4.1 IE对CORS的实现</h4> <h4 id="_21-4-2-其他浏览器对cors的实现"><a href="#_21-4-2-其他浏览器对cors的实现" class="header-anchor">#</a> 21.4.2 其他浏览器对CORS的实现</h4> <h4 id="_21-4-3-preflighted-requests"><a href="#_21-4-3-preflighted-requests" class="header-anchor">#</a> 21.4.3 Preflighted Requests</h4> <p>服务器通过在响应中发送如下头部与浏览器进行沟通</p> <div class="language-js extra-class"><pre class="language-js"><code>Access<span class="token operator">-</span>Control<span class="token operator">-</span>Allow<span class="token operator">-</span>Origin<span class="token operator">:</span>
Access<span class="token operator">-</span>Control<span class="token operator">-</span>Allow<span class="token operator">-</span>Methods<span class="token operator">:</span> 允许的方法
Access<span class="token operator">-</span>Control<span class="token operator">-</span>Allow<span class="token operator">-</span>Headers<span class="token operator">:</span> 允许的头部
Access<span class="token operator">-</span>Control<span class="token operator">-</span>Max<span class="token operator">-</span>Age<span class="token operator">:</span> <span class="token function">应该将这个preflight请求缓存多长时间</span><span class="token punctuation">(</span>以秒表示<span class="token punctuation">)</span>
</code></pre></div><h4 id="_21-4-4-带凭据的请求"><a href="#_21-4-4-带凭据的请求" class="header-anchor">#</a> 21.4.4 带凭据的请求</h4> <p>默认情况下，跨域请求不提供凭据，如cookie，HTTP认证及客户端SSL证明等，通过将withCredentials属性设置为true,可以指定某个请求应该发送凭据<br>
如果服务器接收这样的请求，需设置：</p> <div class="language-js extra-class"><pre class="language-js"><code>Access<span class="token operator">-</span>Control<span class="token operator">-</span>Allow<span class="token operator">-</span>Credentials<span class="token operator">:</span> <span class="token boolean">true</span>
</code></pre></div><h4 id="_21-4-5-跨浏览器的cors"><a href="#_21-4-5-跨浏览器的cors" class="header-anchor">#</a> 21.4.5 跨浏览器的CORS</h4> <h3 id="_21-5-其他跨域技术"><a href="#_21-5-其他跨域技术" class="header-anchor">#</a> 21.5 其他跨域技术</h3> <h4 id="_21-5-1-图像ping"><a href="#_21-5-1-图像ping" class="header-anchor">#</a> 21.5.1 图像Ping</h4> <h4 id="_21-5-2-jsonp"><a href="#_21-5-2-jsonp" class="header-anchor">#</a> 21.5.2 JSONP</h4> <p>JSONP是JSON with padding的简写，是应用JSON的一种新方法，JSONP是被包含在函数调用的JSON,如<code>callback({&quot;name&quot;: &quot;nico&quot;})</code><br>
JSONP由两部分组成：回调函数和数据，回调函数的名字一般是在请求中指定的，而数据就是传入回调函数的JSON数据</p> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">function</span> <span class="token function">handleResponse</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;script&quot;</span><span class="token punctuation">)</span>
script<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">'http://ex.com/json/？callback=handleResponse'</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>script<span class="token punctuation">,</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>firstChild<span class="token punctuation">)</span>
</code></pre></div><p>JSONP优点：简单易用<br>
缺点：JSONP是在其他域中执行，如果其他域不安全，可能相应会夹带一些恶意代码。同时,要确定JSONP请求是否失败并不容易，需要使用计时器检测指定时间内是否收到了响应</p> <h4 id="_21-5-3-comet"><a href="#_21-5-3-comet" class="header-anchor">#</a> 21.5.3 Comet</h4> <p>Comet指的是一种更高级的ajax技术(经常也有人称为“服务器推送”)，ajax是一种页向服务器请求的技术，而Comet则是一种服务器向页面推送数据的技术。Comet能够让信息近乎实时的被推送到页面上，非常适合处理体育比赛的分数和股票报价。</p> <p>Comet实现方式有两种：长轮询和流。<br>
传统轮询又叫短轮询，即浏览器定时向服务器发送请求，看有没有更新的数据。长轮询把传统轮询颠倒了一下，页面发送一个到服务器的请求，然后服务器一直保持连接打开，直到有数据可发送。发送完数据之后，浏览器关闭连接，随机又发送一个到服务器的新请求，这一过程在页面打开期间一致持续不断。<br>
第二种流行的Comet实现是HTTP流，浏览器向服务器发送一个请求，而服务器保持连接打开，然后周期性的向浏览器发送数据</p> <h4 id="_21-5-4-服务器发送事件"><a href="#_21-5-4-服务器发送事件" class="header-anchor">#</a> 21.5.4 服务器发送事件</h4> <h4 id="_21-5-5-web-sockets"><a href="#_21-5-5-web-sockets" class="header-anchor">#</a> 21.5.5 Web Sockets</h4> <p>在持久连接上提供双向通信，在js中创建了websocket之后，会有一个HTTP请求发送到浏览器以发送连接，再取得服务器响应后，建立的连接会使用HTTP升级从HTTP协议交换为Web Socket协议。也就是说，标准的HTTP服务器无法实现Web Socket，只有支持这种协议的专门服务器才能正常工作。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 建立websocket</span>
<span class="token keyword">var</span> socket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span><span class="token string">&quot;city.com&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p>同源策略对websocket不适用，因此可以通过它打开到任何站点的连接，至于是否会与某个域中的页面通信，则完全取决于服务器</p> <p>WebSocket也有一个表示当前状态的readyState属性</p> <table><thead><tr><th>值</th> <th>说明</th></tr></thead> <tbody><tr><td>WebSocket.OPENING(0)</td> <td>正在建立连接</td></tr> <tr><td>WebSocket.OPEN(1)</td> <td>已经建立连接</td></tr> <tr><td>WebSocket.CLOSING(2)</td> <td>正在关闭连接</td></tr> <tr><td>WebSocket.CLOSE(3)</td> <td>已经关闭连接</td></tr></tbody></table> <p>关闭WebSocket 连接，使用<code>close()</code>方法</p> <p>发送数据，使用<code>send()</code>,只能发送纯文本数据，复杂数据结构需要先进行序列化</p> <p>服务端发来消息时，websocket对象会触发message事件，返回的数据保存在event.data里面</p> <div class="language-js extra-class"><pre class="language-js"><code>socket<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> data <span class="token operator">=</span> event<span class="token punctuation">.</span>data
  <span class="token comment">// 处理数据</span>
<span class="token punctuation">}</span>
</code></pre></div><p>websocket对象还有其他三个事件，在连接生命周期的不同阶段触发，<code>open, error, close</code>,websocket不支持DOM2事件监听器</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> socket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span><span class="token string">&quot;city.com&quot;</span><span class="token punctuation">)</span>
socket<span class="token punctuation">.</span><span class="token function-variable function">onopen</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Connection established'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
socket<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Connection error'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
socket<span class="token punctuation">.</span><span class="token function-variable function">onclose</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Connection closed'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>其中，只有close的事件对象(event)有额外信息，事件对象有三个额外属性: wasClean(是否明确关闭) code(服务器状态码) reason(服务器发回的消息)</p> <h4 id="_21-5-6-sse与web-sockets"><a href="#_21-5-6-sse与web-sockets" class="header-anchor">#</a> 21.5.6 SSE与Web Sockets</h4> <h3 id="_21-6-安全"><a href="#_21-6-安全" class="header-anchor">#</a> 21.6 安全</h3> <p>对于未被授权系统有权访问某个资源的情况，称之为CSRF(Cross-Site Request Forgery, 跨站点请求伪造)，未被授权系统会伪装自己，让处理请求的服务器认为它是合法的</p> <p>通常做法</p> <ul><li>要求以SSL连接来访问可以通过XHR请求的资源</li> <li>要求每一次请求都要附带经过相应算法计算得到的验证码</li></ul> <p>下面防范CSRF攻击不起作用</p> <ul><li>要求发送POST而不是GET请求--很容易改变</li> <li>检查来源URL以确定是否可信--来源记录很容易伪造</li> <li>基于cookie信息进行验证--同样很容易伪造</li></ul> <h3 id="_21-7-小结"><a href="#_21-7-小结" class="header-anchor">#</a> 21.7 小结</h3> <h2 id="第22章-高级技巧"><a href="#第22章-高级技巧" class="header-anchor">#</a> 第22章 高级技巧</h2> <h3 id="_22-1-高级函数"><a href="#_22-1-高级函数" class="header-anchor">#</a> 22.1 高级函数</h3> <h4 id="_22-1-1-安全的类型检测"><a href="#_22-1-1-安全的类型检测" class="header-anchor">#</a> 22.1.1 安全的类型检测</h4> <h4 id="_22-1-2-作用域安全的构造函数"><a href="#_22-1-2-作用域安全的构造函数" class="header-anchor">#</a> 22.1.2 作用域安全的构造函数</h4> <p>构造函数执行的时候如果不写<code>new</code>操作符，this会意外的指向window对象</p> <h4 id="_22-1-3-惰性载入函数"><a href="#_22-1-3-惰性载入函数" class="header-anchor">#</a> 22.1.3 惰性载入函数</h4> <h4 id="_22-1-4-函数绑定"><a href="#_22-1-4-函数绑定" class="header-anchor">#</a> 22.1.4 函数绑定</h4> <p>将函数绑定到指定环境的函数 bind apply bind 等等</p> <h4 id="函数柯里化"><a href="#函数柯里化" class="header-anchor">#</a> 函数柯里化</h4> <p>与函数绑定密切相关的主题是函数柯里化(function currying),它用于创建已经设置好一个或多个参数的函数。函数柯里化的基本方法和函数绑定是一样的：使用一个闭包返回一个函数。两者的区别在于，当函数被调用时，返回的函数还需要设置一些传入的参数。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> num1 <span class="token operator">+</span> num2
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">curriedAdd</span><span class="token punctuation">(</span><span class="token parameter">num2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> num2<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">alert</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 5</span>
<span class="token function">alert</span><span class="token punctuation">(</span><span class="token function">curriedAdd</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 8</span>
</code></pre></div><p>柯里化函数通常由以下步骤动态创建：调用另一个函数并为它传入要柯里化的函数和必要参数，下面是创建柯里化函数的通用方法</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">curry</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 可传入多个参数，其中第一个是函数</span>
  <span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// 从第一个截取参数数组，因为第一个参数是要进行柯里化的函数</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> innerArgs <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span><span class="token function">prototype</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span> <span class="token comment">// 获取内部匿名函数的参数</span>
    <span class="token keyword">var</span> finalArgs <span class="token operator">=</span> args<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>innerArgs<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> finalArgs<span class="token punctuation">)</span> <span class="token comment">// 传入最终参数</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>函数的调用</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> num1 <span class="token operator">+</span> num2
<span class="token punctuation">}</span>
<span class="token keyword">var</span> curriedAdd <span class="token operator">=</span> <span class="token function">curry</span><span class="token punctuation">(</span>add<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token comment">// 返回一个函数，这个函数可以传参，参数包含5以及调用时传入的其他参数</span>
<span class="token function">alert</span><span class="token punctuation">(</span><span class="token function">curriedAdd</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">// 8,  3成为了add的第二个参数</span>
<span class="token comment">// 或者 等同于下面</span>
<span class="token keyword">var</span> curriedAdd <span class="token operator">=</span> <span class="token function">curry</span><span class="token punctuation">(</span>add<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span>  
<span class="token function">alert</span><span class="token punctuation">(</span><span class="token function">curriedAdd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 18</span>
</code></pre></div><p>bind函数的使用</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">bind</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// 第一个参数是要绑定的函数，第二个是执行上下文(this)</span>
  <span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> innerArgs <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span>
    <span class="token keyword">var</span> finalArgs <span class="token operator">=</span> args<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>innerArgs<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> finalArgs<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>es5的bind函数，简单实现</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">bind</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 传入要绑定的this和一些参数</span>
  <span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token keyword">this</span> <span class="token comment">// this指的是调用Bind函数的这个函数</span>
  <span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// args是要传入的参数</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">self</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> args<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_22-2-防篡改对象-tamper-proof-object"><a href="#_22-2-防篡改对象-tamper-proof-object" class="header-anchor">#</a> 22.2 防篡改对象(tamper-proof object)</h3> <h4 id="_22-2-1-不可扩展对象"><a href="#_22-2-1-不可扩展对象" class="header-anchor">#</a> 22.2.1 不可扩展对象</h4> <h4 id="_22-2-2-密封的对象-sealed-object"><a href="#_22-2-2-密封的对象-sealed-object" class="header-anchor">#</a> 22.2.2 密封的对象(sealed object)</h4> <h4 id="_22-2-3-冻结的对象-frozen-object"><a href="#_22-2-3-冻结的对象-frozen-object" class="header-anchor">#</a> 22.2.3 冻结的对象(frozen object)</h4> <h3 id="_22-3-高级定时器"><a href="#_22-3-高级定时器" class="header-anchor">#</a> 22.3 高级定时器</h3> <p>定时器队列的工作方式是，当特定时间后将代码插入，给队列添加代码并不意味着对它立即执行，而只能表示它会尽快执行，设定一个。设定一个150ms后执行的定时器不代表到150ms代码就立刻执行，它表示代码会在150ms后被加入到队列中，如果在这个时间点上，队列中没有其他东西，那么这段代码就会被执行，表面上看好像代码在精确指定的时间点上执行了，其他情况下，代码可能等待更长时间才会执行</p> <h4 id="_22-3-1-重复的定时器"><a href="#_22-3-1-重复的定时器" class="header-anchor">#</a> 22.3.1 重复的定时器</h4> <h4 id="_22-3-2-yielding-processes"><a href="#_22-3-2-yielding-processes" class="header-anchor">#</a> 22.3.2 Yielding Processes</h4> <h4 id="_22-3-3-函数节流"><a href="#_22-3-3-函数节流" class="header-anchor">#</a> 22.3.3 函数节流</h4> <p>函数节流背后的思想是，某些代码不可以在没有间断的情况连续重复执行，第一次调用函数，创建一个定时器，在指定的时间间隔之后运行代码，当第二次调用该函数时，会清除前一次的定时器并设置另一个。如果前一个定时器已经执行过了，这个操作就没有任何意义。然而，如果前一个定时器尚未执行，其实就是将其替换为一个新的定时器。目的是只有在执行函数的请求停止了一段时间之后才执行</p> <p>基本形式</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> processor <span class="token operator">=</span>  <span class="token punctuation">{</span>
  timeoutId<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>

  <span class="token comment">// 实际进行处理的方法</span>
  <span class="token function-variable function">performProcessing</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 实际执行的代码</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 初始处理调用的代码</span>
  <span class="token function-variable function">process</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">clearTimeout</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>timeoutId<span class="token punctuation">)</span>
    <span class="token keyword">var</span> that <span class="token operator">=</span> <span class="token keyword">this</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>timeoutId <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      that<span class="token punctuation">.</span><span class="token function">performProcessing</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 尝试开始执行</span>
processor<span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>processor对象有两个方法，processor()和performProcessing()，前者是初始化必须调用的，后者则进行实际应完成的处理。当调用process()，第一步是清除timeoutId，来阻止之前的调用被执行，然后创建一个新的定时器调用performProcessing()，由于setTimeout()中用到的函数的环境总是window,所以必须保存this的引用以方便以后使用。</p> <p>使用throttle()函数来简化，</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token parameter">method<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 要执行的函数，以及在哪个作用域执行</span>
  <span class="token function">clearTimeout</span><span class="token punctuation">(</span>method<span class="token punctuation">.</span>tId<span class="token punctuation">)</span>
  method<span class="token punctuation">.</span>tId <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">method</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

window<span class="token punctuation">.</span><span class="token function-variable function">onresize</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>注：现在比较流行的防抖</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">debounce</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> delay</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> timerId <span class="token operator">=</span> <span class="token keyword">null</span>

  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> context <span class="token operator">=</span> <span class="token keyword">this</span>
    <span class="token keyword">let</span> args <span class="token operator">=</span> arguments
    <span class="token keyword">if</span> <span class="token punctuation">(</span>timer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timerId<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    timerId <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> args<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> better_scroll <span class="token operator">=</span> <span class="token function">debounce</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'触发了滚动事件'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'scroll'</span><span class="token punctuation">,</span> better_scroll<span class="token punctuation">)</span>
</code></pre></div><h3 id="_22-4-自定义事件"><a href="#_22-4-自定义事件" class="header-anchor">#</a> 22.4 自定义事件</h3> <p>观察者模式由两类对象组成：主题和观察者，主体负责发布事件，同时观察者通过订阅这些事件来观察主体<br>
事件是与DOM交互的最常见的方式</p> <h3 id="_22-5-拖放"><a href="#_22-5-拖放" class="header-anchor">#</a> 22.5 拖放</h3> <h4 id="_22-5-1-修缮拖动功能"><a href="#_22-5-1-修缮拖动功能" class="header-anchor">#</a> 22.5.1 修缮拖动功能</h4> <h4 id="_22-5-2-添加自定义事件"><a href="#_22-5-2-添加自定义事件" class="header-anchor">#</a> 22.5.2 添加自定义事件</h4> <h3 id="_22-6-小结"><a href="#_22-6-小结" class="header-anchor">#</a> 22.6 小结</h3> <p>JS中的函数非常强大，因为他们是第一类对象，使用闭包和函数环境切换，还可以有很多使用函数的强大方法</p> <ul><li>函数绑定与柯里化</li></ul> <h2 id="第23章-离线应用与客户端存储"><a href="#第23章-离线应用与客户端存储" class="header-anchor">#</a> 第23章 离线应用与客户端存储</h2> <h3 id="_23-1-离线检测"><a href="#_23-1-离线检测" class="header-anchor">#</a> 23.1 离线检测</h3> <h3 id="_23-2-应用缓存"><a href="#_23-2-应用缓存" class="header-anchor">#</a> 23.2 应用缓存</h3> <h3 id="_23-3-数据存储"><a href="#_23-3-数据存储" class="header-anchor">#</a> 23.3 数据存储</h3> <h4 id="_23-3-1-cookie"><a href="#_23-3-1-cookie" class="header-anchor">#</a> 23.3.1 Cookie</h4> <p>服务器响应头</p> <div class="language-js extra-class"><pre class="language-js"><code>Content<span class="token operator">-</span>type<span class="token operator">:</span> text<span class="token operator">/</span>html
Set<span class="token operator">-</span>Cookie<span class="token operator">:</span> name<span class="token operator">=</span>value
<span class="token operator">...</span>
</code></pre></div><p>限制：每个域的cookie数有限，尺寸小于4kb，</p> <p>cookie组成</p> <table><thead><tr><th>值</th> <th>说明</th></tr></thead> <tbody><tr><td>名称(name)</td> <td></td></tr> <tr><td>值(value)</td> <td></td></tr> <tr><td>域(domain)</td> <td>即域名</td></tr> <tr><td>路径(path)</td> <td>通常是 /</td></tr> <tr><td>失效时间(Expires/Max-Age)</td> <td></td></tr> <tr><td>大小(size)</td> <td></td></tr> <tr><td>HttpOnly</td> <td>是否只能服务器修改</td></tr> <tr><td>安全(Secure)</td> <td></td></tr></tbody></table> <div class="language-js extra-class"><pre class="language-js"><code>Set<span class="token operator">-</span>Cookie<span class="token operator">:</span> name<span class="token operator">=</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">;</span> domain<span class="token operator">=</span>cc<span class="token punctuation">.</span>com<span class="token punctuation">;</span> path<span class="token operator">=</span><span class="token operator">/</span><span class="token punctuation">;</span> expires<span class="token operator">=</span> Mon<span class="token punctuation">,</span><span class="token number">22</span><span class="token operator">-</span>Jan<span class="token operator">-</span><span class="token number">07</span> <span class="token number">07</span><span class="token operator">:</span><span class="token number">10</span><span class="token operator">:</span><span class="token number">10</span> <span class="token constant">GMT</span><span class="token punctuation">;</span> secure<span class="token punctuation">;</span> http<span class="token operator">-</span>only
</code></pre></div><p>js获取cookie:<br>
document.cookie获取cookie, 也可以设置cookie(前提是服务端没有设置http-only)</p> <h4 id="_23-3-2-ie用户数据"><a href="#_23-3-2-ie用户数据" class="header-anchor">#</a> 23.3.2 IE用户数据</h4> <h4 id="_23-3-3-web存储机制"><a href="#_23-3-3-web存储机制" class="header-anchor">#</a> 23.3.3 Web存储机制</h4> <p>h5新增 sessionStorage localStorage 使用<code>setItem, removeItem, clearItem, getItem</code>等方法</p> <p>storage事件，对storage对象进行任何修改都会触发storage事件<br>
事件对象有下列属性：</p> <table><thead><tr><th>值</th> <th>说明</th></tr></thead> <tbody><tr><td>domain</td> <td>发生变化的存储空间的域名</td></tr> <tr><td>key</td> <td>设置或者删除的域名</td></tr> <tr><td>newValue</td> <td>如果是设置值，则是新值，如果是删除值，则是Null</td></tr> <tr><td>oldValue</td> <td>键被更改之前的值</td></tr></tbody></table> <p>storage限制一般是5M</p> <h4 id="_23-3-4-indexdb"><a href="#_23-3-4-indexdb" class="header-anchor">#</a> 23.3.4 IndexDB</h4> <h3 id="_23-4-小结"><a href="#_23-4-小结" class="header-anchor">#</a> 23.4 小结</h3> <h2 id="第24章-最佳实践"><a href="#第24章-最佳实践" class="header-anchor">#</a> 第24章 最佳实践</h2> <h3 id="_24-1-可维护性"><a href="#_24-1-可维护性" class="header-anchor">#</a> 24.1 可维护性</h3> <h4 id="_24-1-1-什么是可维护的代码"><a href="#_24-1-1-什么是可维护的代码" class="header-anchor">#</a> 24.1.1 什么是可维护的代码</h4> <ul><li>可理解性：其他人可以接手代码并理解它的意图和一般途径，而无需原开发人员的完整解释</li> <li>直观性：代码中的东西一看就明白，不管其操作过程多么复杂</li> <li>可适用性：代码以一种数据上的变化不要求完全重写的方法撰写</li> <li>可扩展性： 在代码架构上已考虑到未来允许对核心功能进行拓展</li> <li>可调式性：当有地方出错时，代码可以给予你足够的信息来尽可能的直接确定问题所在</li></ul> <h4 id="_24-1-2-代码约定"><a href="#_24-1-2-代码约定" class="header-anchor">#</a> 24.1.2 代码约定</h4> <h5 id="_1-可读性"><a href="#_1-可读性" class="header-anchor">#</a> 1.可读性</h5> <ul><li>函数和方法——应当有注释，描述其目的和用于完成任务所可能使用的算法。陈述事先的假设也很重要，如参数代表什么，函数是否有返回值</li> <li>大段代码的注释</li> <li>复杂算法</li></ul> <h5 id="_2-变量和函数命名"><a href="#_2-变量和函数命名" class="header-anchor">#</a> 2.变量和函数命名</h5> <ul><li>变量名应是名词，如car或person</li> <li>函数名应该以动词开始，如getName()，返回布尔值的函数一般以is开头，如isEnable()</li> <li>应使用合乎逻辑的名字</li></ul> <h5 id="_3-变量类型透明"><a href="#_3-变量类型透明" class="header-anchor">#</a> 3.变量类型透明</h5> <ul><li>定义变量时，应该有初始值</li></ul> <h4 id="_24-1-3-松散耦合"><a href="#_24-1-3-松散耦合" class="header-anchor">#</a> 24.1.3 松散耦合</h4> <p>只要应用的某个部分过分依赖另一部分，代码就是耦合过紧，难于维护。典型的问题如：对象直接引用另一个对象，并且当修改其中一个的同时需要修改另外一个。紧密耦合的软件难以维护并且需要经常重写。</p> <h5 id="_1-解耦html-javascript"><a href="#_1-解耦html-javascript" class="header-anchor">#</a> 1.解耦HTML/Javascript</h5> <p>内联代码，内联使用程序</p> <h5 id="_2-解耦css-javascript"><a href="#_2-解耦css-javascript" class="header-anchor">#</a> 2.解耦CSS/Javascript</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// css与js的紧密耦合</span>
element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">&quot;red&quot;</span>
element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> <span class="token string">&quot;blue&quot;</span>
<span class="token comment">// css对js的松散耦合</span>
element<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">&quot;edit&quot;</span>
</code></pre></div><h5 id="_3-解耦应用逻辑-事件处理程序"><a href="#_3-解耦应用逻辑-事件处理程序" class="header-anchor">#</a> 3.解耦应用逻辑/事件处理程序</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">handleKeyPress</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>keyCode <span class="token operator">===</span> <span class="token number">13</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 即enter键</span>
    <span class="token comment">// 应用逻辑</span>
    <span class="token keyword">var</span> value <span class="token operator">=</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">&gt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;err-message&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&quot;block&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 抽离应用逻辑</span>
<span class="token keyword">function</span> <span class="token function">validateValue</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  value <span class="token operator">=</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">&gt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;err-message&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&quot;block&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">handleKeyPress</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>keyCode <span class="token operator">===</span> <span class="token number">13</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>
    <span class="token function">validateValue</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>validateValue函数没有任何东西依赖事件处理程序逻辑，它只接收一个值，并根据该值进行其他处理</p> <h4 id="_24-1-4-编程实践"><a href="#_24-1-4-编程实践" class="header-anchor">#</a> 24.1.4 编程实践</h4> <h5 id="_1-尊重对象所有权"><a href="#_1-尊重对象所有权" class="header-anchor">#</a> 1.尊重对象所有权</h5> <p>如果你不负责创建或维护对象，就不能对它们进行修改</p> <ul><li>不要为实例或原型添加属性/方法</li> <li>不要重定义已存在的方法</li></ul> <h5 id="_2-避免全局变量"><a href="#_2-避免全局变量" class="header-anchor">#</a> 2.避免全局变量</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 两个全局量——避免！！</span>
<span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'nico'</span>
<span class="token keyword">function</span> <span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 一个全局变量，推荐</span>
</code></pre></div><h5 id="_3-避免与null进行比较"><a href="#_3-避免与null进行比较" class="header-anchor">#</a> 3.避免与null进行比较</h5> <h5 id="_4-使用常量"><a href="#_4-使用常量" class="header-anchor">#</a> 4.使用常量</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">validate</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;invalid value!&quot;</span><span class="token punctuation">)</span>
    location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">&quot;/errors/invalid.php&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这个函数中有两端数据：要显示给用户的信息以及URL。这些都有随应用成长而改变的倾向</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> Constance <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">INVALID_MESSAGE_ERROR</span><span class="token operator">:</span> <span class="token string">&quot;invalid value!&quot;</span><span class="token punctuation">,</span>
  <span class="token constant">INVALID_MESSAGE_URL</span><span class="token operator">:</span> <span class="token string">&quot;/errors/invalid.php&quot;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">validate</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span>Constance<span class="token punctuation">.</span><span class="token constant">INVALID_MESSAGE_ERROR</span><span class="token punctuation">)</span>
    location<span class="token punctuation">.</span>href <span class="token operator">=</span> Constance<span class="token punctuation">.</span><span class="token constant">INVALID_MESSAGE_URL</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>将数据和使用它的逻辑进行分离，要注意的值的类型如下</p> <ul><li>重复值</li> <li>用户界面字符串</li> <li>URLs</li> <li>任意可能会改变的值</li></ul> <h3 id="_24-2-性能"><a href="#_24-2-性能" class="header-anchor">#</a> 24.2 性能</h3> <h4 id="_24-2-1-注意作用域"><a href="#_24-2-1-注意作用域" class="header-anchor">#</a> 24.2.1 注意作用域</h4> <h4 id="_24-2-2-选择正确方法"><a href="#_24-2-2-选择正确方法" class="header-anchor">#</a> 24.2.2 选择正确方法</h4> <h4 id="_24-2-3-最小化语句数"><a href="#_24-2-3-最小化语句数" class="header-anchor">#</a> 24.2.3 最小化语句数</h4> <h5 id="_1-多个变量声明"><a href="#_1-多个变量声明" class="header-anchor">#</a> 1.多个变量声明</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 3个语句，很浪费</span>
<span class="token keyword">var</span> count <span class="token operator">=</span> <span class="token number">5</span>
<span class="token keyword">var</span> color <span class="token operator">=</span> <span class="token string">&quot;blue&quot;</span>
<span class="token keyword">var</span> values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
<span class="token comment">// 一个语句</span>
<span class="token keyword">var</span> count <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span>
    color <span class="token operator">=</span> <span class="token string">&quot;blue&quot;</span><span class="token punctuation">,</span>
    values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
</code></pre></div><h5 id="_2-插入迭代值"><a href="#_2-插入迭代值" class="header-anchor">#</a> 2.插入迭代值</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> name <span class="token operator">=</span> values<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
i <span class="token operator">++</span>
<span class="token comment">// 一个语句</span>
<span class="token keyword">var</span> name <span class="token operator">=</span> values<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span>
</code></pre></div><h5 id="_3-使用数组和对象字面量"><a href="#_3-使用数组和对象字面量" class="header-anchor">#</a> 3.使用数组和对象字面量</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 使用两个语句初始化数组--浪费</span>
<span class="token keyword">var</span> values <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
values<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">2</span>
<span class="token comment">// 使用两个语句创建和初始化对象</span>
<span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
person<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'nico'</span>
person<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">22</span>
<span class="token comment">// 优化</span>
<span class="token keyword">var</span> values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span>
<span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&quot;nico&quot;</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">22</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_24-2-4-优化dom交互"><a href="#_24-2-4-优化dom交互" class="header-anchor">#</a> 24.2.4 优化DOM交互</h4> <h3 id="_24-3-部署"><a href="#_24-3-部署" class="header-anchor">#</a> 24.3 部署</h3> <h4 id="_24-3-1-构建过程"><a href="#_24-3-1-构建过程" class="header-anchor">#</a> 24.3.1 构建过程</h4> <h4 id="_24-3-2-验证"><a href="#_24-3-2-验证" class="header-anchor">#</a> 24.3.2 验证</h4> <p>JSlint</p> <h4 id="_24-3-3-压缩"><a href="#_24-3-3-压缩" class="header-anchor">#</a> 24.3.3 压缩</h4> <ul><li>1.文件压缩</li> <li>2.http压缩</li></ul> <h3 id="_24-4-小结"><a href="#_24-4-小结" class="header-anchor">#</a> 24.4 小结</h3> <h2 id="第25章-新兴的api"><a href="#第25章-新兴的api" class="header-anchor">#</a> 第25章 新兴的API</h2> <h3 id="_25-1-requestanimationframe"><a href="#_25-1-requestanimationframe" class="header-anchor">#</a> 25.1 requestAnimationFrame()</h3> <h4 id="_25-1-1-早期动画循环"><a href="#_25-1-1-早期动画循环" class="header-anchor">#</a> 25.1.1 早期动画循环</h4> <p>用setInterval方法来控制所有动画</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">updateAnimation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">doAnimation1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">doAnimation2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// 其他动画</span>
  <span class="token punctuation">}</span>
  <span class="token function">setInterval</span><span class="token punctuation">(</span>updateAnimation<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>如果队列前面已经加入了其他任务，那动画就要等到前面的任务完成后在执行</p> <h4 id="_25-1-2-循环间隔的问题"><a href="#_25-1-2-循环间隔的问题" class="header-anchor">#</a> 25.1.2 循环间隔的问题</h4> <p>浏览器计时的精度</p> <h4 id="_25-1-3-mozrequestanimationframe"><a href="#_25-1-3-mozrequestanimationframe" class="header-anchor">#</a> 25.1.3 mozRequestAnimationFrame</h4> <p>解决js不知道动画如何开始，不知道最佳循环间隔时间的问题</p> <h4 id="_25-1-4-webkitrequestanimationframe与msrequestanimationframe"><a href="#_25-1-4-webkitrequestanimationframe与msrequestanimationframe" class="header-anchor">#</a> 25.1.4 webkitRequestAnimationFrame与msRequestAnimationFrame</h4> <h3 id="_25-2-page-visibility-api"><a href="#_25-2-page-visibility-api" class="header-anchor">#</a> 25.2 Page Visibility API</h3> <p>不知道用户是不是正在与页面交互，这是困扰广大web开发人员的一个主要问题，如果页面最小化了或者隐藏在了其他标签页后面，那么有些功能是可以停下来的，比如轮询服务器或者某些动画效果
<code>document.hidden</code> 表示页面是否隐藏的布尔值，页面隐藏包括页面在后台标签页(即不在当前屏幕显示的页)或者浏览器最小化</p> <p><code>document.visibilityState</code>由四个值构成</p> <ul><li>页面在后台标签页中或浏览器最小化</li> <li>页面在前台标签页中</li> <li>实际的页面已隐藏，但用户可以看到页面的预览</li> <li>页面在屏幕外执行预渲染处理</li></ul> <p><code>visibilitychange</code>事件，文档从可见变为不可见或从不可见变为可见时，触发该事件</p> <div class="language-js extra-class"><pre class="language-js"><code>document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;visibilitychange&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_25-3-geolocation-api"><a href="#_25-3-geolocation-api" class="header-anchor">#</a> 25.3 Geolocation API</h3> <p>地理定位，访问之前需要得到用户的许可</p> <p>在浏览器中的实现是 navigator.geolocation对象，对象包含三个方法，</p> <p><code>getCurrentPosition()</code>，接收三个参数，成功回调，可选失败回调和可选的选项对象</p> <p>成功回调会接收一个Position对象参数，对象有两个属性,coords和timestamp</p> <p>coords对象包含下面与位置相关的信息，latitude,纬度, longitude，经度，accuracy,经纬度精度，以米为单位,<br>
有些浏览器还包含了 heading(指南针的方向), speed(速度，即每秒移动多少米), altitude(海拔高度)，altitude(海拔高度的经度)</p> <div class="language-js extra-class"><pre class="language-js"><code>navigator<span class="token punctuation">.</span>geolocation<span class="token punctuation">.</span><span class="token function">getCurrentPosition</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">position</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>position<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>code<span class="token punctuation">)</span> <span class="token comment">// code包含错误类型，用户拒绝共享1，位置无效2，超时3</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  enableHighAccuracy<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 必须尽可能使用最准确的位置信息，消耗更多电量</span>
  timeout<span class="token operator">:</span> <span class="token number">5000</span><span class="token punctuation">,</span> <span class="token comment">// 等待位置信息的最长时间</span>
  maxinumAge<span class="token operator">:</span> <span class="token number">25000</span> <span class="token comment">// 上一次取得坐标信息的有效时间，Infinity始终使用上一次坐标信息</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>跟踪用户位置，使用<code>watchPosition()</code>，接收参数与<code>getCurrentPosition</code>完全相同，<code>watchPosition</code>与定时调用<code>getCurrentPosition</code>效果相同</p> <p><code>watchPosition</code>会返回一个数值标识符，用于跟踪监控的操作，基于这个返回值可以取消返回操作，只要将其传递给clearWatch方法即可(与定时器使用类似)</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> watchId <span class="token operator">=</span> navigator<span class="token punctuation">.</span>geolocation<span class="token punctuation">.</span><span class="token function">watchPosition</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">position</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">drawMapCenteredAt</span><span class="token punctuation">(</span>postion<span class="token punctuation">.</span>coords<span class="token punctuation">.</span>latitude<span class="token punctuation">,</span> postion<span class="token punctuation">.</span>coords<span class="token punctuation">.</span>longitude<span class="token punctuation">)</span> <span class="token comment">// 实际并没有这个方法</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>code<span class="token punctuation">)</span> <span class="token comment">// code包含错误类型，用户拒绝共享1，位置无效2，超时3</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_25-4-file-api"><a href="#_25-4-file-api" class="header-anchor">#</a> 25.4 File API</h3> <p>不能直接访问用户计算机中的文件，一直是Web应用开发中的一大障碍。
2000年以前，处理文件的唯一方式就是在表单中加入<code>&lt;input type=&quot;file&quot;&gt;</code></p> <p>HTML5在DOM中为文件输入元素添加了一个files集合，在通过文件输入字段选择了一个或多个文件时，files集合中将包含一组File对象，每个File对象对应着一个文件，每个file对象都有下列只读属性</p> <table><thead><tr><th>值</th> <th>说明</th></tr></thead> <tbody><tr><td>name</td> <td>本地文件系统中的文件名</td></tr> <tr><td>size</td> <td>文件的字节大小</td></tr> <tr><td>type</td> <td>字符串，文件的MIME类型</td></tr> <tr><td>lastModifiedDate</td> <td>字符串，文件上一次被修改的时间</td></tr></tbody></table> <p>通过侦听change事件</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> fileList <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;file-list&quot;</span><span class="token punctuation">)</span>
fileList<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;change&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> event<span class="token punctuation">.</span>files<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>files<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="_25-4-1-filereader类型"><a href="#_25-4-1-filereader类型" class="header-anchor">#</a> 25.4.1 FileReader类型</h4> <p>FileReader类型实现的是一种异步文件读取机制</p> <h4 id="_25-4-2-读取部分内容"><a href="#_25-4-2-读取部分内容" class="header-anchor">#</a> 25.4.2 读取部分内容</h4> <h4 id="_25-4-3-对象url"><a href="#_25-4-3-对象url" class="header-anchor">#</a> 25.4.3 对象URL</h4> <h4 id="_25-4-4-读取拖放的文件"><a href="#_25-4-4-读取拖放的文件" class="header-anchor">#</a> 25.4.4 读取拖放的文件</h4> <h4 id="_25-4-5-使用xhr上传文件"><a href="#_25-4-5-使用xhr上传文件" class="header-anchor">#</a> 25.4.5 使用XHR上传文件</h4> <p>通过File Api 能够访问到文件内容，利用这一点就可以通过XHR直接把文件上传到服务器。当然，把文件内容放到send()方法中，再通过post请求，的确很容易就能实现上传，但这样传递的是文件内容，因而服务器必须收集提交的内容，然后再把它们保存到另一个文件中，其实，更好的做法是以表单提交的方式来上传文件。</p> <p>使用FormData类型很容易就做到了</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> target <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'form-file'</span><span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">handleEvent</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  files <span class="token operator">=</span> target<span class="token punctuation">.</span>files
  <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> files<span class="token punctuation">.</span>lenght<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    data<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;file&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">,</span> files<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    i<span class="token operator">++</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;post&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;example.com&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
  xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">alert</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>responseText<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>当然，也可以使用h5提供的拖拽事件上传文件</p> <h3 id="_25-5-web计时"><a href="#_25-5-web计时" class="header-anchor">#</a> 25.5 Web计时</h3> <p>Web计时的核心是window.performance对象</p> <p>performance.navigation/time 等等属性</p> <h3 id="_25-6-web-workers"><a href="#_25-6-web-workers" class="header-anchor">#</a> 25.6 Web Workers</h3> <p>解决js加载阻塞问题</p> <h4 id="_25-6-1-使用worker"><a href="#_25-6-1-使用worker" class="header-anchor">#</a> 25.6.1 使用Worker</h4> <h4 id="_25-6-2-worker全局作用域"><a href="#_25-6-2-worker全局作用域" class="header-anchor">#</a> 25.6.2 Worker全局作用域</h4> <h4 id="_25-6-3-包含其他脚本"><a href="#_25-6-3-包含其他脚本" class="header-anchor">#</a> 25.6.3 包含其他脚本</h4> <h4 id="_25-6-1-web-workers的未来"><a href="#_25-6-1-web-workers的未来" class="header-anchor">#</a> 25.6.1 Web Workers的未来</h4> <h3 id="_25-7-小结"><a href="#_25-7-小结" class="header-anchor">#</a> 25.7 小结</h3> <ul><li>requestAnimationFrame()</li> <li>Page Visibility API</li> <li>GeoLocation API</li> <li>File API</li> <li>Web Timing</li> <li>Web Workers</li></ul> <h2 id="附录a-ecmascript-harmony"><a href="#附录a-ecmascript-harmony" class="header-anchor">#</a> 附录A ECMAScript Harmony</h2> <p>即ES6的前身</p> <h3 id="a-1-一般性变化"><a href="#a-1-一般性变化" class="header-anchor">#</a> A.1 一般性变化</h3> <h4 id="a-1-1-常量"><a href="#a-1-1-常量" class="header-anchor">#</a> A.1.1 常量</h4> <p>const</p> <h4 id="a-1-2-块级作用域及其他作用域"><a href="#a-1-2-块级作用域及其他作用域" class="header-anchor">#</a> A.1.2 块级作用域及其他作用域</h4> <p>let...</p> <h3 id="a-2-函数"><a href="#a-2-函数" class="header-anchor">#</a> A.2 函数</h3> <h4 id="a-2-1-剩余参数与分布参数"><a href="#a-2-1-剩余参数与分布参数" class="header-anchor">#</a> A.2.1 剩余参数与分布参数</h4> <p>剩余参数(rest arguments)。使用这种语法可以定义可能会传进来的更多参数，然后把它们收集到一个数组中。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2<span class="token punctuation">,</span> <span class="token operator">...</span>nums</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> result <span class="token operator">=</span> num1 <span class="token operator">+</span> num2
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    result <span class="token operator">+=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> result
<span class="token punctuation">}</span>
<span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>
</code></pre></div><p>定义了一个sum函数，至少接收两个参数，其余参数都将保存到nums数组中，与原来的arguments对象不同，剩余参数都保存在Array的一个实例中，因此可以使用任何数组方法来操作它们。另外，即使没有多余的参数传入函数，剩余参数对象也是Array的一个实例。</p> <p>与剩余参数紧密相关的另一种参数语法是分布参数(spread arguments)。通过分布参数，可以向函数中传入一个数组，然后数组中的元素会映射到函数的每个参数上。分布参数的语法形式与剩余参数的语法相同，就是在值的前面加三个点。唯一的区别是分布参数在调用函数的时候使用，而剩余参数在定义函数的时候使用。比如，我们可以不给sum()函数一个一个的传入参数，而是传入分布参数</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">// 等同于</span>
<span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="a-2-2-默认参数"><a href="#a-2-2-默认参数" class="header-anchor">#</a> A.2.2 默认参数</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2 <span class="token operator">=</span> <span class="token number">0</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> num1 <span class="token operator">+</span> num2
<span class="token punctuation">}</span>
<span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="a-2-3-生成器"><a href="#a-2-3-生成器" class="header-anchor">#</a> A.2.3 生成器</h4> <p>所谓生成器，其实就是一个对象，它每次都能生成一系列值中的一个。</p> <p>要创建生成器，可以让函数通过yield操作符返回某个特殊的值，对于使用yield操作符返回值的函数，调用它时就会创建一个新的Generator实例。然后，在这个实例上调用next()方法就能取得生成器的第一个值。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/reading-notes/" class="prev router-link-active">
        总览
      </a></span> <span class="next"><a href="/reading-notes/books19/understanding-es6.html">
        深入理解ES6
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><div id="live2d-widget" class="live2d-widget-container" style="position:fixed;right:15px;bottom:60px;width:150px;height:300px;z-index:99999;opacity:0.8;pointer-events:none;"><canvas id="live2d_canvas" width="150" height="300" class="live2d_canvas" style="position:absolute;left:0px;top:0px;width:150px;height:300px;"></canvas></div></div></div>
    <script src="/reading-notes/assets/js/app.3c3209d0.js" defer></script><script src="/reading-notes/assets/js/2.a1b00631.js" defer></script><script src="/reading-notes/assets/js/3.e746fc3a.js" defer></script>
  </body>
</html>
