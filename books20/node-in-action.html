<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Node.js实战 第二版 2018 | 读书笔记</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/reading-notes/avatar.png">
    <meta name="description" content="小白龙的前端读书笔记">
    
    <link rel="preload" href="/reading-notes/assets/css/0.styles.9653101a.css" as="style"><link rel="preload" href="/reading-notes/assets/js/app.3c3209d0.js" as="script"><link rel="preload" href="/reading-notes/assets/js/2.a1b00631.js" as="script"><link rel="preload" href="/reading-notes/assets/js/16.985c71fb.js" as="script"><link rel="prefetch" href="/reading-notes/assets/js/10.b01eb44d.js"><link rel="prefetch" href="/reading-notes/assets/js/11.7a9ed704.js"><link rel="prefetch" href="/reading-notes/assets/js/12.326518b6.js"><link rel="prefetch" href="/reading-notes/assets/js/13.bb903b42.js"><link rel="prefetch" href="/reading-notes/assets/js/14.f8bb1bef.js"><link rel="prefetch" href="/reading-notes/assets/js/15.fc976780.js"><link rel="prefetch" href="/reading-notes/assets/js/17.91297be8.js"><link rel="prefetch" href="/reading-notes/assets/js/3.e746fc3a.js"><link rel="prefetch" href="/reading-notes/assets/js/4.bbac7c20.js"><link rel="prefetch" href="/reading-notes/assets/js/5.a9f838c3.js"><link rel="prefetch" href="/reading-notes/assets/js/6.514d7ebf.js"><link rel="prefetch" href="/reading-notes/assets/js/7.7c73e3c9.js"><link rel="prefetch" href="/reading-notes/assets/js/8.d947842c.js"><link rel="prefetch" href="/reading-notes/assets/js/9.6eecae53.js">
    <link rel="stylesheet" href="/reading-notes/assets/css/0.styles.9653101a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/reading-notes/" class="home-link router-link-active"><img src="/reading-notes/avatar.png" alt="读书笔记" class="logo"> <span class="site-name can-hide">读书笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://xblcity.github.io/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/xblcity/reading-notes" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://xblcity.github.io/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/xblcity/reading-notes" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/reading-notes/" aria-current="page" class="sidebar-link">总览</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>2019年</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/reading-notes/books19/professional-javascript.html" class="sidebar-link">Javascript高级程序设计(第三版)读书笔记</a></li><li><a href="/reading-notes/books19/understanding-es6.html" class="sidebar-link">深入理解ES6</a></li><li><a href="/reading-notes/books19/you-don't-know-js1.html" class="sidebar-link">你不知道的Javascript(上卷)</a></li><li><a href="/reading-notes/books19/understanding-node.html" class="sidebar-link">深入浅出node.js</a></li><li><a href="/reading-notes/books19/understanding-webpack.html" class="sidebar-link">深入浅出webpack</a></li><li><a href="/reading-notes/books19/react.html" class="sidebar-link">React Docs(英译中)</a></li><li><a href="/reading-notes/books19/vue.html" class="sidebar-link">vue2.x文档</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>2020年</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/reading-notes/books20/functional-javascript.html" class="sidebar-link">Javascript ES6 函数式编程入门经典</a></li><li><a href="/reading-notes/books20/react20.html" class="sidebar-link">React 文档总结思考</a></li><li><a href="/reading-notes/books20/node-in-action.html" aria-current="page" class="active sidebar-link">Node.js实战 第二版 2018</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/reading-notes/books20/node-in-action.html#第一章-欢迎进入node-js的世界" class="sidebar-link">第一章 欢迎进入Node.js的世界</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books20/node-in-action.html#第二章-node编程基础" class="sidebar-link">第二章 Node编程基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/reading-notes/books20/node-in-action.html#用回调函数处理一次性事件" class="sidebar-link">用回调函数处理一次性事件</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books20/node-in-action.html#用事件发射器处理重复性事件" class="sidebar-link">用事件发射器处理重复性事件</a></li><li class="sidebar-sub-header"><a href="/reading-notes/books20/node-in-action.html#异步开发要注意的难题" class="sidebar-link">异步开发要注意的难题</a></li></ul></li><li class="sidebar-sub-header"><a href="/reading-notes/books20/node-in-action.html#第三章-node-web程序是什么" class="sidebar-link">第三章 Node Web程序是什么</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="node-js实战-第二版-2018"><a href="#node-js实战-第二版-2018" class="header-anchor">#</a> Node.js实战 第二版 2018</h1> <blockquote><p>时间不是很充分，所以大致过了一下，然后就去实战了</p></blockquote> <ul><li><p>第一部分 Node基础知识介绍</p> <ul><li><p><a href="#%E7%AC%AC%E4%B8%80%E7%AB%A0-%E6%AC%A2%E8%BF%8E%E8%BF%9B%E5%85%A5node.js%E7%9A%84%E4%B8%96%E7%95%8C">第一章 欢迎进入Node.js的世界</a></p></li> <li><p><a href="#%E7%AC%AC%E4%BA%8C%E7%AB%A0-node%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80">第二章 Node编程基础</a></p></li> <li><p><a href="#%E7%AC%AC%E4%B8%89%E7%AB%A0-node-web%E7%A8%8B%E5%BA%8F%E6%98%AF%E4%BB%80%E4%B9%88">第三章 Node Web程序是什么</a></p></li></ul></li></ul> <h2 id="第一章-欢迎进入node-js的世界"><a href="#第一章-欢迎进入node-js的世界" class="header-anchor">#</a> 第一章 欢迎进入Node.js的世界</h2> <p>在Node中，对于I/O请求，为了解决请求慢的问题，Node用三种技术解决这个问题：事件，异步API，非阻塞I/O</p> <p>在Node中，回调函数的第一个参数通常是错误对象</p> <p>Node应用程序主要分为三种类型</p> <ul><li>Web应用程序</li> <li>命令行工具，比如npm, webpack</li> <li>后台程序和桌面程序，后台程序就是后台服务，比如pm2，桌面程序一般是用Electron框架写的软件，比如Atom, VS Code</li></ul> <h2 id="第二章-node编程基础"><a href="#第二章-node编程基础" class="header-anchor">#</a> 第二章 Node编程基础</h2> <p>引入模块的api require 是Node种少数几个同步I/O操作之一</p> <p>模块引入机制：是核心模块吗？在node_modules中吗？父目录存在吗？在环境变量NODE_PATH指定的目录下吗？==&gt;抛出异常</p> <p>在web前端程序，界面事件(比如鼠标点击)触发的逻辑，就是异步。服务端异步编程也一样，事件发生会触发响应逻辑，在Node的世界里流行两种响应逻辑管理方式：回调和事件监听。</p> <p>回到通常用来定义一次性响应的逻辑，对于数据库查询，可以指定一个回调函数来确定如何处理查询结果。这个回调函数可能会显示数据库查询结果，根据这些结果做些计算，或者以查询结果为参数执行另一个回调函数</p> <p>事件监听器本质上也是一个回调，不同的是，它跟一个概念实体(事件)相关联，例如，当有人在浏览器中点击鼠标时，鼠标点击就是一个需要 处理的事件，在Node中，当有http请求过来时，http请求会发出一个request事件，你可以监听那个request事件，并添加一些响应逻辑，在下面这个例子中，因为用EventEmitter.prototype.on在服务器上绑定了一个监听器，所以每当有request时间发出时，服务器就会调用handleRequest函数</p> <div class="language-js extra-class"><pre class="language-js"><code>server<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'request'</span><span class="token punctuation">,</span> handleRequest<span class="token punctuation">)</span>
</code></pre></div><p>一个Node HTTP服务器实例就是一个事件发射器，一个可以继承，能够添加时间发射及处理能力的类(EventEmitter)</p> <h3 id="用回调函数处理一次性事件"><a href="#用回调函数处理一次性事件" class="header-anchor">#</a> 用回调函数处理一次性事件</h3> <p>回调是一个函数，它被当做参数传递给异步函数，比如node的fs模块，</p> <div class="language-js extra-class"><pre class="language-js"><code>fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./test.json'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    console<span class="token punctuation">.</span><span class="token function">err</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> 
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'Server Error'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'text/html'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="用事件发射器处理重复性事件"><a href="#用事件发射器处理重复性事件" class="header-anchor">#</a> 用事件发射器处理重复性事件</h3> <p>事件发射器会触发事件，并且在那些事件被触发时能够处理它们，一些重要的Node API组件比如HTTP服务器，TCP服务器和流都被做成了事件发射器，你也可以创建自己的事件发射器。</p> <p>比如Node中的TCP socket，它有一个data事件，每当socket中有新数据时就会触发。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> net <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'net'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> net<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token parameter">socket</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    socket<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8888</span><span class="token punctuation">)</span>
</code></pre></div><p>使用node xxx.js运行，使用命令行<code>telnet 127.0.0.1 8888</code> 发送数据给服务器(window没有telnet)</p> <p>用事件发射器实现简单的发布/预订系统</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Todo</span>
</code></pre></div><h3 id="异步开发要注意的难题"><a href="#异步开发要注意的难题" class="header-anchor">#</a> 异步开发要注意的难题</h3> <p>代码执行顺序</p> <p>流程控制：串行执行/并行执行</p> <h2 id="第三章-node-web程序是什么"><a href="#第三章-node-web程序是什么" class="header-anchor">#</a> 第三章 Node Web程序是什么</h2></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/reading-notes/books20/react20.html" class="prev">
        React 文档总结思考
      </a></span> <!----></p></div> </main></div><div class="global-ui"><!----><div id="live2d-widget" class="live2d-widget-container" style="position:fixed;right:15px;bottom:60px;width:150px;height:300px;z-index:99999;opacity:0.8;pointer-events:none;"><canvas id="live2d_canvas" width="150" height="300" class="live2d_canvas" style="position:absolute;left:0px;top:0px;width:150px;height:300px;"></canvas></div></div></div>
    <script src="/reading-notes/assets/js/app.3c3209d0.js" defer></script><script src="/reading-notes/assets/js/2.a1b00631.js" defer></script><script src="/reading-notes/assets/js/16.985c71fb.js" defer></script>
  </body>
</html>
